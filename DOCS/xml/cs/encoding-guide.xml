<?xml version="1.0" encoding="iso-8859-2"?>
<!-- Synced with: 1.38 -->
<chapter id="encoding-guide">
<title>Enkódování s <application>MEncoder</application>em</title>

<sect1 id="menc-feat-dvd-mpeg4">
<title>Vytvoøení MPEG-4 (&quot;DivX&quot;) ripu DVD filmu ve vysoké kvalitì</title>

<para>
  Velmi èastou otázkou je "Jak mohu vytvoøit rip v nejvy¹¹í mo¾né kvalitì pro
  danou velikost?". Dal¹í otázkou je "Jak vytvoøím DVD rip v nejvy¹¹í mo¾né
  kvalitì? Velikost souboru mì nezajímá, chci tu nejvy¹¹í kvalitu."
</para>

<para>
  Druhá otázka je ponìkud ¹patnì polo¾ená. Konec koncù, pokud je vám lhostejná
  velikost souboru, proè prostì nezkopírujete celý MPEG-2 video proud z DVD?
  Jistì¾e va¹e AVI bude mít kolem 5 GB, ale pokud chcete nejvy¹¹í kvalitu a
  na velikosti nezále¾í, je to jistì nejlep¹í volba.
</para>

<para>
  Ve skuteènosti, dùvodem pøevodu DVD do MPEG-4 je právì to, ¾e vám na velikosti
  souboru <emphasis role="bold">zále¾í</emphasis>.
</para>

<para>
  Je tì¾ké nabídnout kuchaøku jak vytvoøit DVD rip ve velmi vysoké kvalitì. Je
  nutné uvá¾it mno¾ství faktorù a mìli byste rozumìt tìmto detailùm, jinak
  budete asi zklamáni výsledkem. Ní¾e prozkoumáme nìkteré z tìchto vìcí a
  pak se podíváme na pøíklad. Pøedpokládáme, ¾e pou¾ijete
  <systemitem class="library">libavcodec</systemitem> pro enkódování videa,
  aèkoli teorie je stejná i pro ostatní kodeky.
</para>

<para>
  Pokud je toho na vás moc, asi byste mìli pou¾ít nìkterý z pìkných frontendù,
  které jsou zmínìny v
  <ulink url="http://www.mplayerhq.hu/design7/projects.html#mencoder_frontends">sekci MEncoder</ulink>
  na na¹í stránce odvozených projektù.
  Takto budete schopni dosahovat vysoce kvalitních ripù bez velkého pøemý¹lení,
  proto¾e vìt¹ina tìchto nástrojù je navr¾ena tak, aby dìlala vhodná rozhodnutí
  za vás.
</para>

<sect2 id="menc-feat-dvd-mpeg4-preparing-encode">
<title>Pøíprava na enkódování: Urèení zdrojového materiálu a datového toku</title>
<para>
  Pøedtím ne¾ i jen pomyslíte na enkódování filmu, budete muset uèinit
  nìkolik pøípravných krokù.
</para>

<para>
  Prvním a nejdùle¾itìj¹ím krokem pøed enkódováním by mìlo být zji¹tìní
  druhu obsahu se kterým máte co do èinìní.
  Pokud va¹e zdrojové video pochází z DVD nebo veøejné/kabelové/satelitní
  TV, bude ulo¾en v jednom ze dvou formátù: NTSC v Severní Americe a
  Japonsku, PAL v Euvropì, atd.
  Je ov¹em dùle¾ité si uvìdomit, ¾e to je pouze formátování pro prezentaci
  v televizi a èasto <emphasis role="bold">neodpovídá</emphasis>
  originálnímu formátu filmu.
  Zku¹enosti ukazují, ¾e NTSC materiál je mnohem tì¾¹í enkódovat,
  jeliko¾ musíme identifikovat více vìcí ve zdrojovém videu.
  Abyste dosáhli uspokojivého výsledku, musíte znát pùvodní formát.
  Nevezmete-li to správnì v potaz, dostanete obraz plný nejrùznìj¹ích vad,
  vèetnì o¹klivých kombinaèních (proklad) artefaktù a zdvojených nebo dokonce
  zahozených snímkù.
  Kromì toho, ¾e budete mít nekvalitní obraz, artefakty rovnì¾ sni¾ují
  efektivitu kódování:
  Dosáhnete hor¹í kvalitu na jednotku datového toku.
</para>

<sect3 id="menc-feat-dvd-mpeg4-preparing-encode-fps">
<title>Zji¹tìní snímkové rychlosti zdroje</title>
<para>
  Zde máte seznam bì¾ných typù zdrojového materiálu, kde na který nejspí¹
  narazíte a jejich volby:
</para>
<itemizedlist>
<listitem><para>
  <emphasis role="bold">Standardní film</emphasis>: Vytvoøený pro promítání
  v kinì pøi 24fps.
</para></listitem>
<listitem><para>
  <emphasis role="bold">PAL video</emphasis>: Zaznamenáno PAL
  video kamerou s rychlostí 50 pùlsnímkù za sekundu.
  Pùlsnímek sestává jen z lichých nebo sudých øádkù daného snímku.
  Televize je navr¾ena pro jejich støídavé zobrazování jako laciná
  forma analogové komprese.
  Lidské oko to pravdìpodobnì vykompenzuje, ale jakmile porozumíte
  prokládání, nauèíte se jej vidìt i v TV a u¾ si ji neu¾ijete.
  Dva pùlsnímky <emphasis role="bold">netvoøí</emphasis> úplný snímek,
  proto¾e jsou zaznamenány s èasovou odchylkou 1/50 sekundy a proto se
  nekryjí, dokud je zde pohyb.
</para></listitem>
<listitem><para>
  <emphasis role="bold">NTSC Video</emphasis>: Zaznamenáno
  NTSC video kamerou s rychlostí 60000/1001 pùlsnímkù za sekundu, nebo 60
  pùlsnímkù za sekundu v dobì pøed barevnou televizí.
  Jinak obdobné PAL.
</para></listitem>
<listitem><para>
  <emphasis role="bold">Animovaný film</emphasis>: Obvykle kreslený pøi
  24 snímcích za sekundu, ale rovnì¾ bývá v nìkteré variantì prmìnné snímkové
  rychlosti.
</para></listitem>
<listitem><para>
  <emphasis role="bold">Poèítaèová grafika (CG)</emphasis>: Mù¾e mít jakoukoli
  snímkovou rychlost, ale nìkteré jsou èastìj¹í ne¾ jiné; 24 a 30 snímkù za
  sekundu jsou typické pro NTSC a 25 snímkù za sekundu zase pro PAL.
</para></listitem>
<listitem><para>
  <emphasis role="bold">Starý film</emphasis>: Rùzné ni¾¹í snímkové rychlosti.
</para></listitem>
</itemizedlist>
</sect3>

<sect3 id="menc-feat-dvd-mpeg4-preparing-encode-material">
<title>Urèení zdrojového materiálu</title>
<para>
  Filmy sestávající ze snímkù jsou nazývány progresivní,
  zatímco ty slo¾ené z nezávislých pùlsnímkù buï prokládané, nebo
  jen video &ndash; aèkoli druhý termín je zavádìjící.
</para>
<para>
  Abychom to je¹tì zkomplikovali, nìkteré filmy mohou být smìsí
  v¹eho vý¹e uvedeného.
</para>
<para>
  Nejdùle¾itìj¹ím rozdílem mezi v¹emi tìmito formáty je to, ¾e základem
  nìkterých jsou snímky a jiných pùlsnímky.
  <emphasis role="bold">V¾dy</emphasis>, kdy¾ je film pøipravován pro promítání
  v televizi (vèetnì DVD), je pøeveden na pùlsnímky.
  Rùzné metody jak toho lze dosáhnout jsou souhrnnì nazývány "pulldown" a
  nechvalnì známé NTSC "3:2 telecine" je jednou z variant.
  Pokud nebyl základ va¹eho filmu rovnì¾ pùlsnímkový (se stejnou pùlsnímkovou
  rychlostí), máte film v jiném formátu, ne¾ byl pùvodnì.
</para>

<itemizedlist>
<title>Zde je nìkolik bì¾ných typù pulldown:</title>
<listitem><para>
  <emphasis role="bold">PAL 2:2 pulldown</emphasis>: Je nejhezèí z nich.
  Ka¾dý snímek je zobrazován po dobu dvou pùlsnímkù tak, ¾e se oddìlí liché
  a sudé øádky a zobrazují se støídavì.
  Pokud mìl originál 24 snímkù za sekundu, zrychlí se film o 4%.
</para></listitem>
<listitem><para>
  <emphasis role="bold">PAL 2:2:2:2:2:2:2:2:2:2:2:3 pulldown</emphasis>:
  Ka¾dý 12 snímek je zobrazen po dobu tøí pùlsnímkù, místo dvou.
  To odstraní nevýhodu 4% zrychlení, ale znesnadní obrácený proces.
  Obvykle je pou¾íván pouze u hudební produkce, jeliko¾ zde by 4% zrychlení
  znatelnì po¹kodilo hudební zá¾itek.
</para></listitem>
<listitem><para>
  <emphasis role="bold">NTSC 3:2 telecine</emphasis>: Snímky jsou zobrazovány
  po dobu 2 nebo 3 pùlsnímkù, èím¾ je dosa¾eno 2.5 krát
  vy¹¹í pùlsnímkové rychlosti, ne¾ je originální snímková rychlost.
  Výsledek je dále velmi mírnì spomalen ze 60 pùlsnímkù za sekundu na
  60000/1001 pùlsnímkù za sekundu, aby se dosáhlo NTSC pùlsnímkové rychlosti.
</para></listitem>
<listitem><para>
  <emphasis role="bold">NTSC 2:2 pulldown</emphasis>: Pou¾ívá se pro
  promítání 30fps materiálu na NTSC.
  Pìkné, stejnì jako 2:2 PAL pulldown.
</para></listitem>
</itemizedlist>

<para>
  Existují rovnì¾ metody pro konverzi mezi NTSC a PAL vieem, ale to
  ji¾ je nad rámec této pøíruèky.
  Pokud se setkáte s takovým filmem a budete jej chtít enkódovat,
  bude pro vás nejlep¹í opatøit si jej v originálním formátu.
  Konverze mezi tìmito formáty je vysoce destruktivní a nelze ji
  èistì zvrátit, tak¾e výsledek velmi utrpí, pokud je vytvoøen z
  konvertovaného materiálu.
</para>
<para>
  Kdy¾ je video ukládáno na DVD, po sobì jdoucí páry pùlsnímkù jsou
  seskupovány do snímkù, dokonce i kdy¾ nejsou urèeny pro zobrazení
  ve stejném okam¾iku.
  Standard MPEG-2 pou¾itý na DVD a digitální televizi poskytuje mo¾nost
  jak pro enkódování originálních progresivních snímkù, tak pro ulo¾ení
  informací do hlavièky snímku o poètu pùlsnímkù, po jejich¾ dobu by mìl
  být daný snímek zobrazován.
  Pokud je pou¾ita tato metoda, film bývá èasto oznaèen jako
  "soft-telecined", jeliko¾ proces pouze øídí DVD pøehrávaè pro
  aplikaci pulldown na film spí¹e ne¾ ¾e mìní samotný film.
  Tento pøípad je velmi upøednostòován, jaliko¾ mù¾e být snadno
  zvrácen (ve skuteènosti ignorován) enkodérem a proto poskytuje maximální
  kvalitu.
  Mnoho DVD a televizních produkèních spoleèností v¹ak nepou¾ívá vhodné
  enkódovací techniky, ale místo toho produkují filmy s
  "hard telecine", kdy jsou ve skuteènosti pùlsnímky duplikovány
  ve výsledném MPEG-2.
</para>
<para>
  Postupy pro tyto pøípady budou uvedeny
  <link linkend="menc-feat-telecine">pozdìji v této pøíruèce</link>.
  Prozatím si øekneme nìkolik návodù pro identifikaci o jaký typ materiálu jde:
</para>

<itemizedlist>
<title>NTSC regiony:</title>
<listitem><para>
  Pokud <application>MPlayer</application> pøi pøehrávání vypí¹e, ¾e se snímková
  rychlost zmìnila na 24000/1001 a ji¾ se to nezmìní, pak se nejspí¹ jedná
  o progresivní obsah, který byl "soft telecinován".
</para></listitem>
<listitem><para>
  Pokud <application>MPlayer</application> ukazuje, ¾e se snímková rychlost
  mìní tam a zpìt mezi 24000/1001 a 30000/1001 a nìkdy vidíte
  "combing", pak je zde nìkolik mo¾ností.
  Segmenty 24000/1001 fps mají témìø jistì "soft telecinovaný" progresivní
  obsah, ale 30000/1001 fps èásti mohou mít buï hard-telecined 24000/1001 fps
  obsah, nobo se jedná o 60000/1001 pùlsnímkù za sekundu NTSC video.
  Pou¾ijte stejný postup jako v následujících dvou pøípadech pro urèení
  který z nich to je.
</para></listitem>
<listitem><para>
  Pokud <application>MPlayer</application> neuká¾e zmìnu snímkové rychlosti
  a v¹echny snímky jsou zubaté, je vá¹ film ve formátu NTSC video s 60000/1001
  pùlsnímky za sekundu.
</para></listitem>
<listitem><para>
  Pokud <application>MPlayer</application> neuká¾e zmìnu snímkové rychlosti
  a dva snímky z pìti vypadají zubatì, má va¹e video "hard telecinovaný"
  24000/1001fps obsah.
</para></listitem>
</itemizedlist>

<itemizedlist>
<title>PAL regiony:</title>
<listitem><para>
  Pokud není nikde vidìt ¾ádné zubatìní, je vá¹ film 2:2 pulldown.
</para></listitem>
<listitem><para>
  Pokud vidíte jak se objevuje a mizí zubatìní ka¾dou pùlsekundu,
  pak je vá¹ film 2:2:2:2:2:2:2:2:2:2:2:3 pulldown.
</para></listitem>
<listitem><para>
  Pokud je zubatìní vidìt stále, je to PAL video s 50 pùlsnímky za sekundu.
</para></listitem>
</itemizedlist>

<note><title>Rada:</title>
<para>
  <application>MPlayer</application> umí spomalit pøehrávání videa
  pomocí volby -speed.
  Zkuste pou¾ít <option>-speed</option> 0.2 pro velmi pomalé pøehrávání a
  najdìte vzor, pokud jej nevidíte pøi plné rychlosti.
</para>
</note>
</sect3>
</sect2>

<sect2 id="menc-feat-dvd-mpeg4-2pass">
<title>Pevný kvantizer vs. více prùchodù</title>

<para>
  Enkódování va¹eho videa je mo¾né provést v ¹iroké ¹kále kvality.
  S moderními video enkodéry a trochou pøedkodekové komprese
  (zmen¹ení a od¹umování) je mo¾né dosáhnout velmi dobré kvality v 700 MB,
  pro 90-110 minut dlouhé ¹irokoúhlé video.
  Jinak lze v¹echna videa, snad kromì tìch nejdel¹ích, enkódovat v témìø
  perfektní kvalitì do 1400 MB.
</para>

<para>
  Jsou tøi pøístupy k enkódování videa: pevný datový tok (CBR), pevný kvantizer
  a víceprùchodový (ABR, neboli prùmìrovaný datový tok).
</para>

<para>
  Komplexnost snímkù ve filmu, a tím i poèet bitù potøebných pro jejich
  komprimaci, se mù¾e velmi li¹it od scény ke scénì.
  Moderní enkodéry se umí pøizpùsobit tìmto potøebám zmìnou datového toku.
  V jednoduchých re¾imìch, jako je CBR, v¹ak enkodéry neznají nároky na
  datový tok budoucích scén a tak nemohou pøekroèit po¾adovaný støední
  datový tok na dlouhou dobu.
  Pokroèilej¹í re¾imy, jako je víceprùchodové enkódování, umí vzít v
  potaz statistiky z pøedchozích re¾imù, co¾ odstraní vý¹e zmínìný problém.
</para>

<note><title>Poznámka:</title>
<para>
  Vìt¹ina kodekù, které podporují ABR enkódování, podporují pouze dvouprùchodové
  enkódování, zatímco ostatní jako <systemitem class="library">x264</systemitem>,
  <systemitem class="library">XviD</systemitem>
  a <systemitem class="library">libavcodec</systemitem> podporují víceprùchodové
  enkódování, které s ka¾dým prùchodem trochu zlep¹í kvalitu, aèkoli toto
  zlep¹ení ji¾ není viditelné, nebo mìøitelné po asi ètvrtém prùchodu.
  V této sekci budeme pova¾ovat dvouprùchodové a víceprùchodové
  enkódování za shodné.
</para>
</note>

<para>
  V ka¾dém z tìchto re¾imù video kodek (jako je
  <systemitem class="library">libavcodec</systemitem>)
  rozbije videosnímek na makrobloky 16x16 pixelù a potom na ka¾dý makroblok
  aplikuje kvantizer. Èím je ni¾¹í kvantizer, tím je vy¹¹í kvalita a datový tok.
  Metoda, kterou enkodér filmu pou¾ívá pro
  urèení jaký kvantizer pou¾ít pro daný makroblok, se li¹í a je vysoce
  ovlivnitelná. (Toto je extrémní zjednodu¹ení daného procesu, ale je vhodné
  rozumìt základnímu principu.)
</para>

<para>
  Pokud nastavíte konstantní datový tok, bude videokodek enkódovat video tak,
  ¾e zahodí
  detaily podle potøeby a jen tolik, aby se udr¾el pod zadaným datovým tokem.
  Pokud je vám opravdu lhostejná velikost souboru, mù¾ete také pou¾ít CBR a
  nastavit datový tok na nekoneèno. (V praxi to znamená nastavit hodnotu tak
  vysoko, aby nijak neomezovala, jako 10000 Kbitù.) Bez reálného omezení
  datového toku pou¾ije kodek
  nejni¾¹í mo¾ný kvantizer pro ka¾dý makroblok (ten je nastaven pomocí
  <option>vqmin</option> pro <systemitem class="library">libavcodec</systemitem>,
  kde je výchozí 2). Jakmile nastavíte dostateènì ni¾¹í
  datový tok, tak¾e je kodek
  pøinucen pou¾ít vy¹¹í kvantizer, pak témìø jistì sní¾íte kvalitu svého videa.
  Abyste se tomu vyhnuli, mìli byste zvá¾it zmen¹ení videa podle postupu
  popsaného pozdìji v této pøíruèce.
</para>

<para>
  Pøi konstantním kvantizeru kodek
  pou¾ívá kvantizer nastavený volbou <option>vqscale</option> (pro
  <systemitem class="library">libavcodec</systemitem>) na ka¾dý makroblok.
  Pokud chcete maximálnì kvalitní rip, opìt bez ohledu na datový tok, mù¾ete
  pou¾ít <option>vqscale=2</option>. To povede ke stejnému datovému toku a PSNR
  (odstup signál &ndash; ¹um) jako CBR s <option>vbitrate</option>=infinity a
  výchozím <option>vqmin</option> rovným 2.
</para>

<para>
  Problém s konstantní kvantizací je ten, ¾e pou¾ívá zadaný kvantizer a» to daný
  makroblok potøebuje èi nikoli. Je toti¾ mo¾né pou¾ít vy¹¹í kvantizer na
  makroblok bez obìtování viditelné kvality. Proè tedy plýtvat bity s nemístnì
  nízkým kvantizerem? Vá¹e CPU má tolik cyklù, kolik máte èasu, ale na harddisku
  máte jen urèitý poèet bitù.
</para>

<para>
  Pøi dvouprùchodovém enkódování se v prvním prùchodu projde film jakoby mìl být
  CBR, ale vlastnosti ka¾dého snímku se zaznamenají do logu. Tato data jsou pak
  pou¾ita pøi druhém prùchodu pro inteligentní stanovení pou¾itého kvantizeru.
  V rychlých scénách nebo scénách s malým poètem detailù budou èastìji pou¾ívány
  vy¹¹í kvantizery a v pomalých nebo detailních scénách zase ni¾¹í kvantizery.
</para>

<para>
  Pokud pou¾ijete <option>vqscale=2</option>, plýtváte bity. Pokud pou¾ijete
  <option>vqscale=3</option>, pak nedostanete nejkvalitnìj¹í mo¾ný rip.
  Dejme tomu, ¾e ripujete DVD pøi <option>vqscale=3</option> a
  výsledkem je 1800Kbit. Pokud provedete dvouprùchodové enkódování
  s <option>vbitrate=1800</option>, výsledné video bude mít <emphasis
  role="bold">vy¹¹í kvalitu</emphasis> pøi
  <emphasis role="bold">stejném datovém toku</emphasis>.
</para>

<para>
  Jeliko¾ jsme vás nyní pøesvìdèili, ¾e dvouprùchodový re¾im je správná volba,
  skuteènou otázkou je, jaký datový tok pou¾ít? Odpovìï je, ¾e není jediná
  odpovìï. Ideálnì byste mìli zvolit takový datový tok, který zajistí nejlep¹í
  rovnováhu mezi kvalitou a velikostí souboru. Ten bude poka¾dé jiný
  v závislosti na zdrojovém videu.
</para>

<para>
  Pokud na velikosti souboru nezále¾í, pak je dobrý startovní mùstek pro rip
  s velmi vysokou kvalitou je kolem 2000 Kbitù plus-mínus 200 Kbitù.
  Pro rychlé akèní nebo vysoce detailní zdrojové video, nebo máte-li velmi
  kritické oko, se budete rozhodovat mezi 2400 nebo 2600.
  U nìkterých DVD nepoznáte rozdíl pøi 1400 Kbitech. Je vhodné experimentovat
  se scénami pøi rùzných datových tocích, abyste pro to dostali cit.
</para>

<para>
  Pokud se sna¾íte o urèitou velikost, budete muset nìjak spoèítat datový tok.
  Ale je¹tì pøedtím musíte zjistit, kolik místa byste mìli rezervovat pro
  zvukové(ou) stopy(u), tak¾e byste si
  <link linkend="menc-feat-dvd-mpeg4-audio">je mìli ripnout</link> jako první.
  Mù¾ete si pak spoèítat datový tok pomocí následující rovnice:
  <systemitem>datový_tok = (po¾adovaná_velikost_v_Mbajtech - velikost_zvuku_v_Mbajtech) *
  1024 * 1024 / délka_v_sek * 8 / 1000</systemitem>
  Napøíklad abyste nacpali dvouhodinový film na 702MB CD, se 60MB zvukovou
  stopou, bude muset být datový tok videa:
  <systemitem>(702 - 60) * 1024 * 1024 / (120*60) * 8 / 1000
  = 740kbps (kilobitù za sekundu)</systemitem>
</para>

</sect2>


<sect2 id="menc-feat-dvd-mpeg4-constraints">
<title>Omezení pro efektivní enkódování</title>

<para>
  Ze samé podstaty komprese typu MPEG vyplývají urèitá omezení, která byste mìli
  ctít, pokud chcete maximální kvalitu.
  MPEG rozdìlí video na ètverce 16x16 nazývané makrobloky, které se skládají
  ze ètyø blokù 8x8 jasové (luma) slo¾ky a dvou blokù 8x8 barevné (chroma)
  slo¾ky v polovièním rozli¹ení (jeden pro osu èervená-cyan (modrozelená) a druhý pro osu
  modrá-¾lutá).
  Dokonce i kdy¾ ¹íøka a vý¹ka va¹eho videa nejsou násobky 16, pou¾ije enkodér
  dostatek 16x16 makroblokù, aby pokryl celou oblast obrazu a zabere místo
  navíc, které pøijde vniveè.
  Tak¾e chcete-li maximalizovat kvalitu pøi dané velikosti souboru, není dobrý
  nápad pou¾ívat rozmìry které nejsou násobky 16.
</para>

<para>
  Vìt¹ina DVD má také rùznì velké èerné okraje videa. Ponechání tìchto ploch
  mù¾e rùzným zpùsobem sní¾it kvalitu.
</para>

<orderedlist>
<listitem>
<para>
  Komprese typu MPEG je rovnì¾ velmi závislá na plo¹ných frekvenèních
  transformacích, konkrétnì Diskrétní Kosinové Transformaci (DCT), která se
  podobá Fourierovì transformaci. Tento druh enkódování je efektivní na
  reprezentaci opakujících se vzorù a pozvolné pøechody, ale má potí¾e s ostrými
  pøechody. Chcete-li je enkódovat, musíte pou¾ít mnoho bitù, jinak se objeví
  artefakty známé jako krou¾kování.
</para>

<para>
  Frekvenèní transformace (DCT) je provedena zvlá¹» pro ka¾dý makroblok
  (ve skuteènosti na ka¾dý blok), tak¾e problém nastane pouze tehdy, je-li ostrý
  pøechod uvnitø bloku. Pokud va¹e èerné okraje zaèínají pøesnì na hranicích
  násobkù 16 pixelù, pak to není problém. Èerné okraje jsou v¹ak na DVD jen
  málokdy pìknì umístìny, tak¾e je v praxi budete muset v¾dy odstranit, abyste
  se vyhnuli tomuto problému.
</para>
</listitem>
</orderedlist>

<para>
  Navíc k plo¹nì frekvenèním transformacím pou¾ívá komprese typu MPEG vektory
  pohybu k popisu zmìn od jednoho snímku ke druhému. Vektory pohybu pøirozenì
  pracují ménì efektivnì s novým obsahem pøicházejícím zpoza okrajù snímku,
  proto¾e ten nebyl pøítomen na pøedchozím snímku. Dokud se obraz roz¹iøuje
  smìrem k okrajùm snímku, nemají s tím vektory pohybu ¾ádný problém, ale
  jsou-li zde èerné okraje, mù¾e problém nastat:
</para>

<orderedlist continuation="continues">
<listitem>
<para>
  Komprese typu MPEG ukládá pro ka¾dý makroblok vektor, identifikující která
  èást pøedchozího obrázku by mìla být zkopírována onoho makrobloku jako základ
  pro predikci následujícího snímku. Pouze zbývající odli¹nosti musí být
  enkódovány. Pokud makroblok pøesahuje okraj obrázku a obsahuje èást èerného
  okraje, vektory pohybu z ostatních èástí obrázku pøepí¹í èerný okraj.
  To znamená mnoho bitù spotøebovaných buï na znovuzaèernìní, nebo se (spí¹)
  vektory pohybu nepou¾ijí vùbec a v¹echny zmìny v tomto makrobloku se budou
  kódovat pøímo. Jinými slovy se velmi sní¾í efektivita enkódování.
</para>

<para>
  Tento problém nastává opìt jen v pøípadì, ¾e èerné okraje nezaèínají na lince
  její¾ pozice je násobkem 16.
</para>
</listitem>

<listitem>
<para>
  Nakonec zde máme makroblok uvnitø obrázku do nìj¾ se posunuje objekt z okraje
  obrázku. Kódování typu MPEG neumí øíct "zkopíruj to co je na obrázku, ale ne
  èerný okraj." Tak¾e se zkopíruje i èerný okraj a spotøebuje se spousta bitù
  na enkódování té èásti obrázku, která tu mìla být.
</para>

<para>
  Pokud se obrázek dostane úplnì ven z enkódované oblasti, má MPEG speciální
  optimalizace pro opakované kopírování pixelù na okraj obrázku pokud pøijde
  vektor pohybu zvenèí enkódované oblasti. Tato vlastnost bude k nièemu, pokud
  má film èerné okraje. Na rozdíl od problémù 1 a 2 zde umístìní okrajù na
  násobky 16 nepomù¾e.
</para>
</listitem>

<listitem>
<para>
  Navzdory tomu, ¾e okraje jsou úplnì èerné a nikdy se nemìní, je zde v¾dy
  alespoò minimální datový tok spotøebovaný na vìt¹í mno¾ství makroblokù.
</para>
</listitem>
</orderedlist>

<para>
  Ze v¹ech tìchto dùvodù doporuèujeme zcela odstranit èerné okraje. Dále, pokud
  je na okraji obrázku oblast se ¹umem/zkreslením, jejím odstøi¾ením se je¹tì
  zvý¹í efektivita enkódování. Videofilní puristé, kteøí chtìjí zùstat tak
  blízko originálu, jak je to jen mo¾né, mohou protestovat proti tomuto oøezání,
  ale pokud nehodláte enkódovat s konstantním kvantizerem, kvalita kterou
  dostanete díky oøezání znatelnì pøevý¹í mno¾ství ztracených informací na
  okrajích.
</para>
</sect2>


<sect2 id="menc-feat-dvd-mpeg4-crop">
<title>Oøezávání a ¹kálování</title>

<para>
  Pøipomeòme z pøedchozí èásti, ¾e koneèná velikost obrázku by mìla mít
  jak ¹íøku, tak vý¹ku beze zbytku dìlitelnou 16, èeho¾ mù¾ete dosáhnout
  pomocí oøezání, ¹kálování, nebo kombinací obou.
</para>

<para>
  Pøi oøezávání byste se mìli dr¾et nìkolika zásad, abyste pøede¹li po¹kození
  svého filmu.
  Normální YUV formát 4:2:0, ukládá barvonosnou (chroma) informaci
  podvzorkovanou, èili hustota vzorkování barvy je polovièní oproti jasové
  (èernobílé) slo¾ce v obou smìrech.
  Prohlédnìte si tento diagram, kde L oznaèuje vzorkovací body jasu a C
  barvy.
</para>

<informaltable>
<?dbhtml table-width="40%" ?>
<?dbfo table-width="40%" ?>
<tgroup cols="8" align="center">
<colspec colnum="1" colname="col1"/>
<colspec colnum="2" colname="col2"/>
<colspec colnum="3" colname="col3"/>
<colspec colnum="4" colname="col4"/>
<colspec colnum="5" colname="col5"/>
<colspec colnum="6" colname="col6"/>
<colspec colnum="7" colname="col7"/>
<colspec colnum="8" colname="col8"/>
<spanspec spanname="spa1-2" namest="col1" nameend="col2"/>
<spanspec spanname="spa3-4" namest="col3" nameend="col4"/>
<spanspec spanname="spa5-6" namest="col5" nameend="col6"/>
<spanspec spanname="spa7-8" namest="col7" nameend="col8"/>
  <tbody>
    <row>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
    </row>
    <row>
      <entry spanname="spa1-2">C</entry>
      <entry spanname="spa3-4">C</entry>
      <entry spanname="spa5-6">C</entry>
      <entry spanname="spa7-8">C</entry>
    </row>
    <row>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
    </row>
    <row>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
    </row>
    <row>
      <entry spanname="spa1-2">C</entry>
      <entry spanname="spa3-4">C</entry>
      <entry spanname="spa5-6">C</entry>
      <entry spanname="spa7-8">C</entry>
    </row>
    <row>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
    </row>
  </tbody>
</tgroup>
</informaltable>

<para>
  Jak vidíte, øádky i sloupce obrázku se pøirozenì párují. Pøi oøezávání tedy
  <emphasis>musí</emphasis> být hodnoty odsazení i rozmìrù sudá èísla.
  Pokud nejsou, nebude se barvonosná informace zprávnì krýt s jasovou.
  Teoreticky lze støíhat s lichým odsazením, ale to vy¾aduje pøevzorkování
  barvy, co¾ je potenciálnì ztrátový úkon a není podporován filtrem crop.
</para>

<para>
  Dále, prokládané video je vzorkováno takto:
</para>

<informaltable>
<?dbhtml table-width="80%" ?>
<?dbfo table-width="80%" ?>
<tgroup cols="16" align="center">
<colspec colnum="1"  colname="col1"/>
<colspec colnum="2"  colname="col2"/>
<colspec colnum="3"  colname="col3"/>
<colspec colnum="4"  colname="col4"/>
<colspec colnum="5"  colname="col5"/>
<colspec colnum="6"  colname="col6"/>
<colspec colnum="7"  colname="col7"/>
<colspec colnum="8"  colname="col8"/>
<colspec colnum="9"  colname="col9"/>
<colspec colnum="10" colname="col10"/>
<colspec colnum="11" colname="col11"/>
<colspec colnum="12" colname="col12"/>
<colspec colnum="13" colname="col13"/>
<colspec colnum="14" colname="col14"/>
<colspec colnum="15" colname="col15"/>
<colspec colnum="16" colname="col16"/>
<spanspec spanname="spa1-2"   namest="col1" nameend="col2"/>
<spanspec spanname="spa3-4"   namest="col3" nameend="col4"/>
<spanspec spanname="spa5-6"   namest="col5" nameend="col6"/>
<spanspec spanname="spa7-8"   namest="col7" nameend="col8"/>
<spanspec spanname="spa9-10"  namest="col9" nameend="col10"/>
<spanspec spanname="spa11-12" namest="col11" nameend="col12"/>
<spanspec spanname="spa13-14" namest="col13" nameend="col14"/>
<spanspec spanname="spa15-16" namest="col15" nameend="col16"/>
  <tbody>
    <row>
      <entry namest="col1" nameend="col8">Horní pùlsnímek</entry>
      <entry namest="col9" nameend="col16">Spodní pùlsnímek</entry>
    </row>
    <row>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
    </row>
    <row>
      <entry spanname="spa1-2">C</entry>
      <entry spanname="spa3-4">C</entry>
      <entry spanname="spa5-6">C</entry>
      <entry spanname="spa7-8">C</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
    </row>
    <row>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
    </row>
    <row>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
    </row>
    <row>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry spanname="spa9-10">C</entry>
      <entry spanname="spa11-12">C</entry>
      <entry spanname="spa13-14">C</entry>
      <entry spanname="spa15-16">C</entry>
    </row>
    <row>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
    </row>
    <row>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
    </row>
    <row>
      <entry spanname="spa1-2">C</entry>
      <entry spanname="spa3-4">C</entry>
      <entry spanname="spa5-6">C</entry>
      <entry spanname="spa7-8">C</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
    </row>
    <row>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
    </row>
    <row>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
    </row>
    <row>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry spanname="spa9-10">C</entry>
      <entry spanname="spa11-12">C</entry>
      <entry spanname="spa13-14">C</entry>
      <entry spanname="spa15-16">C</entry>
    </row>
    <row>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
      <entry>L</entry>
    </row>
  </tbody>
</tgroup>
</informaltable>

<para>
  Jak vidíte, tak se vzor opakuje ka¾dé 4 øádky, tak¾e pøi oøezu prokládaného
  videa musí být odsazení v ose y a vý¹ka beze zbytku delitelné 4.
</para>

<para>
  Nativní DVD rozli¹ení je 720x480 pro NTSC a 720x576 pro PAL, ale je zde je¹tì
  pøíznak pomìru stran, který udává, zda se jedná o obrazovku (full-screen)(4:3),
  nebo ¹irokoúhlý film (wide-screen)(16:9). Mnoho (jestli ne vìt¹ina)
  ¹irokoúhlých DVD není pøesnì 16:9, ale bude buï 1.85:1 anebo 2.35:1
  (cinescope). To znamená, ¾e zde budou ve videu èerné okraje, které bude nutné
  odstøihnout.
</para>

<para>
  <application>MPlayer</application> poskytuje filtr pro detekci potøebného
  oøezu, který stanoví oøezový obdélník (<option>-vf cropdetect</option>).
  Spus»te <application>MPlayer</application> s volbou
  <option>-vf cropdetect</option> a on vám vypí¹e nastavení filtru crop pro
  oøezání okrajù.
  Mìli byste nechat bì¾et film tak dlouho, dokud není pou¾ita celá plocha
  obrázku, abyste dostali správné hodnoty crop.
</para>

<para>
  Pak otestujte získané hodnoty z pøíkazového øádku
  <application>MPlayer</application>u vypisované <option>cropdetect</option>em
  a upravte obdélník podle potøeby.
  V tom vám pomù¾e filtr <option>rectangle</option>, který umo¾òuje interaktivnì
  nastavit obdélník pro vá¹ film.
  Nezapomeòte zachovat vý¹e uvedená doporuèení, abyste nepo¹kodili barevnou
  mapu.
</para>

<para>
  ©kálování je obvykle nevhodné.
  ©kálování prokládaného videa je obtí¾né a pokud chcete zachovat prokládání,
  mìli byste se mu úplnì vyhnout.
  Pokud mebudete ¹kálovat, ale budete chtít pou¾ívat rozmìry v násobcích 16,
  budete muset oøíznout i èást obrazu.
  Neponechávejte ani malé èerné okraje, jeliko¾ se velmi ¹patnì kódují!
</para>

<para>
  Proto¾e MPEG-4 pou¾ívá makrobloky 16x16, mìli byste se ujistit, ¾e oba rozmìry
  videa jsou násobkem 16, jinak sní¾íte kvalitu, zvlá¹» pøi nízkých datových
  tocích. Mù¾ete to zajistit zaokrouhlením ¹íøky a vý¹ky oøezového obdélníku
  dolù na nejbli¾¹í násobek 16.
  Jak jsme ji¾ øekli, mìli byste pøi oøezávání zvý¹it odsazení
  (offset) v ose y o polovinu rozdílu mezi starou a novou vý¹kou, tak¾e bude
  výsledné video bráno ze støedu snímku. Z dùvodu principu vzorkování DVD videa
  se ujistìte, ¾e je odsazení sudé èíslo. (Popravdì, pøijmìte jako pravidlo,
  nikdy nepou¾ívat liché hodnoty pro jakýkoli z parametrù pøi oøezávání a
  ¹kálování videa.) Pokud nechcete zahodit tìch nìkolik pixelù navíc, mù¾ete
  místo toho radìji zmìnit velikost videa (¹kálovat). Na to se podíváme
  v pøíkladu ní¾e.
  V praxi mù¾ete nechat filtr <option>cropdetect</option> udìlat v¹echnu práci
  zmínìnou vý¹e, jeliko¾ má volitelný parametr <option>round</option>
  (zaokrouhlení), jeho¾ výchozí hodnota je 16.
</para>

<para>
  Rovnì¾ buïte opatrní na "napùl èerné" pixely na okrajích. V¾dy je rovnì¾
  odstøihnìte, jinak zde budete plýtvat bity, které mù¾ete pou¾ít jinde.
</para>

<para>
  Poté co provedete v¹e, co jsme si doposud øekli, budete mít video, které asi
  nebude právì 1.85:1 nebo 2.35:1, ale nìkde poblí¾. Mù¾ete spoèítat nový pomìr
  stran ruènì, ale <application>MEncoder</application> nabízí volbu pro
  <systemitem class="library">libavcodec</systemitem> nazývanou <option>autoaspect</option>,
  která to za vás udìlá. Nezvìt¹ujte video jen proto, abyste dosáhli ètvercových
  pixelù, pokud je vám milé místo na disku. ©kálování by mìlo být provedeno pøi
  pøehrávání, kdy pøehrávaè pou¾ije pomìr stran ulo¾ený v AVI pro zaji¹tìní
  správného rozli¹ení.
  Nane¹tìstí ne v¹echny pøehrávaèe uplatòují tuto auto¹kálovací informaci,
  tak¾e mù¾ete pøece jen chtít ¹kálovat.
</para>
</sect2>


<sect2 id="menc-feat-dvd-mpeg4-resolution-bitrate">
<title>Volba rozli¹ení a datového toku</title>

<para>
  Pokud nebudete enkódovat v re¾imu konstantního kvantizeru, musíte zvolit
  velikost datového toku.
  Koncepce datového toku je velmi jednoduchá.
  Je to (prùmìrný) poèet bitù spotøebovaný na jednu sekundu filmu.
  Normálnì se datový tok udává v kilobitech (1000 bitù) za sekundu.
  Velikost va¹eho filmu je pak datový tok násobený délkou filmu, plus malá
  re¾ie (viz napøíklad sekci
  <link linkend="menc-feat-dvd-mpeg4-muxing-avi-limitations">kontejner AVI</link>).
  Ostatní parametry jako je ¹kálování, oøezání atd.
  <emphasis role="bold">nezmìní</emphasis> velikost souboru, pokud zároveò
  nezmìníte datový tok!
</para>
<para>
  Datový tok se <emphasis role="bold">nemìní</emphasis> proporcionálnì
  k rozli¹ení.
  Jinými slovy, soubor 320x240 pøi 200 kbit/sek nebude mít stejnou kvalitu
  jako ten samý film pøi 640x480 a 800 kbitech/sek!
  Jsou pro to dva dùvody:
<orderedlist>
  <listitem><para>
    <emphasis role="bold">Dojem</emphasis>: MPEG artefakty jsou patrné
    tím více, èím jsou více zvìt¹ené!
    Artefakty se objevují ve velikosti blokù (8x8).
    Va¹e oko neodhalí chyby ve 4800 malých blocích tak snadno jako ve 1200
    velkých (pøedpokládáme, ¾e oboje budete ¹kálovat na celou obrazovku).
  </para></listitem>
  <listitem><para>
    <emphasis role="bold">Teoretický</emphasis>: Kdy¾ zmen¹íte obrázek,
    ale stále pou¾ijete stejnou velikost blokù (8x8) pro frekvenèní prostorovou
    transformaci, pøesunete více dat do oblasti vy¹¹ích frekvencí.
    Zjednodu¹enì øeèeno, ka¾dý pixel nyní obsahuje více detailù, ne¾ pøedtím.
    Dokonce i kdy¾ pøipustíme, ¾e jste zmen¹ili obraz obsahující 1/4 informací
    o daném prostoru, stále mù¾e obsahovat mnoho detailù v daném frekvenèním
    pásmu (pøedpokládáme, ¾e vysoké frekvence byly v originálním 640x480 snímku
    oøezány).
  </para></listitem>
  </orderedlist>
</para>
<para>
  Døívìj¹í návody doporuèovaly volit datový tok a rozli¹ení rozpoèítáním
  bitù na pixely, ale to obvykle není správnì díky ze zmínìných dùvodù.
  Mnohem lep¹ím se zdá odhad, ¾e je datový tok úmìrný ètverci rozli¹ení,
  tak¾e 320x240 pøi 400 kbit/sek by mìlo být srovnatelné s 640x480
  pøi 800 kbit/sek.
  Tato úmìra v¹ak nebyla ovìøena teoreticky ani empiricky.
  Navíc, vezmeme-li v úvahu to, ¾e se filmy velmi li¹í ¹umem, poètem detailù,
  mno¾stvím pohybu atd, je beznadìjné vytvoøit obecná doporuèení pro poèet
  bitù na délku diagonály (analogie bitù na pixel, av¹ak pou¾ívá plochu obrazu).
</para>
<para>
  Tolik k obtí¾nosti volby datového toku a rozli¹ení.
</para>


<sect3 id="menc-feat-dvd-mpeg4-resolution-bitrate-compute">
<title>Výpoèet rozli¹ení</title>
<para>
  Následující kroky vás provedou výpoèty rozli¹ení výsledného filmu tak,
  abyste pøíli¹ nesní¾ili kvalitu videa s pøihlédnutím k nìkolika typùm
  informací o zdrojovém videu.
  Nejdøív byste si mìli spoèítat enkódovaný pomìr stran:
  <systemitem>PSo = (©o x (PSa / PRdvd )) / Vo</systemitem>
<itemizedlist>
<title>kde:</title>
<listitem><para>
  ©o a Vo jsou ¹íøka a vý¹ka oøezaného videa,
</para></listitem>
<listitem><para>
  PSa je zobrazovaný pomìr stran, je¾ je obvykle 4/3 nebo 16/9,
</para></listitem>
<listitem><para>
  PRdvd je pomìr pixelù v DVD, který je roven 1.25=(720/576) pro DVD
  v PALu a 1.5=(720/480) pro DVD v NTSC,
</para></listitem>
</itemizedlist>
</para>

<para>
  Pak si mù¾ete spoèítat rozli¹ení X a Y podle urèitého faktoru kvality komprese
  (CQ):
  <systemitem>RozY = INT(SQRT( 1000*Datový_tok/25/PSo/CQ )/16) * 16</systemitem>
  a
  <systemitem>RozX = INT( RozY * PSo / 16) * 16</systemitem>
</para>

<para>
  Dobøe, ale co je ten CQ?
  CQ odpovídá poètu bitù na pixel a na snímek v zakódování. Jinými slovy, èím
  vy¹¹í je CQ, tím ni¾¹í je ¹ance uvidìt enkódovací artefakty.
  Pokud ov¹em máte cílový rozmìr va¹eho filmu (1 nebo 2 CD napøíklad), máte jen
  omezené mno¾ství bitù, které mù¾ete spotøebovat; tak¾e je nutné najít vhodný
  kompromis mezi komprimovatelností a kvalitou.
</para>

<para>
  CQ závisí na datovém toku, efektivitì video kodeku a na rozli¹ení filmu.
  Abyste zvý¹ili CQ, obvykle zmen¹íte daný film, tak¾e je datový tok spoèítán
  ve funkci cílové velikosti a délky filmu, které jsou konstantní.
  S MPEG-4 ASP kodeky jako jsou <systemitem class="library">XviD</systemitem>
  a <systemitem class="library">libavcodec</systemitem>, vede CQ pod 0.18
  obvykle k velmi ètvereèkovanému obrázku, proto¾e není dostatek bitù pro
  zakódování informací ka¾dého makrobloku. (MPEG4, stejnì jako mnoho
  jiných kodekù seskupuje pixely do blokù pøi komprimaci obrázku; pokud není
  dostatek bitù, jsou viditelné hranice tìchto blokù.)
  Proto je rozumné volit CQ v rozmezí 0.20 a¾ 0.22 pro rip na 1 CD a
  0.26 a¾ 0.28 pro rip na 2 CD pøi standardních enkódovacích volbách.
  Pokroèilej¹í volby podobné tìm zmiòovaným zde pro
  <link linkend="menc-feat-mpeg4-lavc-example-settings"><systemitem class="library">libavcodec</systemitem></link>
  a
  <link linkend="menc-feat-xvid-example-settings"><systemitem class="library">XviD</systemitem></link>
  by mìly umo¾nit dosa¾ení stejné kvality pøi CQ v rozsahu od
  0.18 do 0.20 pro rip na 1 CD a 0.24 a¾ 0.26 pro rip na 2 CD.
  S MPEG-4 ASP kodeky jako je <systemitem class="library">x264</systemitem>,
  mù¾ete pou¾ít CQ v rozmezí 0.14 a¾ 0.16 pøi standardních enkódovacích volbách
  a mìli byste být schopni jít a¾ na nízký od 0.10 do 0.12 s pokroèilými
  <link linkend="menc-feat-x264-example-settings"><systemitem class="library">x264</systemitem> enkódovacími volbami</link>.
</para>

<para>
  Prosíme berte v potaz, ¾e CQ je jen informaèní pomùcka závisející na
  enkódovaném obsahu. CQ okolo 0.18 mù¾e být dostateènì dobrý pro Bergmana,
  na rozdíl od filmu jako je Matrix, který obsahuje mnoho rychlých scén.
  Na druhou stranu je zbyteèné zvy¹ovat CQ vý¹ ne¾ 0.30, jeliko¾ budete plýtvat
  bity za minimální zisk kvality.
  Také berte v potaz, jak jsme ji¾ øekli, ¾e videa s nízkým rozli¹ením
  vy¾adují vy¹¹í CQ (v porovnání s napø. DVD rozli¹ením), aby vypadala dobøe.
</para>

</sect3>

</sect2>

<sect2 id="menc-feat-dvd-mpeg4-filtering">
<title>Filtrování</title>

<para>
  Nauèit se pou¾ívat video filtry <application>MEncoder</application>u je
  základem pro produkci dobrých videí.
  Ve¹keré úpravy videa jsou provádìny pomocí filtrù  -- oøezání, ¹kálování,
  úprava barev, odstranìní ¹umu, zaostøení, odstranìní prokladu, telecinování,
  inverzní telecine a deblokování, abychom jmenovali alespoò nìkteré.
  Spolu s vyèerpávajícím poètem podporovaných vstupních formátù je nabídka
  dostupných filtrù v <application>MEncoder</application>u jednou z jeho
  hlavních výhod oproti podobným aplikacím.
</para>

<para>
  Filtry jsou nahrávány v øadì za pou¾ití volby -vf :

  <screen>-vf filtr1=volby,filtr2=volby,...</screen>

  Vìt¹ina filtrù pøebírá nìkolik èíselných voleb oddìlených dvojteèkou, ale
  syntaxe voleb se li¹í od filtru k filtru, tak¾e si pøeètìte  manuál
  pro více informací o filtru který chcete pou¾ít.
</para>

<para>
  Filtry zpracovávají video v poøadí, v jakém jsou naèteny.
  Napøíklad následující øada:

  <screen>-vf crop=688:464:12:4,scale=640:464</screen>

  nejprve vyøízne z obrázku oblast 688x464 s levým horním rohem v bodì (12,4)
  a výsledek pak zmen¹í na 640x464.
</para>

<para>
  Urèité filtry potøebují být nahrány na zaèátku, nebo co nejblí¾ zaèátku
  øetìzu filtrù, aby mohly vyu¾ívat informace z video dekodéru, které budou
  ztraceny nebo znehodnoceny ostatními filtry.
  Nejdùle¾itìj¹í pøíklady jsou <option>pp</option> (postprocesing, pouze pokud
  provádí deblok nebo dering operace),
  <option>spp</option> (dal¹í postprocesor pro odstranìní MPEG artefaktù),
  <option>pullup</option> (inverzní telecine) a
  <option>softpulldown</option> (pro konverzi soft telecine na hard
  telecine).
</para>

<para>
  V¹eobecnì byste mìli filtrovat co nejménì je to mo¾né, abyste zùstali co
  nejblí¾e DVD originálu. Oøezání je èasto nutné (vysvìtleno vý¹e), ale vyhnìte
  se ¹kálování videa. Aèkoli je zmen¹ení obèas preferováno pøed pou¾itím
  vy¹¹ích kvantizérù. My se musíme vyvarovat obou tìchto pøípadù: pamatujte,
  ¾e jsme se ji¾ na zaèátku rozhodli obìtovat bity za kvalitu.
</para>

<para>
  Rovnì¾ neupravujte gamu, kontrast, jas, atd. Co vypadá dobøe na va¹í
  obrazovce, nemusí vypadat dobøe na ostatních. Tyto korekce by mìly být
  provádìny výhradnì pøi pøehrávání.
</para>

<para>
  Jednu vìc byste v¹ak udìlat mohli, a to protáhnout video velmi lehkým
  od¹umovacím filtrem, jako je <option>-vf hqdn3d=2:1:2</option>.
  Zde je opìt dùvodem vyu¾ití bitù k lep¹ímu úèelu: proè jimi plýtvat na
  enkódování ¹umu, kdy¾ si mù¾ete ¹um pøidat a¾ pøi pøehrávání?
  Zvý¹ením parametrù pro <option>hqdn3d</option> dále zvý¹í komprimovatelnost,
  ale pokud zvý¹íte hodnoty pøíli¹, riskujete zhor¹ení viditelnosti obrazu.
  Vý¹e zmínìné hodnoty (<option>2:1:2</option>) jsou dost konzervativní;
  mìli byste si zaexperimentovat s vy¹¹ími hodnotami a zhodnotit výsledky sami.
</para>

</sect2>


<sect2 id="menc-feat-dvd-mpeg4-interlacing">
<title>Prokládání a Telecine</title>

<para>
  Témìø ve¹keré filmy jsou natáèeny pøi 24 snímcích/s. Jeliko¾ NTSC má
  snímkovou rychlost 30000/1001 snímkù/s, je tøeba provést úpravu tìchto
  24 snímkù/s videí, aby mìly správnou NTSC snímkovou rychlost. Tato úprava se
  jmenuje 3:2 pulldown a obecnì je známa jako telecine (proto¾e je pulldown
  èasto provádìn bìhem pøenosu filmu na video) a, jednodu¹e øeèeno, pracuje tak,
  ¾e se film zpomalí na 24000/1001 snímkù/s a ka¾dý ètvrtý snímek se zopakuje.
</para>

<para>
  Naopak ¾ádné speciální úpravy se neprovádìjí videu pro PAL DVD, která bì¾í
  pøi 25 snímcích/s. (Technicky lze na PAL provést telecine, tzv. 2:2 pulldown,
  ale v praxi se nepou¾ívá.) Film s 24 snímky/s je jednodu¹e pøehráván rychlostí
  25 snímkù/s. Výsledkem je, ¾e video bì¾í o nìco rychleji, ale pokud nejste
  vetøelec, tak si rozdílu ani nev¹imnete. Vìt¹ina filmù má navíc vý¹kovì
  korigovaný zvuk, tak¾e pøi pøehrávání 25 snímkù/s v¹e zní jak má i pøesto, ¾e
  zvuk (a proto i celé video) má o 4% krat¹í dobu pøehrávání ne¾ NTSC DVD.
</para>

<para>
  Jeliko¾ video na PAL DVD nebylo upravováno, nemusíte si dìlat starosti s jeho
  snímkovou rychlostí. Zdroj má 25 snímkù/s, vá¹ rip také. Pokud ov¹em ripujete
  NTSC DVD film, musíte provést inverzní telecine.
</para>

<para>
  Filmy toèené rychlostí 24 snímkù/s jsou na NTSC DVD ulo¾eny buï jako
  30000/1001 po telecine, nebo jako progresivní (neprokládaný) se snímkovou
  24000/1001 snímkù/s, na kterých by mìl provést telecine DVD pøehrávaè za letu.
  Není to ale zákon: nìkteré TV série jsou prokládané (napø. Buffy Lovec upírù),
  zatímco jiné jsou porùznu neprokládané nebo prokládané (napø. Andìl, nebo 24
  hodin).
</para>

<para>
  Doporuèujeme, abyste si pøeèetli sekci o tom
  <link linkend="menc-feat-telecine">Jak si poradit s telecine a prokladem na NTSC DVD</link>
  a nauèili se jak vyu¾ít rùzné mo¾nosti.
</para>

<para>
  Pokud ov¹em vìt¹inou ripujete pouze filmy, nejspí¹ se setkáváte
  s neprokládaným nebo prokládaným videem 24 snímkù/s. V tom pøípadì mù¾ete
  pou¾ít <option>pullup</option> filtr <option>-vf pullup,softskip</option>.
</para>

</sect2>

<sect2 id="menc-feat-dvd-mpeg4-encoding-interlaced">
<title>Enkódování prokládaného videa</title>

<para>
  Pokud je film, který chcete enkódovat, prokládaný (NTSC video nebo
  PAL video), budete si muset vybrat, zda jej chcete "odprolo¾it" nebo ne.
  Zatímco odstranìní prokladu uèiní vá¹ film pou¾itelným na progresivnì
  vykreslovaných zobrazovaèích jako jsou poèítaèové monitory a projektory.
  Cenou za to je, sní¾ení rychlosti z 50 nebo 60000/1001 pùlsnímkù za sekundu
  na 25 nebo 30000/1001 snímkù za sekundu a zhruba polovina informací bude
  z va¹eho filmu ztracena ve scénách s významným mno¾stvím pohybu.
</para>

<para>
  Proto pokud enkódujete ve vysoké kvalitì pro archivaèní úèely, doporuèujeme
  ponechat film prokládaný.
  V¾dy mù¾ete provést odstranìní prokladu pøi pøehrávání pokud zobrazujete
  na progresivním zaøízení a pøehrávaèe v budoucnosti budou schopny odstraòovat
  proklad v plné pùlsnímkové rychlosti, èili odvozovat 50 nebo 60000/1001
  úplných snímkù za sekundu z prokládaného videa.
</para>

<para>
Kdy¾ pracujete s prokládaným videem, musíte zvlá¹tì dbát na:
</para>

<orderedlist>
<listitem><para>
  Vý¹ka a svislé odsazení pro oøezání musí být násobkem 4.
</para></listitem>
<listitem><para>
  Jakékoli svislé ¹kálování musí být provedeno v prokládaném re¾imu.
</para></listitem>
<listitem><para>
  Postprocesní a od¹umovací filtry nemusí pracovat podle oèekávání,
  dokud nezaøídíte, aby zpracovávaly najednou pouze jeden pùlsnímek a
  mohou vám po¹kodit video pøi nesprávném pou¾ití.
</para></listitem>
</orderedlist>

<para>
S vìdomím tìchto souvislostí vám pøedkládáme první pøíklad:
</para>
<screen>
  mencoder <replaceable>capture.avi</replaceable> -mc 0 -oac lavc -ovc lavc -lavcopts \
  vcodec=mpeg2video:vbitrate=6000:ilme:ildct:acodec=mp2:abitrate=224
</screen>
<para>
Pov¹imnìte si voleb <option>ilme</option> a <option>ildct</option>.
</para>
</sect2>


<sect2 id="menc-feat-dvd-mpeg4-av-sync">
<title>Poznámky k Audio/Video synchronizaci</title>
<para>
<application>MEncoder</application>ovy audio/video synchronizaèní
algoritmy byly navr¾eny se zámìrem obnovy souborù s vadnou synchronizací.
V nìkterých pøípadech v¹ak mù¾ou pùsobit zbyteèné zahazování a duplikaci snímkù
a mo¾ná mírnou A/V desynchronizaci pøi pou¾ití s bezvadným vstupem
(pøirozenì tyto A/V synchronizaèní omezení projeví pouze pokud kopírujete
zvukovou stopu pøi pøekódovávání videa, co¾ je velmi doporuèováno).
Mù¾ete v¹ak pøepnout do základní A/V synchronizace s volbou
<option>-mc 0</option>, nebo ji pøidejte do svého konfiguraèního souboru
<systemitem>~/.mplayer/mencoder</systemitem> config file, aspoò pokud pracujete
pouze s kvalitními zdroji (DVD, zachytávaná TV, vysoce kvalitní MPEG-4 ripy,
atd) ale nikoli s vadnými ASF/RM/MOV soubory.
</para>
<para>
Chcete-li si dále pohlídat podivné zahazování snímkù a duplikaci, mù¾ete pou¾ít
<option>-mc 0</option> spolu s <option>-noskip</option>.
To zamezí <emphasis>ve¹keré</emphasis> A/V synchronizaci a snímky se skopírují
jedna k jedné, tak¾e to nelze pou¾ít ve spojení s filtry, které v nestø¾eném
okam¾iku pøidají nebo zahodí snímky, nebo pokud zdrojové video má promìnnou
snímkovou rychlost!
V tom pøípadì není pou¾ití <option>-noskip</option> obecnì doporuèováno.
</para>
<para>
O takzvaném "tøíprùchodovém" enkódování zvuku podporované
<application>MEncoder</application>em bylo hlá¹eno, ¾e zpùsobuje A/V
desynchronizaci.
To nastává tehdy, pokud je pou¾ito v kombinaci s nìkterými filtry, tak¾e
<emphasis>není</emphasis> v tuto chvíli doporuèováno pou¾ívat tøíprùchodové
enkódování zvuku.
Tato vlastnost je zachována pouze z dùvodu kompatibility a pro expertní
u¾ivatele, kteøí vìdí, kdy je bezpeèné ji pou¾ít a kdy ne.
Pokud jste o tomto re¾imu nikdy pøedtím nesly¹eli, zapomìòte, ¾e jsme se
o nìm vùbec zmínili!
</para>
<para>
Existují rovnì¾ hlá¹ení o A/V desynchronizaci pøi enkódování ze stdin
<application>MEncoder</application>em.
Nedìlejte to! V¾dy pou¾ijte jako zdroj soubor nebo CD/DVD/atd zaøízení.
</para>
</sect2>

<sect2 id="menc-feat-dvd-mpeg4-codec">
<title>Výbìr video kodeku</title>

<para>
  Výbìr vhodného video kodeku k pou¾ití závisí na nìkolika faktorech.
  Nìkteré z nich jsou èistì vìcí osobního vkusu, nìkteré závisí na technických
  omezeních.
</para>
<itemizedlist>
  <listitem><para>
  <emphasis role="bold">Úèinost komprimace</emphasis>:
  Jednodu¹e mù¾eme øíct, ¾e novìj¹í generace kodekù jsou vytvoøeny
  tak, aby dosahovaly vy¹¹í kvality obrazu ne¾ ty pøedchozí.
  Proto neudìláte chybu,
  <footnote id='fn-menc-feat-dvd-mpeg4-codec-cpu'>
  <para>Buïte v¹ak opartní: Dekódování MPEG-4 AVC videa v DVD
  rozli¹ení vy¾aduje rychlý stroj (napø.Pentium 4 nad 1.5Ghz, nebo
  Pentium M nad 1Ghz).
  </para></footnote>
  kdy¾ zvolíte MPEG-4 AVC kodeky, jako
  <systemitem class="library">x264</systemitem> místo MPEG-4 ASP kodekù
  jako jsou <systemitem class="library">libavcodec</systemitem> MPEG-4, nebo
  <systemitem class="library">XviD</systemitem>.
  (Pro lep¹í pøedstavu o fundamentálních rozdílech mezi
  MPEG-4 ASP a MPEG-4 AVC si mù¾ete pøeèíst èlánek
  "<ulink url="http://guru.multimedia.cx/?p=10">15 dùvodù proè mì ¹tve MPEG4</ulink>"
  z blogu Michaela Niedermayera.)
  Podobnì dosáhnete lep¹í kvality pou¾itím MPEG-4 ASP místo
  MPEG-2 kodekù.
  </para>
  <para>
  Novìj¹í kodeky, které jsou v rozsáhlém vývoji, mohou obsahovat chyby,
  kterých si dosud nikdo nev¹iml a které mohou znièit výsledek.
  To je daò za pou¾ití nejnovìj¹í technologie.
  </para>
  <para>
  Navíc, v zaèátku pou¾ívání nového kodeku se budete muset strávit nìjaký
  èas seznámením se s jeho volbami, abyste se dovìdìli co kde nastavit pro
  dosa¾ení po¾adované kvality obrazu.
  </para></listitem>

  <listitem><para>
  <emphasis role="bold">Hardwarová kompatibilita</emphasis>:
  Obvykle trvá dlouhou dobu, ne¾ zaènou stolní video pøehrávaèe podporovat
  nejnovìj¹í videokodeky. Výsledkem toho je, ¾e vìt¹ina z nich podporuje
  pouze kodeky MPEG-2 a MPEG-4 ASP
  (Pozor: obvykle nejsou podporovány v¹echny vlastnosti (features) MPEG-4 ASP).
  Nahlédnìte prosím do technických specifikací va¹eho pøehrávaèe (pokud jsou),
  nebo si vygooglete více informací.
  </para></listitem>

  <listitem><para>
  <emphasis role="bold">Nejlep¹í kvalita na enkódovací èas</emphasis>:
  Kodeky, které ji¾ jsou zde nìjakou dobu (jako
  <systemitem class="library">libavcodec</systemitem> MPEG-4 a
  <systemitem class="library">XviD</systemitem>), jsou obvykle vysoce
  optimalizovány v¹emi druhy chytrých algoritmù a SIMD assembly kódem.
  Proto mají snahu dosahovat nejlep¹í pomìr kvality na enkódovací èas.
  Mohou v¹ak mít nìkteré velmi pokroèilé volby, které, pokud jsou zapnuty,
  velmi spomalí enkódování pøi mizivém zisku.
  </para>
  <para>
  Pokud vám jde o rychlost, mìli byste se dr¾et výchozího nastavení
  video kodeku (co¾ neznamená, ¾e byste nemìli experimentovat s nìkterými
  volbami zmínìnými v ostatních èástech této pøíruèky).
  </para>
  <para>
  Rovnì¾ mù¾ete zvá¾it pou¾ití kodeku, který umí vícevláknové zpracování.
  <systemitem class="library">libavcodec</systemitem> MPEG-4 to umo¾òuje.
  Získáte tím malý nárùst rychlosti za cenu ni¾¹í kvality obrazu.
  <systemitem class="library">XviD</systemitem> má k dispozici nìkteré
  experimentální záplaty pro zrychlení rychlosti enkódování, obvykle
  o 40&ndash;60%, s nízkým zhor¹ením obrazu.
  <systemitem class="library">x264</systemitem> rovnì¾ umo¾òuje vícevláknové
  enkódování, které v souèasnosti zrychluje enkódování asi o 15&ndash;30%
  ale sní¾í PSNR o 0.05dB.
  </para></listitem>

  <listitem><para>
  <emphasis role="bold">Osobní vkus</emphasis>:
  Zde jsme v rovinì témìø iracionální: Ze stejného dùvodu, pro který nìkteøí
  setrvávali léta u DivX&nbsp;3 i kdy¾ novìj¹í kodeky ji¾ dìlaly zázraky,
  preferují nìkteøí lidé <systemitem class="library">XviD</systemitem>
  nebo <systemitem class="library">libavcodec</systemitem> MPEG-4 pøed
  <systemitem class="library">x264</systemitem>.
  </para>
  <para>
  Posuïte to sami a ne v¾dy poslouchejte to, co vám nìkteøí lidé budou
  øíkat, ¾e máte dìlat nebo myslet: Nejlep¹í kodek je ten, který nejlépe
  ovládáte a který se pro vás vypadá nejlépe na va¹í obrazovce
  <footnote id='fn-menc-feat-dvd-mpeg4-codec-playback'>
  <para>Stejný film nemusí vypadat stejnì na monitoru nìkoho jiného, nebo
  kdy¾ je pøehráván jiným dekodérem, tak¾e si provìøujte své výtvory
  pøehráváním na rùzných sestavách.</para></footnote>!
  </para></listitem>
</itemizedlist>
<para>
  Seznam podporovaných kodekù najdete v sekci
  <link linkend="menc-feat-selecting-codec">výbìr kodekù a nosných formátù</link>.
</para>
</sect2>

<sect2 id="menc-feat-dvd-mpeg4-audio">
<title>Zvuk</title>

<para>
  Zvuk je mnohem jednodu¹¹í problém k øe¹ení: pokud prahnete po kvalitì, prostì
  jej nechte jak je.
  Dokonce i AC3 5.1 datové proudy mají nanejvý¹ 448Kbitù/s a stojí za ka¾dý bit.
  Mo¾ná jste v poku¹ení pøevést zvuk do Ogg Vorbis pøi vysoké kvalitì, ale jen
  proto, ¾e dnes nemáte A/V receiver pro hardwarové dekódování AC3 neznamená,
  ¾e jej nebudete mít zítra. Pøipravte své DVD ripy na budoucnost zachováním
  AC3 datových proudù.
  Datový proud AC3 mù¾ete zachovat buï jeho zkopírováním pøímo do video proudu
  <link linkend="menc-feat-mpeg4">bìhem enkódování</link>.
  Také mù¾ete extrahovat AC3 proud, abyste jej pak namixovali do nosièù jako je
  NUT nebo Matroska.
  <screen>mplayer <replaceable>zdrojový_soubor.vob</replaceable> -aid 129 -dumpaudio -dumpfile <replaceable>zvuk.ac3</replaceable></screen>
  vytáhne do souboru <replaceable>zvuk.ac3</replaceable> zvukovou stopu
  èíslo 129 ze souboru <replaceable>zdrojový_soubor.vob</replaceable> (NB: DVD
  VOB soubory obvykle pou¾ívají odli¹né èíslování audia,
  co¾ znamená, ¾e VOB zvuková stopa 120 je druhou zvukovou stopou v souboru).
</para>

<para>
  Nìkdy ov¹em opravdu nemáte jinou mo¾nost ne¾ dále zkomprimovat zvuk, aby vám
  zbylo více bitù na video.
  Vìt¹ina lidí volí komprimaci buï pomocí MP3 nebo Vorbis audio kodekù.
  Zatímco ten druhý je efektivnìj¹í z prostorového hlediska, MP3 je lépe
  podporován hardwarovými pøehrávaèi, aèkoli èasy se mìní.
</para>

<para>
  <emphasis>Nepou¾ívejte</emphasis> <option>-nosound</option>, enkódujete-li
  soubor se zvukem, dokonce i v tom pøípadì, ¾e budete enkódovat a muxovat
  zvuk samostatnì pozdìji.
  Aèkoli to mù¾e v ideálním pøípadì fungovat, pou¾ití <option>-nosound</option>
  spí¹e skryje urèité problémy v nastaveních enkódování na pøíkazovém øádku.
  Jinými slovy vám pøítomnost zvukové stopy zajistí, pokud neuvidíte
  hlá¹ky typu
  <quote>Pøíli¹ mnoho audio paketù ve vyrovnávací pamìti</quote>, ¾e budete
  schopni dosáhnout správné synchronizace.
</para>

<para>
  Musíte nechat <application>MEncoder</application> zpracovat zvuk.
  Mù¾ete napøíklad skopírovat originální zvukovou stopu bìhem enkódování
  pomocí <option>-oac copy</option>, nebo jej pøevést na "tenký" 4 kHz mono WAV
  PCM pomocí <option>-oac pcm -channels 1 -srate 4000</option>.
  Jinak v nìkterých pøípadech vytvoøíte video soubor, který nebude synchronní
  se zvukem.
  Tyto pøípady nastávají tehdy, kdy¾ poèet videosnímkù ve zdroji neodpovídá
  celkové délce zvukových vzorkù, nebo pokud je zvuk pøeru¹ovaný èi pøekrývaný
  díky chybìjícím èi nadbývajícím audio vzorkùm.
  Správným zpùsobem jak toto øe¹it, je vlo¾ení ticha nebo odstøi¾ení zvuku na
  tìchto místech.
  <application>MPlayer</application> to v¹ak neumí, tak¾e pokud demuxujete
  AC3 zvuk a enkódujete jej zvlá¹tní aplikací (nebo jej dumpnete do PCM
  <application>MPlayer</application>em), zùstanou zmínìné vady jak jsou a
  jediný zpùsob jak je opravit je zahodit/namno¾it video snímky v tìchto
  místech.
  Dokud <application>MEncoder</application> sleduje zvuk pøi enkódování
  videa, mù¾e provádìt toto zahazování/duplikování (co¾ je obvykle OK,
  jeliko¾ nastává pøi èerné obrazovce/zmìnì scény, ale pokud
  <application>MEncoder</application> nevidí zvuk, zpracuje snímky jak jsou
  a ty pak nepasují na koneènou zvukovou stopu kdy¾ napøíklad spojíte svou
  video a zvukovou stopu do Matroska souboru.
</para>

<para>
  Nejdøíve ze v¹eho budete muset pøevést DVD zvuk do WAV souboru, který pak
  pou¾ije zvukový kodek jako vstup.
  Napøíklad:
  <screen>mplayer <replaceable>zdrojový_soubor.vob</replaceable> -ao pcm:file=<replaceable>výsledný_zvuk.wav</replaceable> -vc dummy -aid 1 -vo null</screen>
  vylije druhou zvukovou stopu ze souboru
  <replaceable>zdrojový_soubor.vob</replaceable> do souboru
  <replaceable>výsledný_zvuk.wav</replaceable>.
  Mìli byste normalizovat zvuk pøed enkódováním, proto¾e DVD zvukové stopy jsou
  obvykle nahrávány pøi nízkých hlasitostech.
  Mù¾ete napøíklad pou¾ít nástroj <application>normalize</application>, který je
  k dispozici ve vìt¹inì distribucí.
  Pokud pou¾íváte Windows, stejnou práci udìlá nástroj jako
  <application>BeSweet</application>.
  Komprimovat budete buï ve Vorbisu nebo MP3.
  Napøíklad:
  <screen>oggenc -q1 <replaceable>cílový_zvuk.wav</replaceable></screen>
  provede enkódování <replaceable>cílového_zvuku.wav</replaceable> s kvalitou 1,
  která pøibli¾nì odpovídá 80Kb/s a je to minimální kvalita na kterou byste mìli
  enkódovat, pokud vám zále¾í na kvalitì.
  Poznamenejme, ¾e <application>MEncoder</application> v souèasnosti neumí
  muxovat Vorbis zvukové stopy do výstupního souboru, proto¾e podporuje pouze
  AVI a MPEG kontejnery jako výstup. Pro oba platí, ¾e nìkteré pøehrávaèe mohou
  mít problémy s udr¾ením audio/video synchronizace, pokud je pøítomen VBR zvuk
  jako je Vorbis.
  Nemìjte obavy, v tomto dokumentu vám uká¾eme, jak to lze udìlat pomocí
  programù tøetích stran.
</para>

</sect2>


<sect2 id="menc-feat-dvd-mpeg4-muxing">
<title>Muxování (multiplexování)</title>
<para>
  Nyní, kdy¾ máte své video enkódované, budete jej nejspí¹ chtít muxovat
  s jedním nebo více zvukovými stopami do nosného filmového formátu, jako je
  AVI, MPEG, Matroska nebo NUT.
  <application>MEncoder</application> je zatím schopen nativnì zapracovat
  zvuk a video pouze do nosných formátù MPEG a AVI.
  Napøíklad:
  <screen>mencoder -oac copy -ovc copy  -o <replaceable>výstupní_film.avi</replaceable> -audiofile <replaceable>vstupní_audio.mp2</replaceable> <replaceable>vstupní_video.avi</replaceable></screen>
  To by mìlo slouèit video soubor <replaceable>vstupní_video.avi</replaceable>
  a zvukový soubor <replaceable>vstupní_audio.mp2</replaceable>
  do AVI souboru <replaceable>výstupní_film.avi</replaceable>.
  Tento pøíkaz pracuje s MPEG-1 layer I, II a III (známým jako MP3) zvukem,
  WAV a také nìkolika dal¹ími formáty zvuku.
</para>

<para>
  <application>MEncoder</application> obsahuje experimentální podporu pro
  <systemitem class="library">libavformat</systemitem>, co¾ je knihovna
  z projektu FFmpeg, která podporuje muxování a demuxování celé øady nosných
  formátù.
  Napøíklad:
  <screen>mencoder -oac copy -ovc copy  -o <replaceable>výstupní_film.asf</replaceable> -audiofile <replaceable>vstupní_audio.mp2</replaceable> <replaceable>vstupní_video.avi</replaceable> -of lavf -lavfopts format=asf</screen>
  To provede stejnou èinnost jako pøedchozí pøíklad, av¹ak výstupním formátem
  bude ASF.
  Prosím berte na vìdomí, ¾e tato podpora je velmi experimentální (ale de ode
  dne lep¹í) a bude funkèní pouze pokud jste zkompilovali
  <application>MPlayer</application> s podporou pro
  <systemitem class="library">libavformat</systemitem> (co¾ znamená, ¾e
  pøedkompilovaná binární verze nebude vìt¹inou fungovat).
</para>


<sect3 id="menc-feat-dvd-mpeg4-muxing-filter-issues">
<title>Zlep¹ování spolehlivosti muxování a A/V synchronizace</title>
<para>
  Mù¾ete se dostat do vá¾ných problémù s A/V sychronizací, pokud se sna¾íte
  muxovat video a nìkteré zvukové stopy, kdy bez ohledu na nastavení zpo¾dìní
  zvuku nedosáhnete správné synchronizace.
  To mù¾e nastat, pokud pou¾ijete nìkteré video filtry, které zahodí nebo
  zdvojí nìkteré snímky, jako jsou filtry pro inverzi telecine.
  Velmi doporuèujeme pøidat videofiltr <option>harddup</option> na samý konec
  øetìzu videofiltrù pro potlaèení tohoto problému.
</para>

<para>
  Bez <option>harddup</option>, pokud chce <application>MEncoder</application>
  duplikovat snímek, závisí na muxeru, aby vlo¾il znaèku do nosièe, tak¾e
  bude poslední snímek zobrazen znovu, aby se dosáhlo synchronizace, pøièem¾
  se nezapí¹e ¾ádný snímek.
  S <option>harddup</option>, <application>MEncoder</application>
  pustí poslední zobrazený snímek znovu do øetìzu filtrù.
  To znamená, ¾e enkodér obdr¾í stejný snímek dvakrát a comprimuje ho.
  To povede k o nìco vìt¹ímu souboru, ale nezpùsobí problémy pøi demuxování
  nebo remuxování do jiného nosného formátu.
</para>

<para>
  Rovnì¾ nemáte jinou mo¾nost ne¾ pou¾ít <option>harddup</option> s tìmi
  nosnými formáty, které nejsou tìsnì spjaty s
  <application>MEncoder</application>em, jako jsou ty, které jsou podporovány
  pøes <systemitem class="library">libavformat</systemitem>, které nemusí
  podporovat duplikaci na úrovni nosného formátu.
</para>
</sect3>


<sect3 id="menc-feat-dvd-mpeg4-muxing-avi-limitations">
<title>Limitace nosného formátu AVI</title>
<para>
  Aèkoli je to po MPEG-1 nejpodporovanìj¹í nosný formát, má AVI i jisté
  zásadní nedostatky. Snad nejviditelnìj¹í je re¾ie.
  Na ka¾dý chunk AVI souboru je 24 bajtù ztraceno na hlavièky a index.
  To se projeví asi 5 MP na hodinu, neboli 1-2.5% prodlou¾ení 700 MB filmu.
  Nevypadá to jako mnoho, ale mù¾e to znamenat rozdíl mezi mo¾ností pou¾ít
  video pøi 700 kbitech/s nebo 714 kbitech/s a tady se ka¾dý bit projeví na
  kvalitì.
</para>

<para>
  Navíc k této neefektivitì má AVI také následující hlavní omezení:
</para>

<orderedlist>
<listitem>
<para>
  Mù¾e být uchováván pouze obsah s konstantní snímkovou rychlostí. To je
  zvlá¹tì omezující, kdy¾ má pùvodní materiál, který chcete enkódovat, smí¹ený
  obsah. Napøíklad smìs NTSC videa a filmového materiálu.
  Jistì¾e jsou zde cestièky, které umo¾ní ulo¾it obsah se smí¹enou snímkovou
  rychlostí v AVI, ale ty zvy¹ují (ji¾ tak velkou) re¾ii pìtinásobnì nebo víc,
  proto nejsou praktické.
</para>
</listitem>
<listitem>
<para>
  Zvuk v AVI musí mít buï konstantní datový tok (CBR) nebo konstantní velikost
  rámce (èili v¹echny rámce se dekódují na stejný poèet vzorkù).
  Nane¹tìstí ten nejefektivnìj¹í kodek, Vorbis, nesplòuje ani jeden z tìchto
  po¾adavkù.
  Pokud tedy plánujete ulo¾it svùj film do AVI, budete muset pou¾ít ménì
  efektivní kodek, jako MP3 nebo AC3.
</para>
</listitem>
</orderedlist>

<para>
  Z vý¹e uvedených dùvodù <application>MEncoder</application> zatím
  nepodporuje promìnnou snímkovou rychlost ani enkódování do Vorbisu.
  Nemusíte to v¹ak pova¾ovat za omezení, jestli¾e je
  <application>MEncoder</application> jediným nástrojem pro va¹e
  enkódování. Nakonec je mo¾né pou¾ít <application>MEncoder</application> pouze
  pro enkódování videa a pak pou¾ít externí nástroje pro enkódování zvuku a
  namuxování do jiného nosného formátu.
</para>
</sect3>

<sect3 id="menc-feat-dvd-mpeg4-muxing-matroska">
<title>Muxování do nosného formátu Matroska</title>
<para>
  Matroska je svobodný a otevøený standard nosného formátu, zamìøený na
  nabídku mnoha pokroèilých vlastností, které star¹í nosné formáty, jako AVI,
  nemohou poskytnout.
  Napøíklad Matroska podporuje zvuk s promìnným datovým tokem (VBR),
  promìnné snímkové rychlosti (VFR), kapitoly, pøílohy souborù, kód pro
  detekci chyb (EDC) a moderní A/V kodeky jako "Advanced Audio
  Coding" (AAC), "Vorbis" nebo "MPEG-4 AVC" (H.264), z nich¾ ¾ádný nelze
  pou¾ít v AVI.
</para>

<para>
  Nástroje pro vytváøení Matroska souborù jsou souhrnnì nazvány 
  <application>mkvtoolnix</application> a jsou dostupné pro vìt¹inu Unixových
  platforem a stejnì tak <application>Windows</application>.
  Proto¾e je Matroska otevøený standard, mù¾ete najít jiné nástroje, které vám
  lépe padnou, ale proto¾e mkvtoolnix je nejroz¹íøenìj¹í a je podporován
  pøímo Matroska týmem, pokryjeme jen jejich pou¾ití.
</para>

<para>
  Asi nejsnaz¹í zpùsob, jak zaèít s Matroskou je pou¾ít 
  <application>MMG</application>, grafickou nadstavbu dodávanou s
  <application>mkvtoolnix</application> a øídit se
  <ulink url="http://www.bunkus.org/videotools/mkvtoolnix/doc/mkvmerge-gui.html">návodem k mkvmerge GUI (mmg)</ulink>
</para>

<para>
  Mù¾ete rovnì¾ muxovat zvukové a video soubory z pøíkazového øádku:
  <screen>mkvmerge -o <replaceable>výstup.mkv</replaceable> <replaceable>vstupní_video.avi</replaceable> <replaceable>vstupní_audio1.mp3</replaceable> <replaceable>vstupní_audio2.ac3</replaceable></screen>
  To spojí video soubor <replaceable>vstupní_video.avi</replaceable>
  a dva zvukové soubory <replaceable>vstupní_audio1.mp3</replaceable>
  a <replaceable>vstupní_audio2.ac3</replaceable> do Matroska souboru
  <replaceable>výstup.mkv</replaceable>.
  Matroska, jak jsme ji¾ øekli, umí mnohem víc ne¾ to, jako více zvukových stop
  (vèetnì doladìní audio/video synchronizace), kapitoly, titulky, støíhání,
  atd...
  Detaily naleznete v dokumentaci k tìmto aplikacím.
</para>

</sect3>

</sect2>

</sect1>

<sect1 id="menc-feat-telecine">
<title>Jak nalo¾it s telecine a prokladem v NTSC DVD</title>

<sect2 id="menc-feat-telecine-intro">
<title>Pøedstavení</title>
<formalpara>
<title>Co je to telecine?</title>
<para>
  Pokud moc nerozumíte tomu, co je napsáno v tomto dokumentu, doporuèujeme
  nav¹tívit tuto stránku:
  <ulink url="http://www.divx.com/support/guides/guide.php?gid=10">http://www.divx.com/support/guides/guide.php?gid=10</ulink>
  Na této adrese je srozumitelný a rozumnì vyèerpávající popis co je to
  telecine.
</para></formalpara>

<formalpara>
<title>Poznámka k èíslùm.</title>
<para>
  Mnoho dokumentù, vèetnì vý¹e odkazované pøíruèky, udává hodnotu pùlsnímkù za
  sekundu NTSC videa jako 59.94 a odpovídající snímky za sekundu jako 29.97
  (pro telecinované a prokládané video) a 23.976 (pro neprokládané).
  Pro jednoduchost nìkteré dokumenty zaokrouhlují tyto hodnoty na 60, 30 a 24.
</para></formalpara>

<para>
  Pøesnì øeèeno jsou v¹echny tyto èísla pøibli¾ná. Èernobílé NTSC video mìlo
  pøesnì 60 pùlsnímkù za sekundu, ale pozdìji byla zvolena hodnota 60000/1001,
  aby bylo mo¾né pøidat barevná data a zùstat kompatibilní se starými
  èernobílými televizemi. Digitální NTSC (jak je na DVD) má rovnì¾ rychlost
  60000/1001 pùlsnímkù za sekundu. Z toho vyplývá, ¾e prokládané a telecinované
  video má 30000/1001 snímkù za sekundu; neprokládané video má 24000/1001 snímkù
  za sekundu.
</para>

<para>
  Star¹í verze dokumentace <application>MEncoder</application>u a mnoho zpráv
  v archivu konference hovoøí o 59.94, 29.97 a 23.976.
  V¹echna dokumentace <application>MEncoder</application>u byla aktualizována
  a pou¾ívá zlomkových hodnot. Vy byste je mìli pou¾ívat také.
</para>

<para>
  <option>-ofps 23.976</option> je nesprávnì.
  Místo toho byste mìli pou¾ít <option>-ofps 24000/1001</option>.
</para>

<formalpara>
<title>Jak je pou¾íváno telecine.</title>
<para>
  Ve¹keré video urèené k zobrazení na NTSC televizi musí mít 60000/1001
  pùlsnímkù za sekundu. Filmy vyrábìné pro televizi jsou èasto natáèeny pøímo
  ve 60000/1001 pùlsnímcích za sekundu, ale vìt¹ina filmù do kin je natáèena pøi
  24 nebo 24000/1001 snímcích za sekundu. Kdy¾ je film pøepisován na DVD, je
  video upraveno pro televizi v procesu zvaném telecine.
</para></formalpara>

<para>
  Na DVD není video ve skuteènosti nikdy ulo¾eno v 60000/1001 pùlsnímcích za
  sekundu. Video je¾ bylo pùvodnì 60000/1001, bude mít ka¾dý pár pùlsnímkù
  zkombinován do podoby snímku s rychlostí 30000/1001 snímkù za sekundu.
  Hardwarové DVD pøehrávaèe pak ètou pøíznak, zabudovaný ve video proudu, který
  udává jestli první pùlsnímek tvoøí liché nebo sudé øádky.
</para>

<para>
  Obsah ve 24000/1001 snímcích za sekundu obvykle zùstává tak jak byl v dobì
  pøepisu na DVD a DVD pøehrávaè musí provést telecine za letu. Nìkdy je v¹ak
  video telecinováno <emphasis>pøed</emphasis> ulo¾ením na DVD; dokonce i kdy¾
  mìlo pùvodnì 24000/1001 snímkù za sekundu, bude mít 60000/1001 pùlsnímkù za
  sekundu. Pokud je ulo¾en na DVD, páry pùlsnímkù jsou zkombinovány do formy
  30000/1001 snímkù za sekundu.
</para>

<para>
  Kdy¾ se podíváme na jednotlivé snímky vzniklé z videa o 60000/10001 pùlsnímcích
  za sekundu, telecinovaného nebo ne, je zøetelnì vidìt toto prokládání jakmile
  je zde nìjaký pohyb, jeliko¾ jeden pùlsnímek (øeknìme liché øádky)
  reprezentuje èasový okam¾ik o 1/(60000/1001) sekundy pozdìj¹í ne¾ ten druhý.
  Pøehrávání prokládaného videa na poèítaèi vypadá ¹karedì jak proto, ¾e monitor
  má vy¹¹í rozli¹ení, ale i proto¾e video je zobrazováno snímek po snímku místo
  pùlsnímek po pùlsnímku.
</para>

<itemizedlist>
<title>Poznámky:</title>
<listitem><para>
  Tento odstavec platí pouze pro NTSC DVD, nikoli PAL.
  </para></listitem>
<listitem><para>
  Øádky s pøíklady spu¹tìní <application>MEncoder</application>u v dokumentu
  <emphasis role="bold">nejsou</emphasis> urèeny pro opravdové pou¾ití.
  Obsahují pouze nutné minimum vy¾adované pro enkódování pøíslu¹né ke kategorii
  videa. Jak dìlat dobré DVD ripy nebo doladit
  <systemitem class="library">libavcodec</systemitem> pro maximální kvalitu
  není v zábìru tohoto dokumentu.
  </para></listitem>
<listitem><para>
  Poznámky pod èarou pøíslu¹né pro tuto pøíruèku jsou linkovány takto:
  <link linkend="menc-feat-telecine-footnotes">[1]</link>
  </para></listitem>
</itemizedlist>
</sect2>

<sect2 id="menc-feat-telecine-ident">
<title>Jak zjistit o jaký typ videa se jedná</title>

<sect3 id="menc-feat-telecine-ident-progressive">
<title>Progresivní (neprokládané)</title>
<para>
  Progresivní video je pùvodnì natoèeno pøi 24000/1001 snímcích za sekundu a
  ulo¾eno na DVD beze zmìn.
</para>

<para>
  Kdy¾ pøehrajete progresivní DVD v <application>MPlayer</application>u,
  <application>MPlayer</application> vypí¹e následující øádek jakmile zaène
  pøehrávat:

  <screen> demux_mpg: 24000/1001 fps progressive NTSC content detected, switching framerate.</screen>

  Od tohoto okam¾iku by demux_mpg nemìl nikdy øíct ¾e na¹el
  &quot;30000/1001 fps NTSC obsah.&quot;
</para>

<para>
  Kdy¾ sledujete progresivní video, nemìli byste nikdy vidìt ¾ádný proklad.
  Dejte si ale pozor, jeliko¾ je obèas tro¹ku telecine namixováno tam, kde byste
  to vùbec neèekali. Setkal jsem se s TV show na DVD, které mìly sekundu
  telecine pøi ka¾dé zmìnì scény nebo na zcela náhodných místech. Jednou jsem se
  díval na DVD, které bylo do pùlky progresivní a od pùlky telecinováno. Pokud
  chcete být <emphasis>opravdu</emphasis> dùkladní, mù¾ete oskenovat celý film:

  <screen>mplayer dvd://1 -nosound -vo null -benchmark</screen>

  Pou¾ití volby <option>-benchmark</option> nechá
  <application>MPlayer</application> pøehrát film tak rychle, jak je to jen
  mo¾né; stejnì to ale, v závislosti na va¹em stroji, chvíli potrvá.
  V¾dy, kdy¾ demux_mpg ohlásí zmìnu snímkové rychlosti, øádek tìsnì nad hlá¹ením
  uká¾e èas ve kterém ke zmìnì do¹lo.
</para>

<para>
  Obèas je progresivní video na DVD oznaèeno jako
  &quot;soft-telecine&quot; proto¾e je zamý¹leno, aby telecine provedl DVD
  pøehrávaè.
</para>
</sect3>

<sect3 id="menc-feat-telecine-ident-telecined">
<title>Telecinováno (pøepsáno pro NTSC televizi)</title>
<para>
  Telecinované video bylo pùvodnì natoèeno pøi 24000/1001, ale bylo telecinováno
  <emphasis>pøed</emphasis> zápisem na DVD.
</para>

<para>
  <application>MPlayer</application> (nikdy) nehlásí ¾ádnou zmìnu snímkové
  rychlosti, kdy¾ pøehrává telecinované video.
</para>

<para>
  Pøi sledování telecinovaného videa uvidíte prokladové artefakty, které jako by
  &quot;blikaly&quot;: opakovanì mizí a objevují se.
  Blí¾e se na to mù¾ete podívat:
  <orderedlist>
  <listitem>
    <screen>mplayer dvd://1</screen>
    </listitem>
  <listitem><para>
    Pøeviòte na èást s pohybem.
    </para></listitem>
  <listitem><para>
    Pou¾ijte klávesu <keycap>.</keycap> pro krokování po jednom snímku.
    </para></listitem>
  <listitem><para>
    Sledujte vzor prokládanì vypadajících a progresivnì vypadajících snímkù.
    Pokud je vzor, který sledujete PPPII,PPPII,PPPII,..., pak je video
    telecinováno. Pokud vidíte jiný vzor, pak mohlo být video telecinováno
    pou¾itím nìjaké nestandardní metody; <application>MEncoder</application>
    neumí bezztrátovì pøevést nestandardní telecine do progresivního. Pokud
    nevidíte ¾ádný vzor, pak je video nejspí¹ prokládané.
    </para></listitem>
  </orderedlist>
</para>

<para>
  Nìkdy je telecinované video na DVD oznaèeno jako &quot;hard-telecine&quot;.
  Jeliko¾ hard-telecine ji¾ je ve 60000/1001 pùlsnímcích za sekundu, DVD
  pøehrávaè pøehraje video bez jakýchkoli manipulací.
</para>

<para>
  Dal¹ím zpùsobem jak zjistíte, ¾e je vá¹ zdroj telecinován, je pøehrát
  jej s volbami <option>-vf pullup</option> a <option>-v</option> a
  uvidíte, jak <option>pullup</option> nachází vzor.
  Pokud je zdroj telecinován, mìlibyste vidìt na konzoli vzor 3:2 s opakujícím
  se <systemitem>0+.1.+2</systemitem> a <systemitem>0++1</systemitem>.
  Tato technika má tu výhodu, ¾e nemusíte sledovat zdroj, abyste jej
  identifikovali, co¾ se mù¾e hodit, pokud chcete automatizovat enkódovací
  proceduru, nebo ji provést vzdálenì pøes pomalou linku.
</para>

</sect3>

<sect3 id="menc-feat-telecine-ident-interlaced">
<title>Prokládané</title>
<para>
  Prokládané video bylo od samého zaèátku filmováno pøi 60000/1001 pùlsnímcích
  za sekundu a ulo¾eno na DVD ve 30000/1001 snímcích za sekundu. Efekt
  prokládání (èasto oznaèovaný jako &quot;roztøepení&quot;) je výsledkem
  skládání pùlsnímkù do snímkù. Vzdálenost mezi pùlsnímky má být 1/(60000/1001)
  sekundy a proto kdy¾ jsou zobrazeny souèasnì, je rozdíl jasnì patrný.
</para>

<para>
  Stejnì jako u telecinovaného videa by <application>MPlayer</application> nemìl
  hlásit jakékoli zmìny snímkové rychlosti pøi pøehrávání prokládaného obsahu.
</para>

<para>
  Kdy¾ si prohlédnete video blí¾e pomocí krokování snímkù pomocí klávesy
  <keycap>.</keycap>, uvidíte, ¾e ka¾dý jednotlivý snímek je prokládaný.
</para>
</sect3>

<sect3 id="menc-feat-telecine-ident-mixedpt">
<title>Smí¹ené progresivní a telecinované</title>
<para>
  Ve¹kerý obsah &quot;smí¹eného progresivního a telecinovaného&quot; videa mìl
  pùvodnì 24000/1001 snímkù za sekundu, ale nìkteré èásti pro¹ly telecine.
</para>

<para>
  Kdy¾ <application>MPlayer</application> pøehrává tuto kategorii, bude (èasto
  i opakovanì) pøepínat mezi &quot;30000/1001 snímky/s NTSC&quot;
  a &quot;24000/1001 snímky/s progresivním NTSC&quot;. Sledujte spodek
  <application>MPlayer</application>ova výstupu, abyste zachytili tyto zprávy.
</para>

<para>
  Mìli byste provìøit èásti se &quot;30000/1001 snímky/s NTSC&quot;, abyste mìli
  jistotu, ¾e jsou skuteènì telecinovány a ne jen prokládané.
</para>
</sect3>

<sect3 id="menc-feat-telecine-ident-mixedpi">
<title>Smí¹ené progresivní a prokládané</title>
<para>
  Ve &quot;smí¹eném progresivním a prokládaném&quot; obsahu bylo progresivní a
  prokládané video splácáno dohromady.
</para>

<para>
  Tato kategorie vypadá jako &quot;smí¹ené progresivní a telecine&quot;,
  dokud si neprohlédnete èásti se 30000/1001 snímky/s a neuvidíte, ¾e nemají
  telecine vzor.
</para>
</sect3>

</sect2>

<sect2 id="menc-feat-telecine-encode">
<title>Jak enkódovat jednotlivé kategorie</title>
<para>
  Jak jsem se zmínil na zaèátku, pøíklady pøíkazových øádkù
  <application>MEncoder</application>u ní¾e <emphasis role="bold">nejsou</emphasis>
  urèeny pro praktické pou¾ití; pouze demonstrují, minimum voleb nutných k tomu,
  abyste správnì enkódovali ka¾dou kategorii.
</para>

<sect3 id="menc-feat-telecine-encode-progressive">
<title>Progresivní</title>
<para>
  Progresivní video nevy¾aduje ¾ádné speciální filtrování pro enkódování.
  Jediná volba, která by urèitì nemìla chybìt je
  <option>-ofps 24000/1001</option>. Jinak se <application>MEncoder</application>
  pokusí enkódovat pøi 30000/1001 snímcích/s a bude opakovat snímky.
</para>

<para>
  <screen>mencoder dvd://1 -oac copy -ovc lavc -ofps 24000/1001</screen>
</para>

<para>
  Èasto se stává, ¾e video, které vypadá progresivnì, má v sobì zamíchány
  kratièké telecinované èásti. Pokud si nejste jisti, je nejbezpeènìj¹í
  pova¾ovat video za
  <link linkend="menc-feat-telecine-encode-mixedpt">smí¹ené progresivní a
  telecinované</link>. Ztráta výkonu je jen malá
  <link linkend="menc-feat-telecine-footnotes">[3]</link>.
</para>
</sect3>

<sect3 id="menc-feat-telecine-encode-telecined">
<title>Telecinované</title>
<para>
  Telecine lze obrátit a dostat tak pùvodní 24000/1001 obsah, za pou¾ití metody
  zvané inverzní telecine.
  <application>MPlayer</application> má nìkolik filtrù právì pro tuto èinnost;
  nejlep¹í z tìchto filtrù, <option>pullup</option>, je popsán v èásti
  <link linkend="menc-feat-telecine-encode-mixedpt">smí¹ené progresivní a
  telecinované</link>.
</para>
</sect3>

<sect3 id="menc-feat-telecine-encode-interlaced">
<title>Prokládané</title>
<para>
  V praxi není vìt¹inou mo¾né dostat kompletní progresivní video z prokládaného
  obsahu. Jediný zpùsob jak to udìlat bez ztráty poloviny svislého rozli¹ení je
  zdvojením snímkové rychlosti a zkusit &quot;odhadnout&quot; co mám provést
  s odpovídajícími linkami ka¾dého z pùlsnímkù (má to ov¹em i nevýhody &ndash;
  viz metoda 3).
</para>

<orderedlist>
<listitem><para>
  Enkódujte video v prokládané formì. Obvykle prokládání zpùsobí tì¾kou újmu
  schopnosti enkodéru dobøe komprimovat, ale
  <systemitem class="library">libavcodec</systemitem> má dvì volby urèené právì
  pro lep¹í ukládání prokládaného videa: <option> ildct</option> a
  <option>ilme</option>. Rovnì¾ velmi doporuèujeme pou¾ití volby
  <option>mbd=2</option> <link linkend="menc-feat-telecine-footnotes">[2] </link>
  proto¾e bude enkódovat makrobloky jako neprokládané tam, kde není ¾ádný pohyb.
  Volba <option>-ofps</option> zde <emphasis role="bold">není</emphasis> nutná.

  <screen>mencoder dvd://1 -oac copy -ovc lavc -lavcopts ildct:ilme:mbd=2</screen>
  </para></listitem>
<listitem><para>
  Pou¾ijte filtr odstraòující proklad pøed enkódováním. Je jich zde nìkolik,
  mù¾ete si vybrat. Ka¾dý z nich má svá pro i proti. Prohlédnìte si výstup
  <option>mplayer -pphelp</option> abyste zjistili, které jsou k dispozici
  (grep pro &quot;deint&quot;) a vyhledejte
  <ulink url="http://www.mplayerhq.hu/design7/info.html#mailing_lists">
  e-mailové konference MPlayeru</ulink>, kde naleznete mnoho diskusí o rùzných
  filtrech. Snímková rychlost se ani zde nemìní, tak¾e ¾ádné
  <option>-ofps</option>. Odstranìní proklady by rovnì¾ mìlo být provedeno po
  oøezání <link linkend="menc-feat-telecine-footnotes">[1]</link>, ale pøed
  ¹kálováním.

  <screen>mencoder dvd://1 -oac copy -vf pp=lb -ovc lavc</screen>
  </para></listitem>
<listitem><para>
  Nane¹tìstí je tato volba vadná v <application>MEncoder</application>u;
  mìla by dobøe pracovat v <application>MEncoder G2</application>, ale ten tu
  zatím není. Stejnì je urèením <option> -vf tfields</option> vytvoøení
  kompletního snímku z ka¾dého pùlsnímku, co¾ zvý¹í snímkovou rychlost na
  60000/1001. Výhoda tohoto pøístupu je v tom, ¾e nepøijdete o ¾ádná data;
  Proto¾e v¹ak ka¾dý snímek pochází jen z jediného pùlsnímku, musí být chybìjící
  linky nìjak dopoèítány. Neexistuje mnoho dobrých metod, generujících chybìjící
  data, tak¾e výsledek bude trochu podobný tomu, kdy¾ se pou¾ije nìkterý filtr
  odstraòující proklad.
  Generováním chybìjících linek vznikají dal¹í problémy tím, ¾e se zdvojnásobí
  mno¾ství dat. Tak¾e jsou potøeba vy¹¹í datové toky pro enkódování, aby byla
  zachována kvalita a spotøebuje se více výkonu CPU jak pro enkódování, tak pro
  dekódování. tfields má nìkolik rùzných voleb pro volbu zpùsobu generování
  chybìjících linek. Pokud pou¾ijete tuto mo¾nost, prostudujte si manuál a
  zvolte si volbu, která s va¹ím materiálem vypadá nejlépe.
  Poznamenejme, ¾e pøi pou¾ití <option>tfields</option>
  <emphasis role="bold">musíte</emphasis> nastavit <option>-fps</option> a
  <option>-ofps</option> na dvojnásobek snímkové rychlosti originálu.

  <screen>mencoder dvd://1 -oac copy -vf tfields=2 -ovc lavc -fps 60000/1001 -ofps 60000/1001</screen>
  </para></listitem>
<listitem><para>
  Pokud plánujete výrazné zmen¹ování, mù¾ete extrahovat a enkódovat jen jeden
  z pùlsnímkù. Samozøejmì pøijdete o polovinu svislého rozli¹ení, ale pokud
  plánujete zmen¹ení ideálnì na 1/2 originální velikosti, nebude na této ztrátì
  vùbec zále¾et. Výsledek bude progresivní soubor s 30000/1001 snímky za sekundu.
  Celý postup spoèívá v pou¾ití <option>-vf field</option> a následném oøezu
  <link linkend="menc-feat-telecine-footnotes">[1]</link> a pøíslu¹ném
  ¹kálování. Pamatujte, ¾e musíte nastavit scale tak, aby kompenzoval
  zmen¹ení svislého rozmìru na polovinu.
  <screen>mencoder dvd://1 -oac copy -vf field=0 -ovc lavc</screen>
  </para></listitem>
</orderedlist>
</sect3>

<sect3 id="menc-feat-telecine-encode-mixedpt">
<title>Smí¹ené progresivní a telecinované</title>
<para>
  Abychom pøevedli smí¹ené progresivní a telecinované video zcela na progresivní
  video, musí být telecinované èásti inverznì telecinovány. K tomu lze dospìt
  tøemi postupy popsanými ní¾e.Poznamenejme, ¾e byste mìli
  <emphasis role="bold">v¾dy</emphasis> provést inverzní telecine pøed
  jakýmkoliv ¹kálováním; a v pøípadì, ¾e pøesnì nevíte co dìláte, také pøed
  oøezáním <link linkend="menc-feat-telecine-footnotes">[1]</link>.
  Volba <option>-ofps 24000/1001</option> je vy¾adována, proto¾e výstupní video
  bude mít 24000/1001 snímkù za sekundu.
</para>

<itemizedlist>
<listitem><para>
  <option>-vf pullup</option> je navr¾en tak, aby inverznì telecinoval, ale
  progresivní data nechával jak jsou. Pro správnou funkci
  <emphasis role="bold">musí</emphasis> být <option>pullup</option> následován
  filtrem <option>softskip</option>, jinak <application>MEncoder</application>
  zhavaruje. <option>pullup</option> je v¹ak nejèist¹í a nejpøesnìj¹í dostupnou
  metodou pro enkódování jak telecinovaného, tak &quot;smí¹eného progresivního a
  telecinovaného&quot;.

  <screen>mencoder dvd://1 -oac copy -vf pullup,softskip -ovc lavc -ofps 24000/1001</screen>
  </para>


  </listitem>
  <listitem><para>
  Star¹í metodou je, spí¹e ne¾ inverznì telecinovat telecinované èásti,
  telecinovat progresivní èásti a poté inverznì telecinovat celé video.
  Zní to zmatenì? softpulldown je filtr, který projde celé video a pøevede celý
  soubor na telecinovaný. Pokud budeme následovat softpulldown buï
  <option>detc</option> nebo <option>ivtc</option>, bude koneèný výsledek zcela
  progresivní. Nutná je volba <option>-ofps 24000/1001</option>.

  <screen>mencoder dvd://1 -oac copy -vf softpulldown,ivtc=1 -ovc lavc -ofps 24000/1001</screen>
  </para>
  </listitem>

<listitem><para>
  Osobnì jsem nepou¾il <option>-vf filmdint</option>, ale toto o nìm (pøibli¾nì)
  øekl D Richard Felker III:

  <blockquote><para>Je to OK, ale IMO to zkou¹í a¾ pøíli¹ èasto odstraòovat
    proklad místo provádìní inverzního telecine (stejnì jako settop DVD
    pøehrávaèe &amp; progresivní televize) co¾ vede ke ¹karedému tøepotání a
    dal¹ím artefaktùm. Pokud jej chcete pou¾ívat, mìli byste pøedtím alespoò
    trochu èasu vìnovat ladìní voleb a sledováním výstupu, abyste mìli jistotu,
    ¾e vám to nìco nekazí.</para></blockquote>
  </para></listitem>
</itemizedlist>
</sect3>

<sect3 id="menc-feat-telecine-encode-mixedpi">
<title>Smí¹ené progresivní a prokládané</title>
<para>
  Máme dvì volby pro práci s touto kategorií, obì jsou v¹ak kompromisem. Mìli
  byste se rozhodnout podle trvání/umístìní ka¾dého typu.
</para>

<itemizedlist>
<listitem><para>
  Pova¾ujte to za progresivní. Prokládané èásti budou vypadat prokládanì a
  nìkteré z prokládaných políèek bude muset být zahozeno, co¾ povede
  k nestejnomìrnému poskakování. Mù¾ete proti tomu nasadit postprocesní filtr,
  pokud chcete, ale tím mírnì degradujete progresivní èásti.
  </para>

  <para>
  Této volbì byste se mìli rozhodnì vyhnout, pokud chcete nakonec zobrazovat
  video na zobrazovaèi s prokládaným obrazem (pøes TV kartu napøíklad).
  Pokud máte prokládané snímky ve videu s rychlostí 24000/1001 snímkù za
  sekundu, budou telecinovány spolu s progresivními snímky. Polovina
  prokládaných "snímkù" bude zobrazena po dobu trvání tøech snímkù
  (3/(60000/1001) sekund), co¾ povede k poskakování. Efekt
  &quot;cukání zpìt&quot; vypadá skuteènì zle. Pokud se o to pøece pokusíte,
  <emphasis role="bold">musíte</emphasis> pou¾ít filtr odstraòující proklad,
  jako je <option>lb</option> nebo <option>l5</option>.
  </para>

  <para>
  ©patnou volbou je to i pro progresivní zobrazovaè. Ten zahodí páry po sobì
  jdoucích snímkù, co¾ povede k pøeru¹ování, které mù¾e být více viditelné, ne¾
  pøi druhé metodì, která zobrazuje nìkteré progresivní snímky dvakrát.
  Prokládané video se 30000/1001 snímky za sekundu je toti¾ ponìkud trhané,
  proto¾e by ve skuteènosti mìlo být promítáno pøi 60000/1001 pùlsnímcích za
  sekundu, tak¾e zdvojení nìkterých snímkù není tak moc vidìt.
  </para>

  <para>
  V ka¾dém pøípadì je nejlep¹í posoudit obsah a zpùsob, jakým bude zobrazován.
  Pokud je va¹e video z 90% progresivní a nikdy jej nebudete pou¹tìt na
  televizi, mìli byste volit progresivní pøístup.
  Pokud je progresívní jen z poloviny, pravdìpodobnì jej bude lep¹í enkódovat
  jako by bylo celé prokládané.
  </para>
  </listitem>

<listitem><para>
  Pokládat jej za prokládané. Nìkteré snímky v progresivních èástech budou muset
  být duplikovány, co¾ povede k nepravidelnému poskakování. Opìt platí, ¾e
  filtry pro odstranìní prokladu mohou ponìkud degradovat progresivní èásti.
  </para></listitem>

</itemizedlist>
</sect3>

</sect2>

<sect2 id="menc-feat-telecine-footnotes">
<title>Poznámky pod èarou</title>
<orderedlist>
<listitem><formalpara>
  <title>K oøezu:</title>
  <para>
  Video data na DVD jsou ukládána ve formátu zvaném YUV 4:2:0. V YUV videu jsou,
  jasová (&quot;èernobílá&quot;; angl. luma) a barvonosná (angl. chroma) slo¾ka
  ukládány oddìlenì. Proto¾e je lidské oko ménì citlivé na zmìnu barvy, ne¾ na
  jas, pøipadá v YUV 4:2:0 obrázku pouze jeden barvonosný pixel na ka¾dé ètyøi
  jasové pixely. V progresivním obrázku má ka¾dý ètverec 2x2 jasových pixelù
  právì jeden barvonosný pixel. Proto musíte oøezávat progresivní YUV 4:2:0
  na sudé rozmìry a pou¾ívat sudé odsazení (offsety). Napøíklad
  <option>crop=716:380:2:26</option> je OK, ale
  <option>crop=716:380:3:26 </option> není.
  </para>
  </formalpara>

  <para>
  Kdy¾ máte co do èinìní s prokládaným YUV 4:2:0, je situace mnohem
  komplikovanìj¹í. Místo ka¾dých ètyøech pixelù ve <emphasis>snímku</emphasis>
  sdílejících barvonosný pixel, ka¾dé ètyøi jasové pixely v ka¾dém
  <emphasis>pùlsnímku</emphasis> sdílejí barvonosný pixel. Kdy¾ jsou pùlsnímky
  prolo¾eny do snímku, ka¾dá linka má vý¹ku jeden pixel. A nyní místo aby dané
  ètyøi pixely tvoøily ètverec, jsou první dva vedle sebe a druhé dva jsou vedle
  sebe o dvì linky ní¾. Dva pixely tìsnì pod nimi patøí do jiného pùlsnímku a
  proto sdílí jiný barvonosný pixel se dvìma jasovými pixely o dva øádky ní¾.
  V¹echno tohle nás nutí mít svislé rozmìry oøezání a odsazení bezezbytku
  dìlitelné ètyømi. Vodorovné staèí kdy¾ budou sudé.
  </para>

  <para>
  Pro telecinované video doporuèuji, abyste oøezání provádìli a¾ po inverzi
  telecine. Jakmile je video progresivní, staèí øezat jen na sudé rozmìry.
  Pokud si v¹ak pøece jen chcete dopøát mírné zrychlení, které mù¾e poskytnout
  èasný oøez, musíte svisle dodr¾et násobky ètyøech, jinak nebude mít filtr
  pro inverzi telecine správná data.
  </para>

  <para>
  Prokládané (nikoli telecinované) video musíte v¾dy oøezávat svisle násobky
  ètyø, pokud pøed oøezáním nepou¾ijete <option>-vf field</option>.
  </para>
  </listitem>

<listitem><formalpara>
  <title>K volbám pro enkódování a kvalitì:</title>
  <para>
  Jen proto, ¾e doporuèuji <option>mbd=2</option> zde neznamená, ¾e by tato
  volba nemohla být pou¾ita jinde. V kombinaci s <option>trell</option>, je
  <option>mbd=2</option> jednou ze dvou voleb
  <systemitem class="library">libavcodec</systemitem>u, které nejvíce zvy¹ují
  kvalitu a vy byste mìli v¾dy pou¾ít alespoò tyto dvì, pokud není na ¹kodu
  zpomalení rychlosti enkódování (napø. pøi enkódování v reálném èase).
  Mnoho dal¹ích voleb <systemitem class="library">libavcodec</systemitem>u
  zvy¹uje kvalitu enkódování (a sni¾uje jeho rychlost), ale to je mimo zamìøení
  tohoto textu.
  </para>
  </formalpara>
  </listitem>

<listitem><formalpara>
  <title>K výkonu filtru pullup:</title>
  <para>
  Pou¾ití <option>pullup</option> je bezpeèné (spolu se <option>softskip
  </option>) na progresivní video a je to obvykle dobrá volba, pokud nebyl zdroj
  provìøen, ¾e je celý progresivní. Ve vìt¹inì pøípadù je ztráta výkonu malá.
  V ojedinìlých pøípadech enkódování zpùsobí <option>pullup</option>, ¾e je
  <application>MEncoder</application> o 50% pomalej¹í. Pøidání zpracování zvuku
  a pokroèilých <option>lavcopts</option> zastíní tento rozdíl tak, ¾e rozdíl
  v rychlosti pùsobený pou¾itím <option>pullup</option> se sní¾í na 2%.
  </para>
  </formalpara>
  </listitem>

</orderedlist>

</sect2>

</sect1>


<sect1 id="menc-feat-enc-libavcodec">
<title>Enkódování s rodinou kodekù <systemitem class="library">libavcodec</systemitem>
</title>

<para>
<link linkend="ffmpeg"><systemitem class="library">libavcodec</systemitem></link>
zaji¹»uje jednoduché enkódování do mnoha zajímavých video a audio formátù.
Mù¾ete enkódovat do následujících kodekù (více ménì aktuální):

</para>

<sect2 id="menc-feat-enc-libavcodec-video-codecs">
<title>Video kodeky <systemitem class="library">libavcodec</systemitem></title>
 
<para>
<informaltable frame="all">
<tgroup cols="2">
<thead>
<row><entry>Jméno video kodeku</entry><entry>Popis</entry></row>
</thead>
<tbody>
<row><entry>mjpeg</entry><entry>
   Motion JPEG
  </entry></row>
<row><entry>ljpeg</entry><entry>
   lossless (bezztrátový) JPEG
  </entry></row>
<row><entry>h261</entry><entry>
  H.261
  </entry></row>
<row><entry>h263</entry><entry>
  H.263
  </entry></row>
<row><entry>h263p</entry><entry>
  H.263+
  </entry></row>
<row><entry>mpeg4</entry><entry>
  standardní ISO MPEG-4 (DivX 5, XviD kompatibilní)
  </entry></row>
<row><entry>msmpeg4</entry><entry>
  prvotní MPEG-4 varianta od MS, v3 (DivX3)
  </entry></row>
<row><entry>msmpeg4v2</entry><entry>
  prvotní MPEG-4 od MS, v2 (pou¾itý ve starých ASF souborech)
  </entry></row>
<row><entry>wmv1</entry><entry>
  Windows Media Video, verze 1 (WMV7)
  </entry></row>
<row><entry>wmv2</entry><entry>
  Windows Media Video, verze 2 (WMV8)
  </entry></row>
<row><entry>rv10</entry><entry>
  RealVideo 1.0
  </entry></row>
<row><entry>rv20</entry><entry>
  RealVideo 2.0
  </entry></row>
<row><entry>mpeg1video</entry><entry>
  MPEG-1 video
  </entry></row>
<row><entry>mpeg2video</entry><entry>
  MPEG-2 video
  </entry></row>
<row><entry>huffyuv</entry><entry>
  bezztrátová komprese
  </entry></row>
<row><entry>asv1</entry><entry>
  ASUS Video v1
  </entry></row>
<row><entry>asv2</entry><entry>
  ASUS Video v2
  </entry></row>
<row><entry>ffv1</entry><entry>
  bezztrátový video kodek z FFmpeg
  </entry></row>
<row><entry>svq1</entry><entry>
  Sorenson video 1
  </entry></row>
<row><entry>flv</entry><entry>
  Sorenson H.263 pou¾ívaný ve Flash Video
  </entry></row>
<row><entry>dvvideo</entry><entry>
  Sony Digital Video
  </entry></row>
<row><entry>snow</entry><entry>
  Experimentální vlnkovì orientovaný kodek z FFmpeg
  </entry></row>
</tbody>
</tgroup>
</informaltable>

První pole obsahuje názvy kodekù, které mù¾ete pøiøadit konfiguraènímu parametru
<literal>vcodec</literal>, napø: <option>-lavcopts vcodec=msmpeg4</option>
</para>

<informalexample>
<para>
Pøíklad s MJPEG kompresí:
<screen>mencoder dvd://2 -o titul2.avi -ovc lavc -lavcopts vcodec=mjpeg -oac copy</screen>
</para>
</informalexample>
</sect2>

<sect2 id="menc-feat-enc-libavcodec-audio-codecs">
<title>Audio kodeky <systemitem class="library">libavcodec</systemitem></title>
<para>
<informaltable frame="all">
<tgroup cols="2">
<thead>
<row><entry>Jméno audio kodeku</entry><entry>Popis</entry></row>
</thead>
<tbody>
  <row>
    <entry>mp2</entry>
    <entry>MPEG Layer 2</entry>
  </row>
  <row>
    <entry>ac3</entry>
    <entry>AC3, alias Dolby Digital</entry>
  </row>
  <row>
    <entry>adpcm_ima_wav</entry>
    <entry>IMA adaptivní PCM (4 bity na vzorek, komprese 4:1)</entry>
  </row>
  <row>
    <entry>sonic</entry>
    <entry>experimentální lossy/lossless kodek</entry>
  </row>
</tbody>
</tgroup>
</informaltable>

Vprvním sloupci naleznate jména kodekù, které byste mìli pøiøadit parametru
<literal>acodec</literal>, napøíklad: <option>-lavcopts acodec=ac3</option>
</para>

<informalexample>
<para>
Pøíklad s kompresí AC3:
<screen>mencoder dvd://2 -o titul2.avi -oac lavc -lavcopts acodec=ac3 -ovc copy</screen>
</para>
</informalexample>

<para>
  Narozdíl od videokodekù z <systemitem class="library">libavcodec</systemitem>
  její audio kodeky neprovádìjí inteligentní rozdìlení pøidìlených bitù,
  jeliko¾ jim chybí nìjaký minimální psychoakustický model (pokud vùbec),
  který obsahuje vìt¹ina implementací ostatních kodekù.
  Vìzte v¹ak, ¾e v¹echny tyto kodeky zvuku jsou velmi rychlé a pracují
  jak jsou v¹ude, kde máte <application>MEncoder</application> se zakompilovanou
  knihovnou <systemitem class="library">libavcodec</systemitem> (co¾ je
  naprostá vìt¹ina pøípadù) a nezávisejí na externích knihovnách.
</para>
</sect2>


<sect2 id="menc-feat-dvd-mpeg4-lavc-encoding-options">
<title>Enkódovací volby libavcodecu</title>

<para>
  V ideálním pøípadì byste asi chtìli jen øíct enkodéru, aby se pøepnul do
  re¾imu "vysoká kvalita" a ¹el na to.
  To by bylo jistì hezké, ale nane¹tìstí je to tì¾ké zavést, jeliko¾ rùzné
  volby enkódování vedou k rùzné kvalitì v závislosti na zdrojovém materiálu.
  To proto, ¾e komprese závisí na vizuálních vlastnostech daného videa.
  Napøíklad anime a ¾ivá akce mají zcela rozdílné vlastnosti a tedy vy¾adují
  odli¹né volby pro dosa¾ení optimálního enkódování.
  Dobrá zpráva je, ¾e nìkteré volby by nikdy nemìly chybìt, jako
  <option>mbd=2</option>, <option>trell</option> a <option>v4mv</option>.
  Podrobný popis obvyklých enkódovacích voleb naleznete ní¾e.
</para>


<itemizedlist>
<title>Volby k nastavení:</title>
<listitem><para>
  <emphasis role="bold">vmax_b_frames</emphasis>: 1 nebo 2 je v poøádku,
  v závislosti na filmu.
  Poznamenejme, ¾e pokud chcete mít svá videa dekódovatelná kodekem DivX5,
  budete muset zapnout podporu uzavøeného GOP, pomocí volby
  <systemitem class="library">libavcodec</systemitem>u <option>cgop</option>,
  ale budete také muset vypnout detekci scény, co¾ není dobrý nápad, jeliko¾
  tak trochu zhor¹íte efektivitu enkódování.
</para></listitem>

<listitem><para>
  <emphasis role="bold">vb_strategy=1</emphasis>: pomáhá ve scénách s rychlým
  pohybem.
  Vy¾aduje vmax_b_frames >= 2.
  V nìkterých videích mù¾e vmax_b_frames sní¾it kvalitu, ale vmax_b_frames=2
  spolu s vb_strategy=1 pomù¾e.
</para></listitem>

<listitem><para>
  <emphasis role="bold">dia</emphasis>: okruh vyhledávání pohybu. Èím vìt¹í, tím
  lep¹í a pomalej¹í.
  Záporné hodnoty mají úplnì jiný význam.
  Dobrými hodnotami jsou -1 pro rychlé enkódování, nebo 2-4 pro pomalej¹í.
</para></listitem>

<listitem><para>
  <emphasis role="bold">predia</emphasis>: pøedprùchod pro vyhledávání pohybu.
  Není tak dùle¾itý jako dia. Dobré hodnoty jsou 1 (výchozí) a¾ 4. Vy¾aduje
  preme=2, aby byla opravdu k nìèemu.
</para></listitem>

<listitem><para>
  <emphasis role="bold">cmp, subcmp, precmp</emphasis>: Porovnávací funkce pro
  odhad pohybu.
  Experimentujte s hodnotami 0 (výchozí), 2 (hadamard), 3 (dct) a 6 (omezení
  datového toku).
  0 je nejrychlej¹í a dostateèná pro precmp.
  Pro cmp a subcmp je 2 dobrá pro anime a 3 zase pro ¾ivou akci.
  6 mù¾e, ale nemusí být o nìco lep¹í, ale je pomalá.
</para></listitem>

<listitem><para>
  <emphasis role="bold">last_pred</emphasis>: Poèet prediktorù pohybu
  pøebíraných z pøedchozího snímku.
  1-3 nebo tak pomù¾ou za cenu men¹ího zdr¾ení.
  Vy¹¹í hodnoty jsou v¹ak pomalé a nepøiná¹í ¾ádný dal¹í u¾itek.
</para></listitem>

<listitem><para>
  <emphasis role="bold">cbp, mv0</emphasis>: Ovládá výbìr makroblokù.
  Malá ztráta rychlosti za malý zisk kvality.
</para></listitem>

<listitem><para>
  <emphasis role="bold">qprd</emphasis>: adaptivní kvantizace zalo¾ená na
  komplexnosti makrobloku.
  Mù¾e pomoci i u¹kodit v závislosti na videu a ostatních volbách.
  Toto mù¾e zpùsobovat artefakty, pokud nenastavíte vqmax na nìjakou rozumnì
  malou hodnotu (6 je dobrá, mo¾ná byste ale mìli jít a¾ na 4); vqmin=1 mù¾e
  také pomoci.
</para></listitem>

<listitem><para>
  <emphasis role="bold">qns</emphasis>: velmi pomalá, zvlá¹» v kombinaci
  s qprd.
  Tato volba nutí enkodér minimalizovat ¹um díky kompresi artefaktù, místo aby
  se sna¾il striktnì zachovávat vìrnost videa. Nepou¾ívejte ji, pokud jste ji¾
  nezkusili v¹echno ostatní kam a¾ to ¹lo a výsledek pøesto není dost dobrý.
</para></listitem>

<listitem><para>
  <emphasis role="bold">vqcomp</emphasis>: Vylep¹ení ovládání datového toku.
  Dobré hodnoty se li¹í podle videa. Mù¾ete to bezpeènì ponechat jak to je,
  pokud chcete.
  Sní¾ením vqcomp pustíte více bitù do scén s nízkou komplexností, zvý¹ením je
  po¹lete do scén s vysokou komplexností (výchozí: 0.5, rozsah: 0-1. doporuèený
  rozsah: 0.5-0.7).
</para></listitem>

<listitem><para>
  <emphasis role="bold">vlelim, vcelim</emphasis>: Nastaví jediný koeficient
  prahu eliminace pro jasové a barevné roviny.
  Ty jsou enkódovány oddìlenì ve v¹ech MPEGu podobných algoritmech.
  My¹lenka stojící za tìmito volbami je pou¾ití dobré heuristiky pro urèení,
  zda je zmìna v bloku men¹í ne¾ vámi nastavený práh a v tom pøípadì se blok
  enkóduje jako "nezmìnìný".
  To ¹etøí bity a mo¾ná i zrychlí enkódování. vlelim=-4 a vcelim=9 se zdají být
  dobré pro hrané filmy, ale pøíli¹ nepomohou s anime; pokud enkódujete
  animované vido, mìli byste je asi nechat beze zmìn.
</para></listitem>

<listitem><para>
  <emphasis role="bold">qpel</emphasis>: Odhad pohybu s pøesností na ètvrt
  pixelu. MPEG-4 pou¾ívá pøesnost na pùl pixelu jako výchozí pøi vyhledávání
  pohybu, proto je tato volba spojena s urèitou re¾ií, jeliko¾ se do výstupního
  souboru ukládá více informací.
  Kompresní zisk/ztráta závisí na filmu, ale obvykle to není pøíli¹ efektivní
  na anime.
  qpel v¾dy zpùsobí zvý¹ení výpoèetní nároènosti dekódování (v praxi +25% èasu
  CPU).
</para></listitem>

<listitem><para>
  <emphasis role="bold">psnr</emphasis>: neovlivní aktuální enkódování, ale
  zaznamená typ/velikost/kvalitu ka¾dého snímku do log souboru a na konci vypí¹e
  souhrnný PSNR (odstup signálu od ¹umu).
</para></listitem>

</itemizedlist>

<itemizedlist>
<title>Volby se kterými nedoporuèujeme si hrát:</title>
<listitem><para>
  <emphasis role="bold">vme</emphasis>: Výchozí je nejlep¹í.
</para></listitem>

<listitem><para>
  <emphasis role="bold">lumi_mask, dark_mask</emphasis>: Psychovizuálnì
  adaptivní kvantizace.
  Nehrajte si s tìmito volbami, pokud vám jde o kvalitu. Rozumné hodnoty mohou
  být efektivní ve va¹em pøípadì, ale pozor, je to velmi subjektivní.
</para></listitem>

<listitem><para>
  <emphasis role="bold">scplx_mask</emphasis>: Sna¾í se pøedcházet blokovým
  artefaktùm, ale postprocesing je lep¹í.
</para></listitem>
</itemizedlist>

</sect2>

<sect2 id="menc-feat-mpeg4-lavc-example-settings">
<title>Pøíklady nastavení enkódování</title>

<para>
  Následující nastavení jsou pøíklady nastavení rùzných kombinací voleb
  enkodéru, které ovlivòují pomìr rychlost versus kvalita pøi shodném
  cílovém datovém toku.
</para>

<para>
  Ve¹kerá nastavení byla testována na video vzorku 720x448 @30000/1001
  snímkù za sekundu, cílový datový tok byl 900kbps a provádìly se na
  AMD-64 3400+ pøi 2400 Mhz v re¾imu 64 bitù.
  Ka¾dá kombinace nastavení má uvedenu zmìøenou rychlost enkódování
  (ve snímcích za sekundu) a ztrátu PSNR (v dB) oproti nastavení
  "velmi vysoká kvalita".
  Rozumìjte v¹ak ¾e, v závislosti na va¹em zdrojovém materiálu, typu
  poèítaèe a pokrokùm ve vývoji, mù¾ete dospìt k velmi odli¹ným výsledkùm.
</para>

<para>
<informaltable frame="all">
<tgroup cols="4">
<thead>
<row><entry>Popis</entry><entry>Volby</entry><entry>Rychlost [fps]</entry><entry>Relativní ztráta PSNR [dB]</entry></row>
</thead>
<tbody>
<row>
  <entry>Velmi vysoká kvalita</entry>
  <entry><option>vcodec=mpeg4:mbd=2:mv0:trell:v4mv:cbp:last_pred=3:predia=2:dia=2:vmax_b_frames=2:vb_strategy=1:precmp=2:cmp=2:subcmp=2:preme=2:qns=2</option></entry>
  <entry>6</entry>
  <entry>0</entry>
</row>
<row>
  <entry>Vysoká kvalita</entry>
  <entry><option>vcodec=mpeg4:mbd=2:trell:v4mv:last_pred=2:dia=-1:vmax_b_frames=2:vb_strategy=1:cmp=3:subcmp=3:precmp=0:vqcomp=0.6:turbo</option></entry>
  <entry>15</entry>
  <entry>-0.5</entry>
</row>
<row>
  <entry>Rychlé enkódování</entry>
  <entry><option>vcodec=mpeg4:mbd=2:trell:v4mv:turbo</option></entry>
  <entry>42</entry>
  <entry>-0.74</entry>
</row>
<row>
  <entry>Enkódování v reálném èase</entry>
  <entry><option>vcodec=mpeg4:mbd=2:turbo</option></entry>
  <entry>54</entry>
  <entry>-1.21</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</para>
</sect2>

<sect2 id="custommatrices"><title>U¾ivatelské inter/intra matice</title>

<para>
Díky této vlastnosti
<link linkend="ffmpeg"><systemitem class="library">libavcodec</systemitem></link>u
mù¾ete nastavit u¾ivatelskou inter (I-snímky/klíèové snímky) a intra
(P-snímky/predikované (rozumìjte vypoèítané) snímky) matice. To je podporováno
mnoha kodeky:
<systemitem>mpeg1video</systemitem> a <systemitem>mpeg2video</systemitem>
jsou hlá¹eny jako funkèní.
</para>

<para>
Typické pou¾ití této vlastnosti je nastavení matic preferovaných
<ulink url="http://www.kvcd.net/">KVCD</ulink> specifikacemi.
</para>

<para>
<emphasis role="bold">Kvantizaèní Matice KVCD &quot;Notch&quot;:</emphasis>
</para>

<para>
Intra:
<screen>
 8  9 12 22 26 27 29 34
 9 10 14 26 27 29 34 37
12 14 18 27 29 34 37 38
22 26 27 31 36 37 38 40
26 27 29 36 39 38 40 48
27 29 34 37 38 40 48 58
29 34 37 38 40 48 58 69
34 37 38 40 48 58 69 79
</screen>

Inter:
<screen>
16 18 20 22 24 26 28 30
18 20 22 24 26 28 30 32
20 22 24 26 28 30 32 34
22 24 26 30 32 32 34 36
24 26 28 32 34 34 36 38
26 28 30 32 34 36 38 40
28 30 32 34 36 38 42 42
30 32 34 36 38 40 42 44
</screen>
</para>

<para>
Pou¾ití:
<screen>
$ mencoder <replaceable>vstup.avi</replaceable> -o <replaceable>výstup.avi</replaceable> -oac copy -ovc lavc -lavcopts inter_matrix=...:intra_matrix=...
</screen>
</para>

<para>
<screen>
$ mencoder <replaceable>input.avi</replaceable> -ovc lavc -lavcopts
vcodec=mpeg2video:intra_matrix=8,9,12,22,26,27,29,34,9,10,14,26,27,29,34,37,
12,14,18,27,29,34,37,38,22,26,27,31,36,37,38,40,26,27,29,36,39,38,40,48,27,
29,34,37,38,40,48,58,29,34,37,38,40,48,58,69,34,37,38,40,48,58,69,79
:inter_matrix=16,18,20,22,24,26,28,30,18,20,22,24,26,28,30,32,20,22,24,26,
28,30,32,34,22,24,26,30,32,32,34,36,24,26,28,32,34,34,36,38,26,28,30,32,34,
36,38,40,28,30,32,34,36,38,42,42,30,32,34,36,38,40,42,44 -oac copy -o svcd.mpg
</screen>
</para>
</sect2>


<sect2 id="menc-feat-dvd-mpeg4-example">
<title>Pøíklad</title>

<para>
  Tak¾e jste si koupili zbrusu novou kopii filmu Harry Potter a Tajemná komnata
  (¹irokoúhlou verzi samozøejmì) a chcete si toto DVD ripnout, tak¾e si jej
  mù¾ete pøidat do svého Domácího kino-poèítaèe PC. Je to region 1 DVD, tak¾e je
  v NTSC. Ní¾e uvedený pøíklad je stále vhodný i pro PAL, jen musíte vynechat
  <option>-ofps 24000/1001</option> (proto¾e výstupní snímková rychlost je
  shodná se vstupní) a pøirozenì budou rozdílné souøadnice pro oøez.
</para>

<para>
  Po spu¹tìní <option>mplayer dvd://1</option>, postupujeme podle informací
  obsa¾ených v sekci <link linkend="menc-feat-telecine">Jak nalo¾it s telecine
  a prokladem v NTSC DVD</link> a zjistíme ¾e je to 24000/1001 neprokládané
  video, tak¾e nepotøebujeme pou¾ít inverzní telecine filtr, jako je
  <option>pullup</option> nebo <option>filmdint</option>.
</para>

<para>
  Dále musíme zjistit vhodný oøezový obdélník, tak¾e pou¾ijeme filtr cropdetect:

  <screen>mplayer dvd://1 -vf cropdetect</screen>

  Ujistìte se, ¾e jste pøe¹li pøes zaplnìný snímek (nìjakou jasnou scénu) a
  v konzoli <application>MPlayer</application>u uvidíte:

  <screen>crop area: X: 0..719  Y: 57..419  (-vf crop=720:362:0:58)</screen>

  Potom pøehrajeme film s tímto filtrem, abychom otestovali jeho správnost:

  <screen>mplayer dvd://1 -vf crop=720:362:0:58</screen>

  A zjistíme, ¾e to vypadá zcela v poøádku. Dále se ujistíme, ¾e ¹íøka i vý¹ka
  jsou násobky 16. ©íøka je v poøádku, vý¹ka ov¹em ne. Proto¾e jsme nepropadli
  v sedmé tøídì z matematiky, víme, ¾e nejbli¾¹ím násobkem 16 ni¾¹ím ne¾ 362 je
  352.
</para>

<para>
  Mohli bychom pou¾ít <option>crop=720:352:0:58</option>, ale bude lep¹í
  ustøihnout kousek nahoøe i dole, tak¾e zachováme støed. Zkrátili jsme vý¹ku
  o 10 pixelù, ale nechceme zvý¹it odsazení y o 5 pixelù, proto¾e je to liché
  èíslo, co¾ by nepøíznivì ovlivnilo kvalitu. Místo toho zvý¹íme odsazení y o 4
  pixely:

  <screen>mplayer dvd://1 -vf crop=720:352:0:62</screen>

  Dal¹í dùvod pro odstøi¾ení pixelù shora i zdola je to, ¾e si mù¾eme být jisti
  odstøi¾ením napùl èerných pixelù pokud existují. Pokud je v¹ak va¹e video
  telecinováno, ujistìte se, ¾e máte v øetìzu filtrù <option>pullup</option>
  filtr (nebo jiný filtr pro inverzi telecine, který hodláte pou¾ít) je¹tì pøed
  odstranìním prokladu a oøezem. (Pokud se rozhodnete zachovat va¹e video
  prokládané, pak se ujistìte, ¾e va¹e vertikální odsazení (offset)
  je násobkem 4.)
</para>

<para>
  Pokud si dìláte starosti se ztrátou tìch 10 pixelù, mo¾ná radìji sní¾íte
  rozmìry na nejbli¾¹í násobek 16. Øetìzec filtrù by pak vypadal asi takto:

  <screen>-vf crop=720:362:0:58,scale=720:352</screen>

  Takovéto zmen¹ení videa bude znamenat ztrátu malého mno¾ství detailù, co¾ bude
  pravdìpodobnì stì¾í postøehnutelné. Zvìt¹ování by naopak vedlo ke sní¾ení
  kvality (pokud byste nezvý¹ili datový tok). Oøez odstraní tyto pixely úplnì.
  To je jedna z vìcí, kterou byste si mìli uvá¾it pro ka¾dý pøípad zvlá¹».
  Napøíklad pokud bylo DVD video vyrobeno pro televizi, mìli byste se vyvarovat
  vertikálnímu ¹kálování, jeliko¾ poèet øádkù odpovídá originální nahrávce.
</para>

<para>
  Pøi prohlídce jsme zjistili, ¾e video je pomìrnì akèní, s vysokým poètem
  detailù, tak¾e jsme zvolili datový tok 2400 Kbitù.
</para>

<para>
  Nyní jsme pøipraveni provést dvouprùchodové enkódování. Prùchod jedna:

  <screen>mencoder dvd://1 -ofps 24000/1001 -oac copy -vf crop=720:352:0:62,hqdn3d=2:1:2 -ovc lavc \
-lavcopts vcodec=mpeg4:vbitrate=2400:v4mv:mbd=2:trell:cmp=3:subcmp=3:mbcmp=3:autoaspect:vpass=1 \
-o Harry_Potter_2.avi</screen>

  A prùchod dva je stejný, jen nastavíme <option>vpass=2</option>:

  <screen>mencoder dvd://1 -ofps 24000/1001 -oac copy -vf crop=720:352:0:62,hqdn3d=2:1:2 -ovc lavc \
-lavcopts vcodec=mpeg4:vbitrate=2400:v4mv:mbd=2:trell:cmp=3:subcmp=3:mbcmp=3:autoaspect:vpass=2 \
-o Harry_Potter_2.avi</screen>
</para>

<para>
  Volby <option>v4mv:mbd=2:trell</option> velmi zvý¹í kvalitu za cenu èasové
  nároènosti enkódování. Vcelku není dùvod tyto volby vypustit, pokud je
  primárním cílem kvalita. Volby <option>cmp=3:subcmp=3:mbcmp=3</option>
  vyberou porovnávací funkci, která poskytuje lep¹í kvalitu, ne¾ výchozí.
  S tímto parametrem mù¾ete zkusit experimentovat (nahlédnìte do man stránky pro
  seznam mo¾ných hodnot), jeliko¾ rùzné funkce mohou mít velký vliv na kvalitu
  v závislosti na zdrojovém materiálu. Napøíklad pokud zjistíte, ¾e
  <systemitem class="library">libavcodec</systemitem> produkuje pøíli¹ mnoho
  ètvereèkových artefaktù, mù¾ete zkusit zvolit experimentální NSSE jako
  porovnávací funkci pøes <option>*cmp=10</option>.
</para>

<para>
  V pøípadì tohoto filmu bude výsledné AVI dlouhé 138 minut a veliké kolem 3GB.
  A proto¾e jste øekli, ¾e na velikosti nezále¾í, je to pøijatelná velikost.
  Ale pokud byste jej chtìli men¹í, mù¾ete zkusit ni¾¹í datový tok.
  Efekt zvy¹ování datového toku se toti¾ neustále sni¾uje, tak¾e zatímco je
  zlep¹ení po zvý¹ení z 1800 Kbitù na 2000 Kbitù zjevné, nemusí být ji¾ tak
  velké nad 2000 Kbitù. Beze v¹eho s tím experimentujte, dokud nebudete
  spokojeni.
</para>

<para>
  Jeliko¾ jsme protáhli video od¹umovacím filtrem, mìli bychom jej trochu pøidat
  bìhem pøehrávání. To, spolu s <option>spp</option> post-procesním filtrem,
  znatelnì zvý¹í vnímanou kvalitu a pomù¾e odstranit ètvereèkové artefakty ve
  videu. S <application>MPlayer</application>ovou volbou <option>autoq</option>
  mù¾e být mno¾ství postprocesingu provádìného filtrem spp pøizpùsobováno
  vytí¾ení CPU. V tuto chvíli rovnì¾ mù¾ete provést korekci gama a/nebo barevnou
  korekci k dosa¾ení nejlep¹ích výsledkù. Napøíklad:

  <screen>mplayer Harry_Potter_2.avi -vf spp,noise=9ah:5ah,eq2=1.2 -autoq 3</screen>

</para>
</sect2>
</sect1>


<sect1 id="menc-feat-xvid">
<title>Enkódování pomocí kodeku <systemitem class="library">XviD</systemitem>
</title>
<para>
 <systemitem class="library">XviD</systemitem> je svobodná knihovna pro
 enkódování MPEG-4 ASP video datových proudù.
 Pøed zaèátkem enkódování budete muset <link linkend="xvid">
 nastavit <application>MEncoder</application> pro jeho podporu</link>.
</para>
<para>
 Tato pøíruèka se zamìøuje na poskytování stejného druhu informací
 jako pøíruèka enkódování s x264.
 Tak¾e prosím zaènìte pøeètením
 <link linkend="menc-feat-x264-encoding-options-intro">první èásti</link>
 této pøíruèky.
</para>


<sect2 id="menc-feat-xvid-intro">
<title>Jaké volby by mìly být pou¾ity, abychom dosáhli nejlep¹ích výsledkù?</title>

<para>
 Zaènìte prosím proètením sekce
 <systemitem class="library">XviD</systemitem> v manuálové stránce
 <application>MPlayer</application>u.
 Tato èást má být doplnìním man stránky.
</para>
<para>
 Výchozí nastavení XviD jsou dobrým kompromisem mezi rychlostí a kvalitou,
 tak¾e je mù¾ete bez obav pou¾ít, pokud vám nebude nìco v dal¹ím textu jasné.
</para>
</sect2>

<sect2 id="menc-feat-xvid-encoding-options">
<title>Volby pro enkódování s <systemitem class="library">XviD</systemitem></title>

<itemizedlist>
<listitem><para>
 <emphasis role="bold">vhq</emphasis>
  Tato volba ovlivní rozhodovací algoritmus makrobloku, kde vy¹¹í nastavení
  znamená lep¹í rozhodování.
  Výchozí nastavení mohou být bezpeènì pou¾ita pro ka¾dé enkódování,
  zatímco vy¹¹í nastavení v¾dy pomohou PSNR, ale je znatelnì pomalej¹í.
  Poznamenejme, ¾e lep¹í PSNR nemusí nutnì znamenat, ¾e bude obraz vypadat lépe,
  ale udává, ¾e je blí¾e originálu.
  Vypnutí této volby viditelnì zrychlí enkódování; pokud je pro vás
  rychlost kritická, pak to stojí za to.
</para></listitem>

<listitem><para>
 <emphasis role="bold">bvhq</emphasis>
  Tato volba provádí to samé co vhq, ale v B-snímcích.
  Má zanedbatelný vliv na rychlost a trochu vylep¹uje kvalitu
  (kolem +0.1dB PSNR).
</para></listitem>

<listitem><para>
 <emphasis role="bold">max_bframes</emphasis>
  Vìt¹í poèet povolených po sobì jdoucích B-snímkù obvykle zvy¹uje
  komprimovatelnost, aèkoli to mù¾e vést k vìt¹ímu poètu blokových artefaktù.
  Výchozí nastavení je dobrým kompromisem mezi komprimovatelností a
  kvalitou, ale mù¾ete ji zvý¹it nad 3, pokud tou¾íte po nízkém datovém toku.
  Mù¾ete ji rovnì¾ sní¾it na 1 nebo 0, pokud vám jde o perfektní kvalitu,
  ale v tom pøípadì byste se mìli ujistit, ¾e máte nastaven dostateènì
  vysoký datový tok, aby byla jistota, ¾e komrimátor nebude zvy¹ovat kvantizer,
  aby jej dosáhl.
</para></listitem>

<listitem><para>
 <emphasis role="bold">bf_threshold</emphasis>
  Tato volba ovládá B-snímkovou citlivost enkodéru, kdy vy¹¹í hodnota
  vede k èastìj¹ímu pou¾ití B-snímkù (a naopak).
  Má být pou¾ita spolu s <option>max_bframes</option>;
  pokud jste blázen do datového toku, mìli byste  zvý¹it jak
  <option>max_bframes</option>, tak <option>bf_threshold</option>,
  nebo naopak mù¾ete zvý¹it <option>max_bframes</option> a sní¾it
  <option>bf_threshold</option>, tak¾e bude enkodér pou¾ívat více
  B-snímkù pouze na místech, které je <emphasis role="bold">opravdu</emphasis>
  potøebují.
  Nízká hodnota <option>max_bframes</option> a vysoká
  <option>bf_threshold</option> asi není nejrozumnìj¹í volbou, jeliko¾ pøinutí
  enkodér umís»ovat B-snímky na místa, které z nich nebudou tì¾it,
  ale sní¾í se jejich vizuální kvalita.
  Pokud v¹ak potøebujete být kompatibilní s domácími pøehrávaèi, které
  podporují pouze staré DivX profily (ty podporují pouze 1 po sobì jdoucí
  B-snímek), je to va¹e jediná cesta ke zvý¹ení komprimovatelnosti pomocí
  B-snímkù.
</para></listitem>

<listitem><para>
 <emphasis role="bold">trellis</emphasis>
  Optimalizuje proces kvantizace pro dosa¾ení nejlep¹ího kompromisu
  mezi PSNR a datovým tokem, co¾ umo¾òuje znatelnou úsporu bitù.
  U¹etøené bity budou vyu¾ity v jiných èástech videa, co¾ zvý¹í
  celkovou vizuální kvalitu.
  Mìli byste ji v¾dy mít zapnutou, jeliko¾ její kvalitativní pøínos je znaèný.
  Dokonce i kdy¾ potøebujete vy¹¹í rychlost, nevypínejte ji, dokud jste
  nevypli <option>vhq</option> a nezredukovali ostatní volby
  nároèné na CPU na minimum.
</para></listitem>

<listitem><para>
  <emphasis role="bold">hq_ac</emphasis>
  Aktivuje metodu odhadu s men¹ími náklady na koeficienty, co¾ trochu
  zmen¹í výstupní soubor (okolo  0,15 a¾ 0,19%, co¾ odpovídá zvý¹ení PSNR
  o ménì ne¾ 0.01dB) pøi zanedbatelném vlivu na rychlost.
  Je proto doporuèeno ponechat ji v¾dy zapnutou.
</para></listitem>

<listitem><para>
 <emphasis role="bold">cartoon</emphasis>
  Volba navr¾ená pro lep¹í enkódování kresleného obsahu. Nemá vliv
  na rychlost, pouze doladí heuristiku pro výbìr re¾imu pro tento
  druh obsahu.
</para></listitem>

<listitem><para>
 <emphasis role="bold">me_quality</emphasis>
  Tato volba ovládá pøesnost vyhledávání pohybu.
  Èím vy¹¹í <option>me_quality</option>, tím bude
  pøesnìj¹í odhad pùvodního pohybu a výsledný snímek
  pøesnìji zachytí originální pohyb.
 </para>
 <para>
  Výchozí nastavení je nejlep¹í ve v¹ech pøípadech;
  tak¾e ji nedoporuèujeme vypínat, pokud nepotøebujete za ka¾dou cenu
  zvý¹it rychlost, jeliko¾ v¹echny bity u¹etøené dobrým odhadem pohybu
  mohou být pou¾ity jinde a zvý¹it tak celkovou kvalitu.
  Ka¾dopádnì nechoïte ní¾ ne¾ na 5, a kdy¾, tak jen jako poslední mo¾nost.
</para></listitem>

<listitem><para>
 <emphasis role="bold">chroma_me</emphasis>
  Zlep¹uje odhad pohybu tím, ¾e bere v potaz i chroma (barevnou)
  informaci, zatímco samotné <option>me_quality</option>
  pou¾ívá pouze èernobílou (luma).
  To spomalí enkódování o 5-10%, ale docela vylep¹í vizuální kvalitu
  omezením blokových artefaktù a zmen¹í velikost souboru asi o 1.3%.
  Pokud vám jde hlavnì o rychlost, mìli byste tuto volbu vypnout døíve,
  ne¾ zaènete sni¾ovat <option>me_quality</option>.
</para></listitem>

<listitem><para>
  <emphasis role="bold">chroma_opt</emphasis>
    Je urèena spí¹e ke zvý¹ení kvality barev a vyèi¹tìní bílých/èerných
    okrajù, ne¾ k vylep¹ení koprimovatelnosti.
    To vám mù¾e pomoci omezit "red stairs" efekt.
</para></listitem>

<listitem><para>
  <emphasis role="bold">lumi_mask</emphasis>
    Zkou¹í pøiøadit ni¾¹í datový tok èástem obrázku, které lidské oko
    dobøe nevidí, co¾ umo¾ní enkodéru pou¾ít u¹etøené bity na
    dùle¾itìj¹ích místech obrázku.
    Kvalita výsledku znaènì závisí na osobních preferencích a
    na typu a nastavení monitoru pou¾itého pro prohlí¾ení
    (typicky to nebude vypadat dobøe pokud je jasný, nebo je
    to TFT monitor).
</para></listitem>

<listitem><para>
  <emphasis role="bold">qpel</emphasis>
    Zvý¹í poèet mo¾ných vektorù pohybu zvý¹ením
    pøesnosti vyhledávání pohybu z poloviny pixelu na
    ètvrtinu pixelu.
    Ideou je nalezení lep¹ích vektorù pohybu, které naoplátku
    sní¾í datový tok (co¾ zvý¹í kvalitu).
    Vektory pohybu s pøesností na ètvrt pixelu v¹ak vy¾adují pro sebe
    pár bitù navíc, ale výsledné vektory ne v¾dy dávají (o mnoho) lep¹í
    výsledky.
    Docela èasto vydá kodek bity na vy¹¹í pøesnost, ale dosáhne jen malého
    nebo ¾ádného zvý¹ení kvality.
    Nane¹tìstí není zpùsob jak zjistit mo¾ný zisk <option>qpel</option>
    pøedem, tak¾e musíte enkódovat s a bez ní, abyste mìli jistotu.
  </para><para>
    <option>qpel</option> mù¾e a¾ zdvojnásobit èas enkódování a
    vy¾aduje a¾ o 25% více výpoèetního výkonu pro dekódování.
    Volba není podporována v¹emi stolními pøehrávaèi.
</para></listitem>

<listitem><para>
  <emphasis role="bold">gmc</emphasis>
    Pokou¹í se u¹etøit bity v panoramatických scénách pou¾itím jediného
    vektoru pohybu pro celý snímek.
    To témìø v¾dy zvý¹í PSNR, ale znatelnì zpomalí enkódování
    (stejnì jako dekódování).
    V ka¾dém pøípadì byste ji mìli pou¾ívat pouze pokud máte
    <option>vhq</option> nastavené na maximum.
    GMC v <systemitem class="library">XviD</systemitem> je mnohem
    sofistikovanìj¹í ne¾ v DivX, ale je podporována jen nìkolika
    stolními pøehrávaèi.
</para></listitem>

</itemizedlist>
</sect2>

<sect2 id="menc-feat-xvid-encoding-profiles">
<title>Enkódovací profily</title>
<para>
  XviD podporuje enkódovací profily pomocí volby <option>profile</option>,
  co¾ je vyu¾íváno pro k zaøazení omezení nastavení XviD videoproudu tak,
  aby byl pøehratelný na v¹em, co podporuje vybraný profil.
  Omezení se vstahují k rozli¹ením, datovému toku a rùzným MPEG-4
  vlastnostem.
  Následující tabulka ukazuje, co který profil podporuje.
</para>
<informaltable>
<tgroup cols="16" align="center">
<colspec colnum="1"  colname="col1"/>
<colspec colnum="2"  colname="col2"/>
<colspec colnum="3"  colname="col3"/>
<colspec colnum="4"  colname="col4"/>
<colspec colnum="5"  colname="col5"/>
<colspec colnum="6"  colname="col6"/>
<colspec colnum="7"  colname="col7"/>
<colspec colnum="8"  colname="col8"/>
<colspec colnum="9"  colname="col9"/>
<colspec colnum="10" colname="col10"/>
<colspec colnum="11" colname="col11"/>
<colspec colnum="12" colname="col12"/>
<colspec colnum="13" colname="col13"/>
<colspec colnum="14" colname="col14"/>
<colspec colnum="15" colname="col15"/>
<colspec colnum="16" colname="col16"/>
<colspec colnum="17" colname="col17"/>
<spanspec spanname="spa2-5"   namest="col2" nameend="col5"/>
<spanspec spanname="spa6-11"  namest="col6" nameend="col11"/>
<spanspec spanname="spa12-17" namest="col12" nameend="col17"/>
  <tbody>
    <row>
      <entry></entry>
      <entry spanname="spa2-5">Simple</entry>
      <entry spanname="spa6-11">Advanced Simple</entry>
      <entry spanname="spa12-17">DivX</entry>
    </row>
    <row>
      <entry>Jméno profilu</entry>
      <entry>0</entry>
      <entry>1</entry>
      <entry>2</entry>
      <entry>3</entry>
      <entry>0</entry>
      <entry>1</entry>
      <entry>2</entry>
      <entry>3</entry>
      <entry>4</entry>
      <entry>5</entry>
      <entry>Handheld</entry>
      <entry>Portable NTSC</entry>
      <entry>Portable PAL</entry>
      <entry>Home Theater NTSC</entry>
      <entry>Home Theater PAL</entry>
      <entry>HDTV</entry>
    </row>
    <row>
      <entry>©íøka [pixelù]</entry>
      <entry>176</entry>
      <entry>176</entry>
      <entry>352</entry>
      <entry>352</entry>
      <entry>176</entry>
      <entry>176</entry>
      <entry>352</entry>
      <entry>352</entry>
      <entry>352</entry>
      <entry>720</entry>
      <entry>176</entry>
      <entry>352</entry>
      <entry>352</entry>
      <entry>720</entry>
      <entry>720</entry>
      <entry>1280</entry>
    </row>
    <row>
      <entry>Vý¹ka [pixelù]</entry>
      <entry>144</entry>
      <entry>144</entry>
      <entry>288</entry>
      <entry>288</entry>
      <entry>144</entry>
      <entry>144</entry>
      <entry>288</entry>
      <entry>288</entry>
      <entry>576</entry>
      <entry>576</entry>
      <entry>144</entry>
      <entry>240</entry>
      <entry>288</entry>
      <entry>480</entry>
      <entry>576</entry>
      <entry>720</entry>
    </row>
    <row>
      <entry>Snímková rychlost [fps]</entry>
      <entry>15</entry>
      <entry>15</entry>
      <entry>15</entry>
      <entry>15</entry>
      <entry>30</entry>
      <entry>30</entry>
      <entry>15</entry>
      <entry>30</entry>
      <entry>30</entry>
      <entry>30</entry>
      <entry>15</entry>
      <entry>30</entry>
      <entry>25</entry>
      <entry>30</entry>
      <entry>25</entry>
      <entry>30</entry>
    </row>
    <row>
      <entry>Max prùmìrný datový tok [kbps]</entry>
      <entry>64</entry>
      <entry>64</entry>
      <entry>128</entry>
      <entry>384</entry>
      <entry>128</entry>
      <entry>128</entry>
      <entry>384</entry>
      <entry>768</entry>
      <entry>3000</entry>
      <entry>8000</entry>
      <entry>537.6</entry>
      <entry>4854</entry>
      <entry>4854</entry>
      <entry>4854</entry>
      <entry>4854</entry>
      <entry>9708.4</entry>
    </row>
    <row>
      <entry>Mezní prùmìr datového toku bìhem 3 sekund [kbps]</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>800</entry>
      <entry>8000</entry>
      <entry>8000</entry>
      <entry>8000</entry>
      <entry>8000</entry>
      <entry>16000</entry>
    </row>
    <row>
      <entry>Max. B-snímkù</entry>
      <entry>0</entry>
      <entry>0</entry>
      <entry>0</entry>
      <entry>0</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>0</entry>
      <entry>1</entry>
      <entry>1</entry>
      <entry>1</entry>
      <entry>1</entry>
      <entry>2</entry>
    </row>
    <row>
      <entry>MPEG kvantizace</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
    </row>
    <row>
      <entry>Adaptivní kvantizace</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
    </row>
    <row>
      <entry>Prokládané enkódování</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
    </row>
    <row>
      <entry>Ètvrtpixel</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
    </row>
    <row>
      <entry>Globální kompenzace pohybu</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry>X</entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
      <entry></entry>
    </row>
  </tbody>
</tgroup>
</informaltable>
</sect2>

<sect2 id="menc-feat-xvid-example-settings">
<title>Pøíklady nastavení enkódování</title>

<para>
  Následující nastavení jsou pøíklady nastavení rùzných kombinací voleb
  enkodéru, které ovlivòují pomìr rychlost versus kvalita pøi shodném
  cílovém datovém toku.
</para>

<para>
  Ve¹kerá nastavení byla testována na video vzorku 720x448 @30000/1001
  snímkù za sekundu, cílový datový tok byl 900kbps a provádìly se na
  AMD-64 3400+ pøi 2400 Mhz v re¾imu 64 bitù.
  Ka¾dá kombinace nastavení má uvedenu zmìøenou rychlost enkódování
  (ve snímcích za sekundu) a ztrátu PSNR (v dB) oproti nastavení
  "velmi vysoká kvalita".
  Rozumìjte v¹ak ¾e, v závislosti na va¹em zdrojovém materiálu, typu
  poèítaèe a pokrokùm ve vývoji, mù¾ete dospìt k velmi odli¹ným výsledkùm.
</para>

<para>
<informaltable frame="all">
<tgroup cols="4">
<thead>
<row><entry>Popis</entry><entry>Volby</entry><entry>Rychlost [fps]</entry><entry>Relativní ztráta PSNR [dB]</entry></row>
</thead>
<tbody>
<row>
  <entry>Velmi vysoká kvalita</entry>
  <entry><option>chroma_opt:vhq=4:bvhq=1:quant_type=mpeg</option></entry>
  <entry>16</entry>
  <entry>0</entry>
</row>
<row>
  <entry>Vysoká kvalita</entry>
  <entry><option>vhq=2:bvhq=1:chroma_opt:quant_type=mpeg</option></entry>
  <entry>18</entry>
  <entry>-0.1</entry>
</row>
<row>
  <entry>Rychlé enkódování</entry>
  <entry><option>turbo:vhq=0</option></entry>
  <entry>28</entry>
  <entry>-0.69</entry>
</row>
<row>
  <entry>Enkódování v reálném èase</entry>
  <entry><option>turbo:nochroma_me:notrellis:max_bframes=0:vhq=0</option></entry>
  <entry>38</entry>
  <entry>-1.48</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</para>
</sect2>

</sect1>

<sect1 id="menc-feat-x264">
<title>Enkódování s <systemitem class="library">x264</systemitem> kodekem</title>
<para>
  <systemitem class="library">x264</systemitem> je svobodná knihovna pro
  enkódování H.264/AVC video proudù.
  Pøe zahájením enkódování budete muset <link linkend="codec-x264-encode">
  nastavit její podporu v <application>MEncoder</application>u</link>.
</para>

<sect2 id="menc-feat-x264-encoding-options">
<title>Enkódovací volby x264</title>

<para>
  Zaènìte prosím prohlídkou sekce
  <systemitem class="library">x264</systemitem> man stránky
  <application>MPlayer</application>u.
  Tato sekce je zamý¹lena jako doplnìk nam stránky.
  Zde naleznete tipy, které volby budou nejspí¹e zajímat vìt¹inu lidí.
  Man stránka je více uhlazená, ale také více vyèerpávající a
  obèas nabízí mnohem lep¹í technické detaily.
</para>

<sect3 id="menc-feat-x264-encoding-options-intro">
<title>Úvodem</title>
<para>Tato pøíruèka pokrývá dvì hlavní kategorie enkódovacích voleb:</para>

<orderedlist>
  <listitem><para>Volby které mìní dobu enkódování za kvalitu
  </para></listitem>
  <listitem><para>Volby které mohou být pou¾itelné pro naplnìní rùzných
  osobních preferencí a speciálních po¾adavkù</para></listitem>
</orderedlist>

<para>
  Nakonec jen vy mù¾ete rozhodnout, které volby jsou nejlep¹í pro
  va¹e úèely. Rozhodování v první kategorii voleb je nejjednodu¹¹í:
  staèí kdy¾ zhodnotíte zda zmìny kvality ospravedlní rychlostní rozdíly.
  Druhá skupina voleb mù¾e být mnohem subjektivnìj¹í zále¾itostí a
  v úvahu mù¾e pøijít více faktorù. Poznamenejme, ¾e nìkteré volby
  "osobních preferencí a speciálních po¾adavkù" mohou také znaènì
  ovlivnit kvalitu nebo rychlost enkódování, ale to není jejich hlavní funkce.
  Nìkolik voleb "osobních preferencí" mù¾e dokonce zpùsobit zmìny,
  po kterých se nìkomu zdá být výsledek lep¹í a jinému hor¹í.
</para>

<para>
  Ne¾ budeme pokraèovat, poznamenejme, ¾e tento návod pou¾ívá jediné mìøítko
  kvality: celkový PSNR.
  Struèné vysvìtlení co je to PSNR, naleznete
  <ulink url="http://en.wikipedia.org/wiki/PSNR">ve Wikipedii pod heslem PSNR</ulink>.
  Celkové PSNR je poslední hlá¹ené PSNR èíslo pøi zaøazení volby
  <option>psnr</option> v <option>x264encopts</option>.
  Kdykoli pí¹eme o PSNR, je jedním z pøedpokladù tohoto sdìlení
  to, ¾e jsou pou¾ity shodné datové toky.
</para>

<para>
  Témìø v¹echny komentáøe v tomto návodu pøedpokládají, ¾e enkódujete
  dvouprùchodovì.
  Pøi porovnávání voleb jsou zde dva hlavní dùvody pro pou¾ití dvouprùchodového
  enkódování.
  Zaprvé, dvouprùchodové enkódování vám získá zhruba 1dB PSNR, co¾ je
  znatelný rozdíl.
  Zadruhé, testování voleb pomocí pøímého porovnání kvality v jednoprùchodových
  výsledcích je pochybné, jeliko¾ se datový tok znaènì li¹í s ka¾dým
  enkódováním.
  Není v¾dy snadné urèit, zda se zmìnila kvalita díky zmìnì voleb, nebo
  z vìt¹í èásti odpovídají zmìnám datového toku.
</para>

</sect3>

<sect3 id="menc-feat-x264-encoding-options-speedvquality">
<title>Volby které primárnì ovlivòují rychlost a kvalitu</title>

<itemizedlist>
<listitem><para>
  <emphasis role="bold">subq</emphasis>:
  Z voleb, které umo¾òují vymìnit èas za kvalitu, jsou obvykle nejdùle¾itìj¹í
  <option>subq</option> a <option>frameref</option> (viz ní¾e).
  Máte-li zájem ovlivnit jak rychlost, tak kvalitu, jsou to první volby,
  které byste mìli zvá¾it.
  Ve smyslu rychlosti se spolu volby <option>frameref</option> a
  <option>subq</option> velmi silnì ovlivòují.
  Zku¹enosti ukazují, ¾e pøi jednom referenèním snímku si
  <option>subq=5</option> vezme asi o 35% více èasu ne¾
  <option>subq=1</option>.
  Pøi 6 referenèních snímcích naroste spomalení nad 60%.
  Vliv <option>subq</option> na PSNR se zdá být pomìrnì stálý,
  bez ohledu na poèet referenèních snímkù.
  Typicky <option>subq=5</option> získá 0.2-0.5 dB
  celkového PSNR pøes <option>subq=1</option>.
  To je obvykle ji¾ viditelné.
</para>
<para>
  Re¾im <option>subq=6</option> je nejpomalej¹í s nejvy¹¹í kvalitou.
  Oproti <option>subq=5</option> obvykle získává 0.1-0.4 dB
  celkového PSNR za cenu ztráty rychlosti 25%-100%.
  Narozdíl od ostatních úrovní <option>subq</option> nezávisí chování
  <option>subq=6</option> tolik na <option>frameref</option>
  a <option>me</option>. Místo toho závisí efektivita <option>subq=6
  </option> hlavnì na poètu pou¾itých B-snímkù. Pøi bì¾ném pou¾ití
  to znamená, ¾e <option>subq=6</option> má velký vliv jak na rychlost, tak na
  kvalitu v komplexních, velmi pohyblivých scénách, ale nemusí mít takový vliv
  ve scénách s malým pohybem. Poznamenejme, ¾e stále doporuèujeme nastavit
  <option>bframes</option> na nenulovou hodnotu (viz ní¾e).
</para></listitem>
<listitem><para>
  <emphasis role="bold">frameref</emphasis>:
  Výchozí nastavení <option>frameref</option> je 1, ale nemìlo by to být bráno
  tak, ¾e je rozumné nastavovat jej na 1.
  Pouhé zvý¹ení <option>frameref</option> na 2 získá okolo
  0.15dB PSNR s 5-10% spomalením, co¾ je zøejmì dobrý obchod.
  <option>frameref=3</option> získá kolem 0.25dB PSNR navíc k
  <option>frameref=1</option>, co¾ ji¾ mù¾e být viditelný
  rozdíl.
  <option>frameref=3</option> je asi o 15% pomalej¹í ne¾
  <option>frameref=1</option>.
  Nane¹tìstí se zisk rychle vytrácí.
  Prø <option>frameref=6</option> mù¾ete oèekávat zisk pouze
  0.05-0.1 dB nad <option>frameref=3</option> pøi dodateèném
  15% zpomalení.
  Nad <option>frameref=6</option> je zisk kvality obvykle velmi malý
  (aèkoli byste mìli mít na pamìti, ¾e se to mù¾e výraznì li¹it v závislosti
  na zdrojovém materiálu).
  V pomìrnì typickém pøípadì zlep¹í <option>frameref=12</option>
  celkový PSNR o pouhé 0.02dB nad <option>frameref=6</option>,
  pøi spomalení o 15%-20%.
  Pøi tak vysokých hodnotách <option>frameref</option> lze øíct pouze
  jedinou dobrou vìc, a to ¾e jejich dal¹í zvy¹ování témìø nikdy
  <emphasis role="bold">nesní¾í</emphasis> PSNR, ale dal¹í zisk kvality
  je stì¾í mìøitelný, nato¾ viditelný.
</para>
<note><title>Poznámka:</title>
<para>
  Zvý¹ení <option>frameref</option> na nemístnì vysokou hodnotu
  <emphasis role="bold">mù¾e</emphasis> a
  <emphasis role="bold">obvykle taky sní¾í</emphasis>
  efektivitu kódování, pokud vypnete CABAC.
  Se zapnutým CABAC (výchozí chování) se zdá být mo¾nost nastavit
  <option>frameref</option> "pøíli¹ vysoko" pøíli¹ vzdálená na to,
  abyste se tím museli trápit a v budoucnu mohou optimalizace
  tuto mo¾nost zcela vylouèit.
</para>
</note>
<para>
  Pokud vám zále¾í na rychlosti, bývá vhodným kompromisem pou¾ít
  nízké hodnoty <option>subq</option> a <option>frameref</option>
  v prvním prùchodu a zvý¹it je ve druhém.
  Typicky to má zanedbatelný záporný vliv na koneènou kvalitu:
  Pravdìpodobnì stratíte ménì ne¾ 0.1dB PSNR, co¾ by mìl být a¾ pøíli¹
  malý rozdíl, ne¾ aby byl vidìt.
  Odli¹né hodnoty <option>frameref</option> v¹ak mohou místy ovlivnit
  volbu typu snímku.
  Nejspí¹ to budou ojedinìlé pøípady, ale chcete-li si být zcela jisti,
  zjistìte, jestli va¹e video obsahuje buï blýskavé vzory pøes celou obrazovku,
  nebo rozsáhlé krátkodobé zmìny, které by mohly vynutit I-snímek.
  Nastavte <option>frameref</option> pro první prùchod tak, aby byl
  dostateènì velký pro pokrytí doby bliknutí (nebo zmìny).
  Napøíklad, pokud scéna pøepíná tam a zpìt mezi dvìma obrázky pøes tøi snímky,
  nastavte <option>frameref</option> pro první prùchod na 3 a více.
  Tento pøípad je nejspí¹ zcela ojedinìlý v hraných filmech, ale obèas se
  vyskytuje v záznamech z videoher.
</para></listitem>

<listitem><para>
  <emphasis role="bold">me</emphasis>:
  Tato volba je urèena pro výbìr metody vyhledávání pohybu.
  Zmìnou této volby jednodu¹e mìníte pomìr kvalita-versus-rychlost.
  Volba <option>me=1</option> je jen o málo procent rychlej¹í ne¾
  výchozí vyhledávání za cenu pod 0.1dB globálního PSNR.
  Výchozí nastavení (<option>me=2</option>) je rozumným kompromisem
  mezi rychlostí a kvalitou. Volba <option>me=3</option> získá o tro¹ku ménì
  ne¾ 0.1dB globální PSNR, pøi spomalení, které se li¹í v závislosti na
  <option>frameref</option>.  Pøi vysokých hodnotách
  <option>frameref</option> (øeknìme 12 nebo tak), je <option>me=3</option>
  asi o 40% pomalej¹í ne¾ výchozí <option> me=2</option>. Pøi
  <option>frameref=3</option>, klesne zpùsobené spomalení na
  25%-30%.
</para>
<para>
  Volba <option>me=4</option> pou¾ívá tak rozsáhlé vyhledávání, ¾e je pøíli¹
  pomalá pro praktické vyu¾ití.
</para>
</listitem>

<listitem><para>
  <emphasis role="bold">4x4mv</emphasis>:
  Tato volba zapíná pou¾ití podèástí 8x4, 4x8 a 4x4 v predikovaných
  makroblocích. Její aktivace vede k pomìrnì stálé 
  10%-15% ztrátì rychlosti. Tato volba je pomìrnì neu¾iteèná ve zdroji
  obsahujícím pouze pomalý pohyb, naproti tomu u nìkterých zdrojù s rychlým
  pohybem, pøesnìji zdrojù s velkým mno¾stvím malých pohyblivých objektù,
  mù¾ete oèekávat zisk okolo 0.1dB.
</para>
</listitem>

<listitem><para>
  <emphasis role="bold">bframes</emphasis>:
  Pou¾itelnost B-snímkù je ve vìt¹inì ostatních kodekù diskutabilní.
  V H.264 se to zmìnilo: jsou zde nové techniky a typy blokù pro pou¾ití
  v B-snímcích.
  Obvykle i naivní algoritmus pro výbìr B-snímku mù¾e zajistit znatelný
  zisk PSNR.
  Také je zajímavé, ¾e pokud vypnete adaptivní rozhodování o B-snímku
  (<option>nob_adapt</option>), zvý¹í obvykle enkódování s
  <option>bframes</option> o trochu rychlost enkódování.
</para>
<para>
  S vypnutým adaptivním rozhodováním o B-snímku
  (<option>x264encopts</option> - volba <option>nob_adapt</option>),
  optimální hodnota tohoto nastavení nebývá obvykle vy¹¹í ne¾
  <option>bframes=1</option>, jinak mouhou utrpìt velmi pohyblivé scény.
  Se zapnutým adaptivním rozhodováním o B-snímku (výchozí chování),
  je obvykle bezpeèné pou¾ít vy¹¹í hodnoty; enkodér se pokusí sní¾it
  pou¾ití B-snímkù ve scénách, kde by sní¾ily kompresi.
  Enkodér zøídka pou¾ije více ne¾ 3 nebo 4 B-snímky;
  nastavení této volby na vy¹¹í hodnotu bude mít jen nepatrný vliv.
</para></listitem>

<listitem><para>
  <emphasis role="bold">b_adapt</emphasis>:
  Poznámka: Výchozí je zapnuto.
</para>
<para>
  Je-li tato volba zapnuta, bude enkodér pou¾ívat rychlou
  heuristiku pro sní¾ení poètu B-snímkù ve scénách, kde by jejich
  pou¾itím pøíli¹ nezískaly.
  Mù¾ete pou¾ít <option>b_bias</option> pro nastavení jak pøátelský
  bude enkodér k B-snímkùm.
  Spomalení pùsobené adaptivními B-snímky je nyní spí¹e malé, ale
  stejnì tak potenciální zisk kvality.
  Obvykle v¹ak nijak ne¹kodí.
  Poznamenejme, ¾e ovlivòuje rychlost a rozhodování o typu snímku pouze
  v prvním prùchodu.
  <option>b_adapt</option> a <option>b_bias</option> nemají ¾ádný vliv
  v následných prùchodech.
</para></listitem>

<listitem><para>
  <emphasis role="bold">b_pyramid</emphasis>:
  Pokud pou¾íváte >=2 B-snímky, mù¾ete také zapnout tuto volbu; jak
  øíká man stránka, dostanete malé zvý¹ení kvality bez ztráty rychlosti.
  Poznamenejme, ¾e tato videa nelze èíst dekodéry zalo¾enými na libavcodec
  star¹ími ne¾ 5. bøezna 2005.
</para></listitem>

<listitem><para>
  <emphasis role="bold">weight_b</emphasis>:
  V typických pøípadech tato volba nepøiná¹í velký zisk.
  V prolínacích nebo stmívacích scénách v¹ak vá¾ená predikce
  umo¾òuje pomìrnì velkou úsporu datového toku.
  V MPEG-4 ASP bývá stmívání obvykle nejlépe kódováno jako série
  velkých I-snímkù; pou¾ití vá¾ené predikce v B-snímcích umo¾òuje
  zmìnit alespoò nìkteré z nich na rozumnì men¹í B-snímky.
  Spomalení enkódování se zdá být minimální, pokud nìjaké je.
  Rovnì¾, v rozporu s tím, co si nìkteøí lidé mohou myslet,
  po¾adavky dekodéru na CPU nejsou vá¾enou predikcí ovlivnìny,
  ostatní mo¾nosti jsou stejnì nároèné.
</para>
<para>
  Nane¹tìstí má aktuálnì algoritmus adaptivního rozhodování o B-snímcích
  výraznou tendenci vyvarovat se B-snímkù pøi stmívání.
  Dokud se to nezmìní, bude dobré pøidat
  <option>nob_adapt</option> do x264encopts, pokud oèekáváte, ¾e stmívání
  bude mít znatelný vliv ve va¹em konkrétním klipu.
</para></listitem>
</itemizedlist>
</sect3>

<sect3 id="menc-feat-x264-encoding-options-misc-preferences">
<title>Volby nále¾ející rùzným preferencím</title>
<itemizedlist>
<listitem><para>
  <emphasis role="bold">Dvouprùchodové enkodování</emphasis>:
  Vý¹e jsme doporuèovali v¾dy pou¾ívat dvouprùchodové enkódování, ale
  stále existují dùvody proè jej nepou¾ít. Napøíklad pokud zachytáváte
  TV vysílání a enkódujete v reálném èase, nemáte jinou mo¾nost, ne¾
  pou¾ít jeden prùchod. Jeden prùchod je samozøejmì rychlej¹í
  ne¾ dva; pokud pou¾ijete stejné volby v obou prùchodech, pak je dvouprùchodové
  enkódování témìø dvakrát pomalej¹í.
</para>
<para>
  Stále jsou v¹ak velmi dobré dùvody pro pou¾ití dvouprùchodového re¾imu.
  Voliè datového toku v jednoprùchodovém re¾imu není odu¹evnìlý a èasto
  dìlá nerozumné volby, proto¾e nevidí celkový obraz. Pøedpokládejme, ¾e
  máte napøíklad dvouminutové video skládající se ze dvou èástí.
  První polovina je vysoce pohyblivá scéna dlouhá 60 sekund, která samostatnì
  vy¾aduje kolem 2500kbps, aby vypadala slu¹nì.
  Hned za ní následuje ménì nároèná 60 sekundová scéna, která vypadá dobøe
  pøi 300kbps. Vy¾ádáte si 1400kbps, co¾ je teoreticky dostateèné pro pokrytí
  obou scén. Jednoprùchodový voliè datového toku v tom pøípadì uèiní
  nìkolik "chyb". První blok mù¾e skonèit tì¾ce pøekvantizovaný, tak¾e
  bude nepou¾itelnì a zbyteènì ètvereèkovaný. Druhá èást bude velmi
  podkvantizovaná; to mù¾e vypadat dobøe, ale spotøeba bitù na tento
  vzhled je nerozumnì vysoká. Èeho se dá je¹tì hùøe vyvarovat je problém
  pøechodu mezi tìmito scénami. První sekundy málo pohyblivé poloviny
  budou tì¾ce pøekvantizovány, proto¾e voliè toku stále oèekává nároky na
  datový tok, se kterými se potýkal v první polovinì videa.
  Tato "chybová doba" pøekvantizované málo pohyblivé scény bude vypadat
  neskuteènì ¹patnì a skuteènì pou¾ije ménì ne¾ 300kbps, které by potøebovala,
  aby vypadala dobøe. Existují zpùsoby pro zmírnìní nástrah jednoprùchodového
  enkódování, ale ty mohou tíhnout ke zvy¹ování nepøesnosti datového toku.
</para>
<para>
  Víceprùchodový voliè datového toku nabízí velké výhody oproti jednomu
  prùchodu. Díky statistikám generovaným v prvním prùchodu mù¾e enkodér
  urèit, s rozumnou pøesností, bitovou nároènost enkódování ka¾dého snímku
  pøi jakémkoli kvantizéru. To umo¾òuje mnohem racionálnìj¹í, lépe naplánovanou
  spotøebu bitù mezi drahými (hodnì pohyblivými) a levnými (málo pohyblivými)
  scénami. Nìkolik nápadù jak upravit tuto spotøebu podle svého naleznete ní¾e
  viz <option>qcomp</option>.
</para>
<para>
  Navíc dva prùchody nemusí trvat dvakrát tak dlouho jako jeden. Mù¾ete upravit
  volby prvního prùchodu pro nejvy¹¹í rychlost a ni¾¹í kvalitu.
  Pokud si dobøe zvolíte své volby, mù¾ete mít velmi rychlý první prùchod.
  Výsledná kvalita  ve druhém prùchodu bude trochu hor¹í, proto¾e predikce
  velikosti je ménì pøesná, ale rozdíl v kvalitì je obvykle pøíli¾ malý, aby
  byl vidìt. Zkuste napø. pøidat
  <option>subq=1:frameref=1</option> do <option>x264encopts</option>
  prvnímu prùchodu. Pak ve druhém prùchodu pou¾ijte pomalej¹í volby pro
  vy¹¹í kvalitu:
  <option>subq=6:frameref=15:4x4mv:me=3</option>
</para></listitem>
<listitem><para>
  <emphasis role="bold">Tøíprùchodové enkódování</emphasis>?

  x264 nabízí mo¾nost provádìt vìt¹í poèet následných prùchodù.
  Pokud zadáte <option>pass=1</option> v prvním prùchodu a pak pou¾ijete
  <option>pass=3</option> v následujícím prùchodu, pak tento prùchod
  jak naète statistiky z pøedchozího, tak zapí¹e své vlastní. Dal¹í prùchod
  po nìm pak bude mít velmi dobrou základnu pro vysoce pøesnou predikci
  velikosti snímkù pøi zvoleném kvantizéru. V praxi se celková kvalita
  z toho vze¹lá blí¾í nule a je mo¾né, ¾e tøetí prùchod bude mít hor¹í
  celkový PSNR ne¾ jeho pøedchúdce. Pøi bì¾ném pou¾ití tøi prùchody pomù¾ou,
  pokud dostanete buï ¹patnou predikci datového toku, nebo ¹patnì vypadající
  pøechody mezi scénami po pou¾ití pouze dvou prùchodù.
  To se nejspí¹ mù¾e stát v extrémnì krátkých klipech. Je rovnì¾ nìkolik
  zvlá¹tních pøípadù, ve kterých jsou tøi a více prùchodù dobré pro
  pokroèilé u¾ivatele, ale pro struènost se zde tìmito pøípady zabývat nebudeme.

</para></listitem>
<listitem><para>
  <emphasis role="bold">qcomp</emphasis>:
  <option>qcomp</option> mìní pomìr poètu bitù alokovaných "drahým"
  velmi pohyblivým snímkùm k "levným" málo pohyblivým snímkùm. V jednom
  extrému, <option>qcomp=0</option> vede k èistì konstantnímu datovému toku.
  Co¾ typicky èiní velmi pohyblivé scény velmi o¹klivé, zatímco scény
  s malým pohybem vypadají perfektnì, ale spotøebovávají mnohem vìt¹í datový
  tok, ne¾ by potøebovaly k tomu, aby je¹tì vypadaly skvìle.
  Ve druhém extrému, <option>qcomp=1</option>, dostanete témìø konstantní
  kvantizaèní parametr (QP). Konstantní QP nevypadá ¹patnì, ale vìt¹ina
  lidí soudí, ¾e je rozumnìj¹í sní¾it trochu datový tok v extrémnì
  nároèných scénách (kde sní¾ení kvality není tak vidìt) a realokovat je
  do scén, které je snadnìj¹í enkódovat pøi excelentní kvalitì.
  Výchozí hodnota <option>qcomp</option> je 0.6, co¾ mù¾e být, podle
  nìkterých lidí ponìkud málo (bì¾nì se rovnì¾ pou¾ívá 0.7-0.8).
</para></listitem>
<listitem><para>
  <emphasis role="bold">keyint</emphasis>:
  <option>keyint</option> je výhradnì pro výmìnu míry pøevinutelnosti
  za efektivitu kódování. Výchozí hodnota <option>keyint</option> je 250.
  V materiálu 25 snímkù za sekundu to zaji¹»uje schopnost pøevíjení
  s 10 sekundovou pøesností. Pokud soudíte, ¾e bude dùle¾ité a u¾iteèné
  být schopen pøevíjet s pøesností 5 sekund, nastavte
  <option>keyint=125</option>;
  to ov¹em trochu sní¾í kvalitu/datový tok. Pokud vám jde jen o kvalitu, nikoli
  pøevinutelnost, mù¾ete si nastavit mnohem vy¹¹í hodnoty
  (rozumìjte ¾e zisk z toho klesá a mù¾e být neznatelný a¾ ¾ádný).
  Video proud bude stále mít pøevíjecí body, pokud jsou zde nìjaké zmìny scény.
</para></listitem> 
<listitem><para>
  <emphasis role="bold">deblockalpha, deblockbeta</emphasis>:
  Tato vìc zaèíná být trochu kontroverzní.
</para>
<para>
  H.264 definuje jednoduchou deblokovací proceduru I-blokù, která pou¾ívá
  pøednastavených sil a prahù závislých na QP daného bloku.
  Výchozí je, ¾e bloky s vysokým QP jsou filtrovány silnì a bloky s nízkým QP
  nejsou deblokovány vùbec.
  Pøednastavené síly definované standardem jsou dobøe zvoleny a
  vyvá¾eny tak, ¾e jsou optimální z hlediska PSNR pro libovolné
  video, které zkou¹íte enkódovat.
  Volby <option>deblockalpha</option> a <option>deblockbeta</option>
  umo¾òují nastavit offsety pøednastaveným deblokovacím prahùm.
</para>
<para>
  Zdá se, ¾e si mnoho lidí myslí, ¾e je dobré sní¾it sílu deblokovacího filtru
  o vysokou hodnotu (øeknìme, -3).
  To v¹ak není témìø nikdy dobrý nápad a v mnoha pøípadech lidé,
  kteøí to dìlají, nerozumí dobøe tomu, jak pracuje výchozí deblokování.
</para>
<para>
  První a nejdùle¾itìj¹í vìc, kterou byste mìli vìdìt o in-loop
  deblokovacím filtru, je, ¾e výchozí prahy jsou témìø v¾dy optimální
  z hlediska PSNR.
  V øídkých pøípadech, kdy nejsou, je ideální offset plusmínus 1.
  Úprava deblokovacích parametrù o vìt¹í hodnotu témìø zaruèenì
  po¹kodí PSNR.
  Zesílení filtru setøe více detailù; oslabení filtru povede k
  zvý¹ené viditelnosti blokování.
</para>
<para>
  Rozhodnì je hloupost sni¾ovat deblokovací prahy pokud má va¹e video
  pøevá¾nì nízkou plo¹nou komplexnost (èili málo detailù nebo ¹umu).
  In-loop filtr odvádí témìø výbornou práci v ukrývání
  artefaktù, které se mohou vyskytnout.
  Pokud má zdroj vysokou pl¹nou komplexnost, pak jsou artefakty ménì viditelné.
  To proto, ¾e krou¾kování vypadá podobnì jako detail nebo ¹um.
  Lidské oko snadno rozpozná, pokud je odstranìn detail, ale ne
  u¾ tak snadno pozná, ¾e je ¹um reprezentován ¹patnì.
  Kdy¾ pøíjde na subjektivní kvalitu, pak jsou detaily a ¹um do jisté míry
  zamìnitelné.
  Oslabením deblokovacího filtru nejspí¹e zvý¹íte chybu, pøidáním
  krou¾kových artefaktù, ale oko si toho nev¹imne, jeliko¾ je zamìní
  za detaily.
</para>

<para>
  <emphasis role="bold">Ani to</emphasis> v¹ak neospravedlòuje
  oslabení deblokovacího filtru.
  Obecnì dostanete kvalitnìj¹í ¹um pomocí postprocesingu.
  Pokud va¹e H.264 videa vypadají pøíli¹ neostøe nebo rozmazanì, zkuste si
  pohrát s <option>-vf noise</option> pøi pøehrávání.
  Volba <option>-vf noise=8a:4a</option> by mìla skrýt vìt¹inu støednì silných
  artefaktù.
  Témìø urèitì to bude vypadat lépe, ne¾ výsledky, které byste mohli dosáhnout
  pohráváním si s deblokovacím filtrem.
</para></listitem>
</itemizedlist>
</sect3>
</sect2>

<sect2 id="menc-feat-x264-example-settings">
<title>Pøíklady nastavení enkódování</title>

<para>
  Následující nastavení jsou pøíklady nastavení rùzných kombinací voleb
  enkodéru, které ovlivòují pomìr rychlost versus kvalita pøi shodném
  cílovém datovém toku.
</para>

<para>
  Ve¹kerá nastavení byla testována na video vzorku 720x448 @30000/1001
  snímkù za sekundu, cílový datový tok byl 900kbps a provádìly se na
  AMD-64 3400+ pøi 2400 Mhz v re¾imu 64 bitù.
  Ka¾dá kombinace nastavení má uvedenu zmìøenou rychlost enkódování
  (ve snímcích za sekundu) a ztrátu PSNR (v dB) oproti nastavení
  "velmi vysoká kvalita".
  Rozumìjte v¹ak ¾e, v závislosti na va¹em zdrojovém materiálu, typu
  poèítaèe a pokrokùm ve vývoji, mù¾ete dospìt k velmi odli¹ným výsledkùm.
</para>

<para>
<informaltable frame="all">
<tgroup cols="4">
<thead>
<row><entry>Popis</entry><entry>Volby</entry><entry>Rychlost [fps]</entry><entry>Relativní ztráta PSNR [dB]</entry></row>
</thead>
<tbody>
<row>
  <entry>Velmi vysoká kvalita</entry>
  <entry><option>subq=6:4x4mv:8x8dct:me=3:frameref=5:bframes=3:b_pyramid:weight_b</option></entry>
  <entry>6</entry>
  <entry>0</entry>
</row>
<row>
  <entry>Vysoká kvalita</entry>
  <entry><option>subq=5:4x4mv:8x8dct:frameref=2:bframes=3:b_pyramid:weight_b</option></entry>
  <entry>13</entry>
  <entry>-0.89</entry>
</row>
<row>
  <entry>Rychlé enkódování</entry>
  <entry><option>subq=4:bframes=2:b_pyramid:weight_b</option></entry>
  <entry>17</entry>
  <entry>-1.48</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</para>
</sect2>

</sect1>

<sect1 id="menc-feat-vcd-dvd">
<title>Pou¾ití MEncoder k vytváøení VCD/SVCD/DVD-kompatibilních souborù.</title>

<sect2 id="menc-feat-vcd-dvd-constraints">
<title>Omezení Formátù</title>
<para>
  <application>MEncoder</application> je schopen vytvoøit soubory ve
  formátu MPEG pro VCD, SCVD a DVD pomocí knihovny
  <systemitem class="library">libavcodec</systemitem>.
  Tyto soubory pak mohou být pou¾ity ve spojení s programem
  <ulink url="http://www.gnu.org/software/vcdimager/vcdimager.html">vcdimager</ulink>
  nebo
  <ulink url="http://dvdauthor.sourceforge.net/">dvdauthor</ulink>
  pro vytvoøení disku pøehratelného na stolním pøehrávaèi.
</para>

<para>
  Formáty DVD, SVCD a VCD mají silná omezení.
  K dispozici máte pouze malý výbìr vlikostí enkódovaného obrazu a pomìrù stran.
  Pokud vá¹ film nesplòuje tyto po¾adavky, budete jej muset ¹kálovat, oøezat
  nebo pøidat èerné okraje, aby byl kompatibilní.
</para>

<sect3 id="menc-feat-vcd-dvd-constraints-resolution">
<title>Omezení Formátù</title>

<informaltable frame="all">
<tgroup cols="9">
<thead>
    <row>
        <entry>Formát</entry>
        <entry>Rozli¹ení</entry>
        <entry>V. kodec</entry>
        <entry>V. dat. tok</entry>
        <entry>Vzork. kmitoèet</entry>
        <entry>A. kodec</entry>
        <entry>A. dat. tok</entry>
        <entry>FPS</entry>
        <entry>Pomìr stran</entry>
    </row>
</thead>
<tbody>
    <row>
        <entry>NTSC DVD</entry>
        <entry>720x480, 704x480, 352x480, 352x240</entry> 
        <entry>MPEG-2</entry>
        <entry>9800 kbps</entry>
        <entry>48000 Hz</entry>
        <entry>AC3,PCM</entry>
        <entry>1536 kbps (max)</entry>
        <entry>30000/1001, 24000/1001</entry>
        <entry>4:3, 16:9 (pouze pro 720x480)</entry>
    </row>
    <row>
        <entry>NTSC DVD</entry>
        <entry>352x240<footnote id='fn-rare-resolutions'><para>
	  Tato rozli¹ení jsou zøídka pou¾ita pro DVD, proto¾e
	  mají docela nízkou kvalitu.</para></footnote></entry> 
        <entry>MPEG-1</entry>
        <entry>1856 kbps</entry>
        <entry>48000 Hz</entry>
        <entry>AC3,PCM</entry>
        <entry>1536 kbps (max)</entry>
        <entry>30000/1001, 24000/1001</entry>
        <entry>4:3, 16:9</entry>
    </row>
    <row>
        <entry>NTSC SVCD</entry>
        <entry>480x480</entry>
        <entry>MPEG-2</entry>
        <entry>2600 kbps</entry>
        <entry>44100 Hz</entry>
        <entry>MP2</entry>
        <entry>384 kbps (max)</entry>
        <entry>30000/1001</entry>
        <entry>4:3</entry>
    </row>
    <row>
        <entry>NTSC VCD</entry>
        <entry>352x240</entry>
        <entry>MPEG-1</entry>
        <entry>1150 kbps</entry>
        <entry>44100 Hz</entry>
        <entry>MP2</entry>
        <entry>224 kbps</entry>
        <entry>24000/1001, 30000/1001</entry>
        <entry>4:3</entry>
    </row>
    <row>
        <entry>PAL DVD</entry>
        <entry>720x576, 704x576, 352x576, 352x288</entry>
        <entry>MPEG-2</entry>
        <entry>9800 kbps</entry>
        <entry>48000 Hz</entry>
        <entry>MP2,AC3,PCM</entry>
        <entry>1536 kbps (max)</entry>
        <entry>25</entry>
        <entry>4:3, 16:9 (pouze pro 720x576)</entry>
    </row>
    <row>
        <entry>PAL DVD</entry>
        <entry>352x288<footnoteref linkend='fn-rare-resolutions'/></entry>
        <entry>MPEG-1</entry>
        <entry>1856 kbps</entry>
        <entry>48000 Hz</entry>
        <entry>MP2,AC3,PCM</entry>
        <entry>1536 kbps (max)</entry>
        <entry>25</entry>
        <entry>4:3, 16:9</entry>
    </row>
    <row>
        <entry>PAL SVCD</entry>
        <entry>480x576</entry>
        <entry>MPEG-2</entry>
        <entry>2600 kbps</entry>
        <entry>44100 Hz</entry>
        <entry>MP2</entry>
        <entry>384 kbps (max)</entry>
        <entry>25</entry>
        <entry>4:3</entry>
    </row>
    <row>
        <entry>PAL VCD</entry>
        <entry>352x288</entry>
        <entry>MPEG-1</entry>
        <entry>1152 kbps</entry>
        <entry>44100 Hz</entry>
        <entry>MP2</entry>
        <entry>224 kbps</entry>
        <entry>25</entry>
        <entry>4:3</entry>
    </row>
</tbody>
</tgroup>
</informaltable>

<para>
  Pokud má va¹e video pomìr stran 2.35:1 (vìt¹ina souèasných akèních filmù),
  budete muset pøidat èerné okraje, nebo oøezat video na 16:9, abyste mohli
  vytvoøit DVD nebo VCD.
  Pokud pøidáváte èerné okraje, zkuste je napasovat do 16 pixelových okrajù,
  abyste minimalizovali vliv na výkon enkódování.
  Na¹tìstí má DVD dostateènì vysoký datový tok, tak¾e se nemusíte pøíli¹
  zabývat efektivitou enkódování, ale u SVCD a VCD je k dispozici jen malý
  datový tok, tak¾e vy¾aduje vìt¹í snahu pro dosa¾ení pøijatelné kvlaity.
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-constraints-gop">
<title>Omezení velikosti GOP</title>
<para>
  DVD, VCD a SVCD vás rovnì¾ omezují na relativnì nízké GOP (skupina obrázkù)
  velikosti.
  Pro materiál 30 snímkù za sekundu je nejvìt¹í povolená GOP velikost 18.
  Pro 25 nebo 24 snímkù/s je maximum 15.
  Velikost GOP je nastavena pomocí volby <option>keyint</option>.
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-constraints-bitrate">
<title>Omezení datového toku</title>
<para>
  VCD video musí být CBR pøi 1152 kbps.
  Tento velmi omezující po¾adavek je zde spolu s velmi malou vbv vyrovnávací
  pamìtí 327 kilobitù.
  SVCD umo¾òuje promìnné datové toky a¾ do 2500 kbps a ponìkud ménì
  omezující velikost vbv bufferu 917 kilobitù.
  Datové toky pro DVD mohou být libovolné a¾ do 9800 kbps (aèkoli typické
  datové toky jsou asi polovièní) a velikost vbv buferu je 1835 kilobitù.
</para>
</sect3>
</sect2>

<sect2 id="menc-feat-vcd-dvd-output">
<title>Výstupní volby</title>
<para>
  <application>MEncoder</application> má volby pro ovládání výstupního formátu.
  Pomocí tìchto voleb jej mù¾ete instruovat, aby pou¾il správný typ souboru.
</para>

<para>
  Volby pro VCD a SVCD se nazývají xvcd a xsvcd, proto¾e to jsou roz¹íøené
  formáty.
  Nejsou pøesnì kompatibilní hlavnì proto, ¾e výstup neobsahuje skenovací
  offsety.
  Pokud potøebujete generovat SVCD obraz, mìli byste protáhnout výstupní soubor
  programem
  <ulink url="http://www.gnu.org/software/vcdimager/vcdimager.html">vcdimager</ulink>.
</para>

<para>
  VCD:
  <screen>
  -of mpeg -mpegopts format=xvcd
  </screen>
</para>

<para>
  SVCD:
  <screen>
  -of mpeg -mpegopts format=xsvcd
  </screen>
</para>

<para>
  DVD:
  <screen>
  -of mpeg -mpegopts format=dvd
  </screen>
</para>

<para>
  DVD s NTSC Pullup:
  <screen>
  -of mpeg -mpegopts format=dvd:telecine -ofps 24000/1001
  </screen>
  Toto umo¾òuje enkódovat 24000/1001 fps progresivní materiál pøi 30000/1001 
  fps pøi zachování sluèitelnosti s DVD.
</para>

<sect3 id="menc-feat-vcd-dvd-output-aspect">
<title>Pomìr stran</title>
<para>
  Argument aspect z <option>-lavcopts</option> se pou¾ívá pro zakódování
  pomìru stran souboru.
  Bìhem pøehrávání je pak tato hodnota pou¾ita pro obnovení videa na
  správnou velikost.
</para>

<para>
  16:9 neboli "Widescreen"
  <screen>
  -lavcopts aspect=16/9
  </screen>
</para>

<para>
  4:3 neboli "Fullscreen"
  <screen>
  -lavcopts aspect=4/3
  </screen>
</para>

<para>
  2.35:1 neboli "Cinemascope" NTSC
  <screen>
  -vf scale=720:368,expand=720:480 -lavcopts aspect=16/9
  </screen>
  Pro výpoèet správné velikosti pro ¹kálování, pou¾ijte roz¹íøenou NTSC ¹íøku
  854/2.35 = 368
</para>

<para>
  2.35:1 neboli "Cinemascope" PAL
  <screen>
  -vf scale="720:432,expand=720:576 -lavcopts aspect=16/9
  </screen>
  Pro výpoèet správné velikosti pro ¹kálování, pou¾ijte roz¹íøenou PAL ¹íøku
  1024/2.35 = 432
</para>

</sect3>

<sect3 id="menc-feat-vcd-dvd-output-srate">
<title>Pøevod vzorkovacího kmitoètu</title>
<para>
  Pokud není vzorkovací kmitoèet zvuku takový, jaký je vy¾adován
  cílovým formátem, je nutný pøevod vzorkovacího kmitoètu.
  To zaji¹»uje pou¾ití volby <option>-srate</option> spolu se zvukovým filtrem
  <option>-af lavcresample</option>.
  </para>
  <para>
  DVD:
  <screen>
  -srate 48000 -af lavcresample=48000
  </screen>
</para>
<para>
  VCD a SVCD:
  <screen>
  -srate 44100 -af lavcresample=44100
  </screen>
  </para>
</sect3>
</sect2>

<sect2 id="menc-feat-vcd-dvd-lavc">
<title>Pou¾ití libavcodec pro enkódování VCD/SVCD/DVD</title>

<sect3 id="menc-feat-vcd-dvd-lavc-intro">
<title>Úvodem</title>
<para>
  <systemitem class="library">libavcodec</systemitem> mù¾ete pou¾ít pro
  vytvoøení videa kompatibilního s VCD/SVCD/DVD pou¾itím pøíslu¹ných voleb.
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-lavc-options">
<title>lavcopts</title>
<para>
  Zde máte seznam polí v <option>-lavcopts</option>, která je nutné
  zmìnit, abyste dostali video vhodné pro VCD, SVCD,
  nebo DVD:
</para>

<itemizedlist>
<listitem><para>
  <emphasis role="bold">acodec</emphasis>:
  <option>mp2</option> pro VCD, SVCD nebo PAL DVD;
  <option>ac3</option> je obecnì pou¾íván pro DVD.
  PCM zvuk mù¾e být rovnì¾ pou¾itý pro DVD, ale vìt¹inou je to velké plýtvání
  místem.
  Poznamenejme, ¾e MP3 není sluèitelné s ¾ádným z tìchto formátù, ale
  pøehrávaèe s jeho pøehrátím obvykle nemají problém.
</para></listitem>

<listitem><para>
  <emphasis role="bold">abitrate</emphasis>:
  224 pro VCD; do 384 pro SVCD; do 1536 pro  DVD, ale obvykle se hodnoty
  pohybují od 192 kbps pro stereo do 384 kbps pro 5.1 kanálový zvuk.
</para></listitem>

<listitem><para>
  <emphasis role="bold">vcodec</emphasis>:
  <option>mpeg1video</option> pro VCD;
  <option>mpeg2video</option> pro SVCD;
  <option>mpeg2video</option> je obvykle pou¾itý pro DVD, ale mù¾ete pou¾ít také
  <option>mpeg1video</option> pro CIF rozli¹ení.
</para></listitem>

<listitem><para>
  <emphasis role="bold">keyint</emphasis>:
  Pou¾itý pro nastavení velikosti GOP.
  18 pro 30fps materiál, nebo 15 pro 25/24 fps materiál.
  Zdá se, ¾e komerèní producenti preferují interval mezi klíèovými snímky 12.
  Je mo¾né pou¾ít vy¹¹í hodnotu a stále být kompatibilní s vìt¹inou
  pøehrávaèù.
  <option>keyint</option> na 25 by nemìla nikdy zpùsobit potí¾e.
</para></listitem>

<listitem><para>
  <emphasis role="bold">vrc_buf_size</emphasis>:
  327 pro VCD, 917 pro SVCD a 1835 pro DVD.
</para></listitem>

<listitem><para>
  <emphasis role="bold">vrc_minrate</emphasis>:
  1152, pro VCD. Mù¾e být vynecháno pro SVCD a DVD.
</para></listitem>

<listitem><para>
  <emphasis role="bold">vrc_maxrate</emphasis>:
  1152 pro VCD; 2500 pro SVCD; 9800 pro DVD.
  Pro SVCD a DVD, mù¾ete pou¾ít ni¾¹í hodnoty v závislosti na va¹ich
  osobních preferencích a potøebách.
</para></listitem>

<listitem><para>
  <emphasis role="bold">vbitrate</emphasis>:
  1152 pro VCD;
  do 2500 pro SVCD;
  do 9800 pro DVD.
  Pro dva poslední formáty by mìlo být vbitrate nastaveno podle vlastního
  uvá¾ení.
  Napøíklad pokud trváte na umístìní asi 20 hodin na DVD, mohli byste pou¾ít
  vbitrate=400.
  Výsledná kvalita bude nejspí¹ hrozná.
  Pokud se pokou¹íte dosáhnout maximální mo¾né kvality na DVD, pou¾ijte
  vbitrate=9800, ale pak se vám nevejde ani celá hodina záznamu na jednovrstvé
  DVD.
</para></listitem>
</itemizedlist>
</sect3>

<sect3 id="menc-feat-vcd-dvd-lavc-examples">
<title>Pøíklady</title>
<para>
  Toto je typická minimální sada <option>-lavcopts</option> pro
  enkódování videa:
</para>
<para>
  VCD:
  <screen>
  -lavcopts vcodec=mpeg1video:vrc_buf_size=327:vrc_minrate=1152:\
  vrc_maxrate=1152:vbitrate=1152:keyint=15:acodec=mp2
  </screen>
</para>

<para>
  SVCD:
  <screen>
  -lavcopts vcodec=mpeg2video:vrc_buf_size=917:vrc_maxrate=2500:vbitrate=1800:\
  keyint=15:acodec=mp2
  </screen>
</para>

<para>
  DVD:
  <screen>
  -lavcopts vcodec=mpeg2video:vrc_buf_size=1835:vrc_maxrate=9800:vbitrate=5000:\
  keyint=15:acodec=ac3
  </screen>
</para>

</sect3>

<sect3 id="menc-feat-vcd-dvd-lavc-advanced">
<title>Pokroèilé volby</title>
<para>
  Pro vy¹¹í kvalitu enkódování mù¾ete také pøidat kvalitu zlep¹ující volby
  do lavcopts, jako je <option>trell</option>,
  <option>mbd=2</option> a dal¹í.
  Poznamenejme, ¾e <option>qpel</option> a <option>v4mv</option>, které jsou
  èasto dobré pro MPEG-4, nejsou pou¾itelné s MPEG-1 nebo MPEG-2.
  Pokud se sna¾íte vytvoøit DVD s velmi vasokou kvalitou, mù¾e být vhodné
  pøidat <option>dc=10</option> do lavcopts.
  Takto to mù¾ete pomoci omezit obìvování blokù ve stálobarevných plochách.
  Podtr¾eno seèteno, zde máte pøíklad nastavení lavcopts pro DVD s vy¹¹í
  kvalitou:
</para>

<para>
  <screen>
  -lavcopts vcodec=mpeg2video:vrc_buf_size=1835:vrc_maxrate=9800:vbitrate=8000:\
  keyint=15:trell:mbd=2:precmp=2:subcmp=2:cmp=2:dia=-10:predia=-10:cbp:mv0:\
  vqmin=1:lmin=1:dc=10
  </screen>
</para>

</sect3>
</sect2>

<sect2 id="menc-feat-vcd-dvd-audio">
<title>Enkódování zvuku</title>
<para>
  VCD a SVCD podporují zvuk MPEG-1 layer II. Pou¾ít mù¾ete
  <systemitem class="library">toolame</systemitem>,
  <systemitem class="library">twolame</systemitem>,
  nebo MP2 enkodér z <systemitem class="library">libavcodec</systemitem>u.
  MP2 libavcodecu je dalek toho, aby byl stejnì dobrý jako druhé dvì knihovny,
  av¹ak mìl by být v¾dy po ruce.
  VCD podporuje pouze zvuk s konstantním datovým tokem (CBR), zatímco SVCD
  podporuje také promìnný datový tok (VBR).
  Pou¾ívejte VBR opatrnì, jeliko¾ nìkteré mizerné stolní pøehrávaèe jej
  nemusí dobøe podporovat.
</para>

<para>
  Pro DVD zvuk se pou¾ívá AC3 kodek z
  <systemitem class="library">libavcodec</systemitem>.
</para>

<sect3 id="menc-feat-vcd-dvd-audio-toolame">
<title>toolame</title>
<para>
  Pro VCD a SVCD:
  <screen>
  -oac toolame -toolameopts br=224
  </screen>
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-audio-twolame">
<title>twolame</title>
<para>
  Pro VCD a SVCD:
  <screen>
  -oac twolame -twolameopts br=224
  </screen>
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-audio-lavc">
<title>libavcodec</title>
<para>
  Pro DVD s 2 kanálovým zvukem:
  <screen>
  -oac lavc -lavcopts acodec=ac3:abitrate=192
  </screen>
</para>
<para>
  Pro DVD s 5.1 kanálovým zvukem:
  <screen>
  -channels 6 -oac lavc -lavcopts acodec=ac3:abitrate=384
  </screen>
</para>
<para>
  Pro VCD a SVCD:
  <screen>
  -oac lavc -lavcopts acodec=mp2:abitrate=224
  </screen>
</para>
</sect3>

</sect2>

<sect2 id="menc-feat-vcd-dvd-all">
<title>Spojení v¹eho dohromady</title>
<para>
  Tato sekce obsahuje kompletní pøíkazy pro vytvoøení VCD/SVCD/DVD
  kompatibilních videí.
</para>

<sect3 id="menc-feat-vcd-dvd-all-pal-dvd">
<title>PAL DVD</title>
<para>
  <screen>
  mencoder -oac lavc -ovc lavc -of mpeg -mpegopts format=dvd -vf scale=720:576,\
  harddup -srate 48000 -af lavcresample=48000 -lavcopts vcodec=mpeg2video:\
  vrc_buf_size=1835:vrc_maxrate=9800:vbitrate=5000:keyint=15:acodec=ac3:\
  abitrate=192:aspect=16/9 -ofps 25 \
  -o <replaceable>film.mpg</replaceable> <replaceable>film.avi</replaceable>
  </screen>
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-all-ntsc-dvd">
<title>NTSC DVD</title>
<para>
  <screen>
  mencoder -oac lavc -ovc lavc -of mpeg -mpegopts format=dvd -vf scale=720:480,\
  harddup -srate 48000 -af lavcresample=48000 -lavcopts vcodec=mpeg2video:\
  vrc_buf_size=1835:vrc_maxrate=9800:vbitrate=5000:keyint=18:acodec=ac3:\
  abitrate=192:aspect=16/9 -ofps 30000/1001 \
  -o <replaceable>film.mpg</replaceable> <replaceable>film.avi</replaceable>
  </screen>
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-all-pal-ac3-copy">
<title>PAL AVI obsahující AC3 zvuk do DVD</title>
<para>
  Pokud ji¾ má zdroj AC3 zvuk, pou¾ijte -oac copy místo reenkódování.
  <screen>
  mencoder -oac copy -ovc lavc -of mpeg -mpegopts format=dvd -vf scale=720:576,\
  harddup -lavcopts vcodec=mpeg2video:vrc_buf_size=1835:vrc_maxrate=9800:\
  vbitrate=5000:keyint=15:aspect=16/9 -ofps 25 \
  -o <replaceable>film.mpg</replaceable> <replaceable>film.avi</replaceable>
  </screen>
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-all-ntsc-ac3-copy">
<title>NTSC AVI obsahující AC3 zvuk do DVD</title>
<para>
  Pokud ji¾ má zdroj AC3 zvuk a video je NTSC @ 24000/1001 fps:
  <screen>
  mencoder -oac copy -ovc lavc -of mpeg -mpegopts format=dvd:telecine \
  -vf scale=720:480,harddup -lavcopts vcodec=mpeg2video:vrc_buf_size=1835:\
  vrc_maxrate=9800:vbitrate=5000:keyint=15:aspect=16/9 -ofps 24000/1001 \
  -o <replaceable>film.mpg</replaceable> <replaceable>film.avi</replaceable>
  </screen>
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-all-pal-svcd">
<title>PAL SVCD</title>
<para>
  <screen>
  mencoder -oac lavc -ovc lavc -of mpeg -mpegopts format=xsvcd -vf \
  scale=480:576,harddup -srate 44100 -af lavcresample=44100 -lavcopts \
  vcodec=mpeg2video:mbd=2:keyint=15:vrc_buf_size=917:vrc_minrate=600:\
  vbitrate=2500:vrc_maxrate=2500:acodec=mp2:abitrate=224 -ofps 25 \
  -o <replaceable>film.mpg</replaceable> <replaceable>film.avi</replaceable>
  </screen>
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-all-ntsc-svcd">
<title>NTSC SVCD</title>
<para>
  <screen>
  mencoder -oac lavc -ovc lavc -of mpeg -mpegopts format=xsvcd  -vf \
  scale=480:480,harddup -srate 44100 -af lavcresample=44100 -lavcopts \
  vcodec=mpeg2video:mbd=2:keyint=18:vrc_buf_size=917:vrc_minrate=600:\
  vbitrate=2500:vrc_maxrate=2500:acodec=mp2:abitrate=224 -ofps 30000/1001 \
  -o <replaceable>film.mpg</replaceable> <replaceable>film.avi</replaceable>
  </screen>
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-all-pal-vcd">
<title>PAL VCD</title>
<para>
  <screen>
  mencoder -oac lavc -ovc lavc -of mpeg -mpegopts format=xvcd -vf \
  scale=352:288,harddup -srate 44100 -af lavcresample=44100 -lavcopts \
  vcodec=mpeg1video:keyint=15:vrc_buf_size=327:vrc_minrate=1152:vbitrate=1152:\
  vrc_maxrate=1152:acodec=mp2:abitrate=224 -ofps 25 \
  -o <replaceable>film.mpg</replaceable> <replaceable>film.avi</replaceable>
  </screen>
</para>
</sect3>

<sect3 id="menc-feat-vcd-dvd-all-ntsc-vcd">
<title>NTSC VCD</title>
<para>
  <screen>
  mencoder -oac lavc -ovc lavc -of mpeg -mpegopts format=xvcd -vf \
  scale=352:240,harddup -srate 44100 -af lavcresample=44100 -lavcopts \
  vcodec=mpeg1video:keyint=18:vrc_buf_size=327:vrc_minrate=1152:vbitrate=1152:\
  vrc_maxrate=1152:acodec=mp2:abitrate=224 -ofps 30000/1001 \
  -o <replaceable>film.mpg</replaceable> <replaceable>film.avi</replaceable>
  </screen>
</para>
</sect3>

</sect2>

</sect1>

</chapter>
