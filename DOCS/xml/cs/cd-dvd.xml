<?xml version="1.0" encoding="iso-8859-2"?>
<!-- synced with r19751 -->
<chapter id="cd-dvd">
<title>Pou¾ití CD/DVD</title>

<sect1 id="drives">
<title>CD/DVD mechaniky</title>

<para>
Moderní CD-ROM mechaniky dosahují velmi vysokých otáèek a nìkteré z nich
mohou pracovat i se sní¾enými otáèkami. Existuje nìkolik dùvodù, pro
které byste mohli chtít zmìnit rychlost CD-ROM mechaniky:
</para>

<itemizedlist>
<listitem><para>
Byly zprávy o chybách ètení pøi vysokých rychlostech, zvlá¹tì u ¹patnì
vylisovaných CD-ROMù. Z tìchto dùvodù mù¾e sní¾ení rychlosti pùsobit
jako prevence ztráty dat.
</para></listitem>

<listitem><para>
Mnoho CD-ROM mechanik je nechutnì hluèných, ni¾¹í rychlost mù¾e omezit
tento hluk.
</para></listitem>
</itemizedlist>

<sect2 id="drives_linux">
<title>Linux</title>

<para>
Mù¾ete sní¾it rychlost IDE CD-ROM mechanik pomocí <command>hdparm</command>,
<command>setcd</command> nebo <command>cdctl</command>. Pracuje to asi takto:
<screen>hdparm -E <replaceable>[rychlost]</replaceable> <replaceable>[mechanika cdrom]</replaceable></screen>
<screen>setcd -x <replaceable>[rychlost]</replaceable> <replaceable>[mechanika cdrom]</replaceable></screen>
<screen>cdctl -bS <replaceable>[rychlost]</replaceable></screen>
</para>

<para>
Pokud pou¾íváte SCSI emulaci, budete muset pøedat tato nastavení do skuteèného
IDE zaøízení, nikoli emulovaného SCSI zaøízení.
</para>

<para>
Pokud máte práva root-a, následující pøíkaz vám rovnì¾ mù¾e pomoci:
<screen>echo file_readahead:2000000 &gt; /proc/ide/<replaceable>[mechanika cdrom]</replaceable>/settings</screen>
</para>

<para>
To nastaví ètení napøed na 2MB, co¾ pomù¾e pøi po¹krábaných médiích.
Pokud ji v¹ak nastavíte pøíli¹ vysoko, bude mechanika stále zrychlovat a
zpomalovat, co¾ výraznì sní¾í její výkon.
Doporuèujeme vám rovnì¾ vyladit va¹i CD-ROM mechaniku pomocí <command>hdparm</command>:
<screen>hdparm -d1 -a8 -u1 <replaceable>[cdrom zaøízení]</replaceable></screen>
</para>

<para>
To zapne DMA pøístup, ètení napøed a odmaskování IRQ (pøeètìte si man stránku
programu <command>hdparm</command> pro podrobné vysvìtlení).
</para>

<para>
Prostudujte si &quot;<filename>/proc/ide/<replaceable>cdrom zaøízení</replaceable>/settings&quot;</filename>
pro jemné doladìní va¹í CD-ROM.
</para>

<para>
SCSI mechaniky nemají jednotný zpùsob pro nastavení tìchto parametrù (Znáte nìjaký?
Øeknìte nám jej!). Existuje nástroj, který pracuje se
<ulink url="http://das.ist.org/~georg/">SCSI mechanikami Plextor</ulink>.
</para>

</sect2>


<sect2 id="drives_freebsd">
<title>FreeBSD</title>

<para>rychlost:
<screen>
cdcontrol [-f <replaceable>zaøízení</replaceable>] speed <replaceable>[rychlost]</replaceable>
</screen>
</para>

<para>DMA:
<screen>
sysctl hw.ata.atapi_dma=1
</screen>
</para>

</sect2>

</sect1>

<sect1 id="dvd">
<title>Pøehrávání DVD</title>
<para>
Úplný seznam dostupných voleb naleznete v man stránce.
Syntaxe pro standardní Digital Versatile Disc (DVD) je následující:
<screen>mplayer dvd://<replaceable>&lt;track&gt;</replaceable> [-dvd-device <replaceable>&lt;DVD_zaøízení&gt;</replaceable>]</screen>
</para>

<para>
Pøíklad:
<screen>mplayer dvd://<replaceable>1</replaceable> -dvd-device <replaceable>/dev/hdc</replaceable></screen>
</para>

<para>
Pokud jste kompilovali <application>MPlayer</application> s podporou dvdnav,
je syntaxe stejná a¾ na to, ¾e musíte pou¾ívat dvdnav:// místo dvd://.
</para>

<para>
Výchozím DVD zaøízením je <filename>/dev/dvd</filename>. Pokud se va¹e nastavení
li¹í, vytvoøte symlink, nebo uveïte správné zaøízení na pøíkazovém øádku
pomocí volby <option>-dvd-device</option>.
</para>

<formalpara>
<title>Nový styl podpory DVD (mpdvdkit2)</title>
<para>
<application>MPlayer</application> pou¾ívá <systemitem>libdvdread</systemitem> a
<systemitem>libdvdcss</systemitem> pro dekódování a pøehrávání DVD. Tyto dvì
knihovny jsou obsa¾eny v podadresáøi
<filename class="directory">libmpdvdkit2/</filename> zdrojových kódù
<application>MPlayer</application>u, nemusíte je tedy instalovat zvlá¹»
Zvolili jsme tento zpùsob, proto¾e jsme museli opravit chybu v
<systemitem>libdvdread</systemitem> a aplikovat patch, který pøidává podporu
<emphasis role="bold">ke¹ování zlomených CSS klíèù</emphasis>, na
<systemitem>libdvdcss</systemitem>. To vedlo k výraznému zvý¹ení rychlosti,
proto¾e klíèe nemusí být nyní lámány poka¾dé pøed pøehráváním.
</para>
</formalpara>

<para>
<application>MPlayer</application> umí rovnì¾ pou¾ít knihovny
<systemitem>libdvdread</systemitem> a <systemitem>libdvdcss</systemitem>
na systémové úrovni, ale toto øe¹ení <emphasis role="bold">nedoporuèujeme</emphasis>,
proto¾e mù¾e vést k chybám, nekompatibilitì knihovny a ni¾¹í rychlosti.
</para>

<note><para>
V pøípadì problémù s dekódováním DVD, zkuste vypnout supermount a podobná udìlátka.
Nìkteré RPC-2 mechaniky mohou rovnì¾ vy¾adovat nastavení region kódu.
</para></note>

<formalpara>
<title>Struktura DVD</title>
<para>
DVD disky mají 2048 bajtù na sektor s ECC/CRC. Obvykle mají souborový systém UDF
v jediné stopì, obsahující rùzné soubory (malé .IFO a .BUK soubory a velké (1GB)
.VOB soubory). Jsou to reálné soubory a mohou být kopírovány/pøehrávány
z pøipojeného systému souborù ne¹ifrovaného DVD.
</para>
</formalpara>

<para>
Soubory .IFO obsahují informace pro navigaci ve filmu (kapitola/titul/mapa úhlù,
tabulka jazykù, atd) a jsou potøeba pro ètení a interpretaci obsahu .VOBu
(filmu). Soubory .BUK jsou jejich zálohami. V¹ude pou¾ívají
<emphasis role="bold">sektory</emphasis>, tak¾e musíte pou¾ít surové (RAW)
adresování sektorù na disku, abyste se mohli navigovat v DVD, nebo dekryptovat
jeho obsah.
</para>

<para>
Podpora DVD vy¾aduje pøímý sektorovì-orientovaný pøístup k zaøízení. Nane¹tìstí
musíte (pod Linuxem) být root, abyste dostali adresu sektoru souboru.
To je dùvod proè vùbec nepou¾íváme modul souborového systému z kernelu a místo
nìj jej implementujeme v u¾ivatelském prostoru. To zaji¹»ují
<systemitem>libdvdread</systemitem> 0.9.x a <systemitem>libmpdvdkit</systemitem>.
UDF ovladaè z kernelu není potøeba, jeliko¾ tyto knihovny mají zabudován svùj
vlastní. Rovnì¾ nemusí být DVD pøimountováno vzhledem k tomu ¾e pou¾íváme
pouze pøímý (raw) pøístup.
</para>

<para>
Nìkdy <filename>/dev/dvd</filename> nemù¾e být èteno u¾ivateli, proto autoøi
<systemitem>libdvdread</systemitem> implementovali emulaèní vrstvu, která
pøevádí sektorové adresy na soubor+offset za úèelem emulace raw pøístupu
nad pøipojeným souborovým systémem nebo dokonce i hard diskem.
</para>

<para>
<systemitem>libdvdread</systemitem> dokonce pøijme bod pøipojení (mountpoint)
místo názvu zaøízení pro pøímý pøístup a podívá se do
<filename>/proc/mounts</filename> na jméno zaøízení. To bylo vyvinuto pro
Solaris, kde jsou názvy souborù dynamicky alokovány.
</para>

<para>
Výchozím DVD zaøízením je <filename>/dev/dvd</filename>. Pokud se va¹e
nastavení li¹í, vytvoøte symlink, nebo uveïte správné zaøízení na pøíkazovém
øádku pomocí volby <option>-dvd-device</option>.
</para>

<formalpara>
<title>DVD autentifikace</title>
<para>
Tato autentifikaèní a dekryptovací metoda nového stylu podpory DVD je
zaji¹»ována pou¾itím patchované knihovny <systemitem>libdvdcss</systemitem>
(viz vý¹). Metoda mù¾e být nastavena pomocí promìnné prostøedí
<envar>DVDCSS_METHOD</envar> nastavené na klíè, disk nebo titul.
</para>
</formalpara>

<para>
Pokud není nastavena, zkou¹í se následující metody (výchozí: "key",
"title request"):
</para>

<orderedlist>
<listitem><para>
<emphasis role="bold">bus key</emphasis>: Tento klíè je dohodnut bìhem
autentifikace (dlouhá smìs ioctl volání a výmìn rùzných klíèù, kryptování)
a je pou¾it pro za¹ifrování klíèù titulu a disku ne¾ jsou odeslány pøes
nechránìnou sbìrnici (jako prevence odposlechnutí). Klíè "bus key" je potøeba
pro pøedde¹ifrování ¹ifrovaného klíèe disku.
</para></listitem>

<listitem><para>
<emphasis role="bold">cached key</emphasis>: <application>MPlayer</application>
se poohlédne po ji¾ zlomených klíèích titulu, které jsou ulo¾eny v adresáøi
<filename class="directory">~/.mplayer/DVDKeys</filename> (rychlé ;).
</para></listitem>

<listitem><para>
<emphasis role="bold">key</emphasis>: Pokud není k dispozici "cached key",
<application>MPlayer</application> zkusí roz¹ifrovat klíè disku pomocí
sady pøilo¾ených klíèù pøehrávaèe.
</para></listitem>

<listitem><para>
<emphasis role="bold">disk</emphasis>: Pokud sel¾e "key" metoda,
(napø. nejsou pøilo¾eny klíèe pøehrávaèe), <application>MPlayer</application>
crackne klíè disku algoritmem hrubé síly. Tento proces je nároèný na CPU a
vy¾aduje 64 MB pamìti (16M 32Bitových polo¾ek hash tabulky) pro ulo¾ení
pracovních dat. Tato metoda by mìla fungovat v¾dy (pomalé).
</para></listitem>

<listitem><para>
<emphasis role="bold">title request</emphasis>: S pomocí klíèe disku, po¾ádá
<application>MPlayer</application> o ¹ifrované klíèe titulu, které jsou
ukryty ve <emphasis>skrytých sektorech</emphasis> pomocí
<systemitem>ioctl()</systemitem>.
Ochrana regiony v RPC-2 mechanikách je provádìna v tomto kroku a na nìkterých
mechanikách mù¾e selhat.
Pokud uspìje, budou klíèe titulu (title keys) dekryptovány pomocí klíèe disku
(disk key) a klíèe sbìrnice (bus key).
</para></listitem>

<listitem><para>
<emphasis role="bold">title</emphasis>: Tato metoda je pou¾ita pokud sel¾e
po¾adavek na titul a nespoléhá se na výmìnu klíèù s DVD mechanikou.
Pou¾ívá se zde kryptografický útok na pøímé urèení klíèe (vyhledáváním
opakujícího se vzoru v de¹ifrovaném obsahu VOB a rozhodnutím zda èistý text
odpovídající prvním ¹ifrovaným bajtùm je pokraèováním tohoto vzoru).
Metoda je také známa jako &quot;known plaintext attack&quot;
nebo &quot;DeCSSPlus&quot;. V nemnoha pøípadech mù¾e metoda selhat z dùvodu
nedostatku ¹ifrovaných dat na disku pro provedení statistického útoku, nebo
proto¾e se klíè mìní uprostøed titulu. Tato metoda je jediným zpùsobem jak
dekryptovat DVD ulo¾ené na harddisku nebo DVD se ¹patným regionem na
RPC2 mechanice (pomalé).
</para></listitem>
</orderedlist>

<para>
RPC-1 DVD mechaniky chrání nastavení regionu pouze softwarovì. RPC-2 mechaniky
mají hardwarovou ochranu umo¾òující pouze 5 zmìn. Mù¾e být potøeba/doporuèeno
provést upgrade firmwaru na RPC-1 pokud máte RPC-2 DVD mechaniku.
Mù¾ete zkusit najít upgrady firmwaru pro svou mechaniku na internetu,
<ulink url="http://forum.rpc-1.com/dl_all.php">toto firmwarové fórum</ulink>
mù¾e být dobrým zaèátkem pro va¹e hledání.
Pokud pro va¹i mechaniku není k dispozici upgrade firmwaru, pou¾ijte
<ulink url="http://linvdr.org/projects/regionset/">nástroj regionset</ulink>
pro nastavení region kódu va¹í DVD mechaniky (pod Linux).
<emphasis role="bold">Varování</emphasis>: Region mù¾ete pøenastavit pouze
pìtkrát.
</para>
</sect1>



<sect1 id="vcd">
<title>Pøehrávání VCD</title>
<para>
Úplný seznam dostupných voleb naleznete v man stránce. Syntaxe pro standardní
Video CD (VCD) je následující:
<screen>mplayer vcd://<replaceable>&lt;stopa&gt;</replaceable> [-cdrom-device <replaceable>&lt;zaøízení&gt;</replaceable>]</screen>
Pøíklad:
<screen>mplayer vcd://<replaceable>2</replaceable> -cdrom-device <replaceable>/dev/hdc</replaceable></screen>
Výchozím VCD zaøízením je <filename>/dev/cdrom</filename>. Pokud se va¹e nastavení
li¹í, vytvoøte symlink nebo uveïte správné zaøízení na pøíkazovém øádku pomocí volby
<option>-cdrom-device</option>.
</para>

<note><para>
Minimálnì SCSI CD-ROM mechaniky Plextor a Toshiba vykazují mizerný výkon
pøi ètení VCD. To proto, ¾e CDROMREADRAW <systemitem>ioctl</systemitem>
není pro tyto mechaniky plnì implementováno. Pokud máte zku¹enosti se
SCSI programováním, prosíme
<ulink url="../../tech/patches.txt">pomozte nám</ulink>
implementovat obecnou SCSI podporu pro VCD.
</para></note>

<para>
Mezitím mù¾ete extrahovat data z VCD pomocí
<ulink url="http://ftp.ntut.edu.tw/ftp/OS/Linux/packages/X/viewers/readvcd/">readvcd</ulink>
a výsledný soubor pøehrát v <application>MPlayer</application>u.
</para>

<formalpara>
<title>Struktura VCD</title>

<para>
Video CD (VCD) je tvoøeno CD-ROM XA sektory, èili stopy CD-ROM mode 2
tøída 1 a 2:</para>
</formalpara>

<itemizedlist>
<listitem><para>
První stopa je ve formátu mode 2 tøída 2 co¾ znamená, ¾e pou¾ívá L2
korekci chyb. Stopa obsahuje souborový systém ISO-9660 s 2048
bajty/sektor. Tento souborový systém obsahuje VCD metadata informace,
stejnì jako statické snímky èasto pou¾ívané v menu. MPEG segmenty menu
mohou být rovnì¾ ulo¾eny v této první stopì, ale tyto MPEGy musí být
rozsekány na série 150 sektorových chunkù. Souborový systém ISO-9660
mù¾e obsahovat dal¹í soubory, které nejsou potøeba pro operace
s VCD.
</para></listitem>

<listitem><para>
Druhá a ostatní stopy jsou v¹eobecnì surovými MPEG (film) stopami
s 2324 bajty/sektor, obsahující jeden MPEG PS datový paket na
sektor. Ty jsou v mode 2 tøída 1 formátu, tak¾e obsahují více dat
v ka¾dém sektoru za cenu omezení korekce chyb. Je rovnì¾ mo¾né mít
CD-DA stopy na VCD za první stopou.
V nìkterých operaèních systémech jsou triky, které umo¾òují zpøístupnit
tyto ne-ISO-9660 stopy v systému souborù. V dal¹ích operaèních
systémech jako GNU/Linux to není mo¾né (zatím). Zde MPEG data
<emphasis role="bold">nemohou být pøipojena</emphasis>. Proto¾e vìt¹ina
filmù je ulo¾ena uvnitø tohoto druhu stopy, mìli byste nejprve zkusit
<option>vcd://2</option>.
</para></listitem>

<listitem><para>
Existují také VCD disky bez první stopy (jediná stopa bez systému souborù).
Mù¾ete je pøehrát, ale nemohou být namountovány.
</para></listitem>

<listitem><para> Definice standardu Video CD se nazývá
Philips "White Book" a není obecnì pøístupná online, ale musí být zakoupena
od Philipsu. Podrobnìj¹í informace o Video CD mù¾ete nalézt
<ulink url="http://www.vcdimager.org/pub/vcdimager/manuals/0.7/vcdimager.html#SEC4">v dokumentaci programu vcdimager</ulink>.
</para></listitem>

</itemizedlist>

<formalpara>
<title>Pár slov o .DAT souborech</title>
<para>
Soubor veliký ~600 MB viditelný v první stopì pøipojeného VCD není
skuteèným souborem! Je to takzvaná ISO gateway, vytvoøená proto,
aby mohl Windows pøistupovat k tìmto stopám (Windows vùbec neumo¾òuje
aplikacím surový pøístup k zaøízení).
Pod Linuxem nemù¾ete kopírovat nebo pøehrávat tyto soubory
(obsahují jen nesmysly). Pod Windows je to mo¾né, proto¾e jeho iso9660
ovladaè emuluje surový pøístup ke stopì v tomto souboru. Abyste mohli
pøehrát .DAT soubor, potøebujete ovladaè kernelu který mù¾ete nalézt
v Linuxové verzi PowerDVD. Obsahuje upravený ovladaè systému souborù
iso9660 (<filename>vcdfs/isofs-2.4.X.o</filename>), který umí emulovat
surové stopy pøes tento stínový .DAT soubor. Pokud pøipojíte disk
s pomocí jejich ovladaèe, mù¾ete kopírovat èi dokonce pøehrávat .DAT
soubory <application>MPlayer</application>em. Ale nebude to fungovat
se standardním iso9660 ovladaèem z Linuxového kernelu! Místo toho
pou¾ijte <option>vcd://</option>. Alternativou kopírování VCD je
nový ovladaè do kernelu jménem
<ulink url="http://www.elis.rug.ac.be/~ronsse/cdfs/">cdfs</ulink>
(není souèástí oficiálního kernelu), který zobrazuje CD sekce jako
obrazové soubory a program
<ulink url="http://cdrdao.sf.net/">cdrdao</ulink>, který bit-po-bitu
grabuje/kopíruje CD.
</para>
</formalpara>
</sect1>
</chapter>
