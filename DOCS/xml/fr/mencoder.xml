<?xml version="1.0" encoding="iso-8859-1"?>
<!-- synced with 1.19 -->
<chapter id="mencoder">
<title>Encodage avec MEncoder</title>

<para>
Pour avoir la liste complète des options disponibles de <application>MEncoder</application>
et des exemples, voir la page de man. Pour une série d'exemples pratiques et de guides
détaillés sur l'utilisation des nombreux paramètres d'encodage, lisez les
<ulink url="../../tech/encoding-tips.txt">encoding-tips</ulink> (en anglais) qui ont
été collectés sur de nombreuses threads de la liste de diffusion
<ulink url="http://mplayerhq.hu/mailman/listinfo/mplayer-users">mplayer-users</ulink>.
Cherchez dans les
<ulink url="http://mplayerhq.hu/pipermail/mplayer-users/">archives</ulink> pour trouver
les discussions à propos de tous les aspects et problèmes relatif à l'encodage avec
<application>MEncoder</application>.
</para>

<sect1 id="menc-feat-divx4">
<title>Encodage MPEG-4 (&quot;DivX&quot;) 2 ou 3-passes</title>

<formalpara>
<title>Encodage 2-passes</title>
<para>
le nom vient du fait que cette méthode encode le fichier <emphasis>deux fois</emphasis>.
Le premier encodage (passe doublée) créé quelques fichiers temporaires (<filename>*.log</filename>)
avec une taille de quelques méga-octets, ne les détruisez pas tout de suite (vous pouvez
effacer l'AVI). Dans la seconde passe, la fichier de sortie 2-passes est créé, en
utilisant les données bitrate des fichiers temporaires. Le fichier résultant aura une
image de bien meilleur qualité. Si c'est la première fois que vous entendez parler de
ça, vous devriez consulter les guides disponibles sur le Net.
</para>
</formalpara>

<para>
Cet exemple montre comment encoder un DVD en AVI MPEG-4 (&quot;DIVX&quot;) AVI 2-passes.
Seules deux commandes sont requises:
<screen>rm frameno.avi</screen>
enlevez ce fichier, qui peut provenir d'un encodage 3-passes précédent (il interfère avec l'actuel)
<screen>
mencoder dvd://2 -ovc lavc -lavcopts vcodec=mpeg4:vpass=1 -oac copy -o <replaceable>film.avi</replaceable>
mencoder dvd://2 -ovc lavc -lavcopts vcodec=mpeg4:vpass=2 -oac copy -o <replaceable>film.avi</replaceable>
</screen>
</para>

<formalpara>
<title>Encodage 3-passes</title>
<para>
c'est une extension de l'encodage 2-passes, où l'encodage audio prends place dans une
passe séparée. Cette méthode permet l'estimation du bitrate vidéo recommandé de façon
à tenir sur un CD. De plus, l'audio n'est encodé qu'une fois, au contraire du mode
2-passes. Le principe:
</para>
</formalpara>

<procedure>
<step><para>
Supprimez les fichiers temporaires conflictuels:
  <screen>rm frameno.avi</screen>
  </para></step>
<step><para>
  <emphasis>Première passe:</emphasis>

  <screen>mencoder <replaceable>fichier/DVD</replaceable> -ovc frameno -oac mp3lame -lameopts vbr=3 -o frameno.avi</screen>

  Un fichier avi audio sera créé, contenant
  <emphasis role="bold">uniquement</emphasis> le flux audio demandé. N'oubliez pas
  <option>-lameopts</option>, si vous en avez besoin. Si vous encodez un long film,
  <application>MEncoder</application> affiche le bitrate recommandé pour les tailles
  650Mo, 700Mo, et 800Mo, après la fin de cette passe.
  </para></step>
<step><para>
  <emphasis>Seconde passe:</emphasis>
  <screen>
mencoder <replaceable>fichier/DVD</replaceable> -oac copy -ovc lavc -lavcopts vcodec=mpeg4:vpass=1:vbitrate=<replaceable>bitrate</replaceable><!--
--></screen>
Ceci est la première passe de l'encodage vidéo. Éventuellement spécifiez le bitrate
vidéo que MEncoder a affiché à la fin de la passe précédente.
  </para></step>
<step><para>
  <emphasis>Troisième passe:</emphasis>
<screen>
mencoder <replaceable>fichier/DVD</replaceable> -oac copy -ovc lavc -lavcopts vcodec=mpeg4:vpass=2:vbitrate=<replaceable>bitrate</replaceable>
</screen>
Ceci est la seconde passe de l'encodage vidéo. Spécifiez le même bitrate vidéo que
celui de la passe précédente à moins que vous ne sachiez réellement ce que vous faites.
Dans cette passe, l'audio de <filename>frameno.avi</filename> sera inséré dans le
fichier de destination... et tout est prêt!
</para></step>
</procedure>

<example>
<title>Exemple d'encodage 3-passes</title>
<para>
<screen>rm frameno.avi</screen>
enlevez ce fichier, qui peut provenir d'un encodage 3-passes précédent (il interfère
avec l'actuel)
<screen>
mencoder dvd://2 -ovc frameno -o frameno.avi -oac mp3lame -lameopts vbr=3
mencoder dvd://2 -ovc lavc -lavcopts vcodec=mpeg4:vpass=1 -oac copy -o <replaceable>film.avi</replaceable>
mencoder dvd://2 -ovc lavc -lavcopts vcodec=mpeg4:vpass=2 -oac copy -o <replaceable>film.avi</replaceable>
</screen>
</para>
</example>
</sect1>

<sect1 id="menc-feat-mpeg">
<title>Encodage au format MPEG</title>
<para>
<application>MEncoder</application> peut créer des fichier au format MPEG (MPEG-PS).
Ceci n'est probablement utile qu'avec le codec <emphasis>mpeg1video</emphasis>
de <systemitem class="library">libavcodec</systemitem>, car les lecteurs - excepté <application>MPlayer</application>
- attendent de la vidéo MPEG1, et de l'audio MPEG1 layer 2 (MP2) dans les fichiers MPEG.
</para>

<para>
Cette fonction n'est pas vraiment utile actuellement, car elle a probablement de
nombreux bogues, mais plus important encore parce qu'actuellement MEncoder ne peut pas
encoder l'audio MPEG1 layer 2 (MP2), qui est attendu par tous les autres lecteurs dans
les fichiers MPEG.
</para>

<para>
Pour changer le format de sortie de MEncoder, utilisez l'option <option>-of mpeg</option>.
</para>

<para>
Exemple:
<screen>
mencoder -of mpeg -ovc lavc -lavcopts vcodec=mpeg1video -oac copy <replaceable>autres options</replaceable>
<replaceable>media.avi</replaceable> -o <replaceable>sortie.mpg</replaceable>
</screen>
</para>
</sect1>


<sect1 id="menc-feat-rescale">
<title>Redimensionnement des films</title>

<para>
Souvent le besoin de redimensionner les images d'un film se fait sentir. Les raisons
peuvent être multiples: diminuer la taille du fichier, la bande passante du réseau, etc.
La plupart des gens redimensionnement même en convertissant des DVDs ou SVCDs en AVI
DivX. C'est <emphasis role="bold">mal</emphasis>. Plutôt que de faire ça, lisez la
section <link linkend="aspect">Préserver l'aspect ratio</link>.
</para>

<para>
Le processus de zoom est géré par le filtre vidéo <literal>scale</literal> :
<option>-vf scale=<replaceable>largeur</replaceable>:<replaceable>hauteur</replaceable></option>.
Sa qualité peut être réglée avec l'option <option>-sws</option>.
Si elle n'est pas spécifiée, <application>MEncoder</application> utilisera 0: fast bilinear.
</para>

<para>
Utilisation:
<screen>
mencoder <replaceable>entree.mpg</replaceable> -ovc lavc -lavcopts vcodec=mpeg4 -vf scale=640:480 -o <replaceable>sortie.avi</replaceable>
</screen>
</para>
</sect1>


<sect1 id="menc-feat-streamcopy">
<title>Copie de flux</title>

<para>
<application>MEncoder</application> peut gérer les flux entrant de deux façons: les
<emphasis role="bold">encoder</emphasis> ou les <emphasis role="bold">copier</emphasis>
Cette section parle de la <emphasis role="bold">copie</emphasis>.
</para>

<itemizedlist>
<listitem><para>
  <emphasis role="bold">Flux vidéo</emphasis> (option <option>-ovc copy</option>):
  on peut faire des choses sympa :) comme, placer (pas convertir) de la vidéo FLI
  ou VIVO ou MPEG1 dans un fichier AVI ! Bien sûr seul <application>MPlayer</application>
  peut lire de tels fichiers :) et ça n'a probablement pas de valeur réelle du tout.
  Concrètement: copier des flux vidéo peut être utile par exemple quand seul le flux
  audio doit être encodé (comme du PCM non-compressé en MP3).
  </para></listitem>
<listitem><para>
  <emphasis role="bold">Flux audio</emphasis> (option <option>-oac copy</option>):
  très simple. Il est possible de prendre un fichier audio externe (MP3, Vorbis) et
  de le muxer dans le flux sortant. Utilisez l'option
  <option>-audiofile <replaceable>nomfichier</replaceable></option> pour cela.
  </para></listitem>
</itemizedlist>
</sect1>


<sect1 id="menc-feat-fix-avi">
<title>Réparer les fichiers AVIs ayant un index défectueux</title>

<para>
Facile. Nous copions simplement les flux vidéo et audio, et <application>MEncoder</application>
génère l'index. Bien sûr cela ne peut pas réparer les bogues possibles dans les flux
vidéo et/ou audio. Il répare également les fichiers avec un entrelacement endommagé,
ainsi l'option <option>-ni</option> ne sera plus requise.
</para>

<para>
Command:
<screen>
mencoder -idx <replaceable>entree.avi</replaceable> -ovc copy -oac copy -o <replaceable>sortie.avi</replaceable><!--
--></screen>
</para>


<sect2 id="menc-feat-appending">
<title>Assembler plusieurs fichiers AVI</title>

<para>
Un effet secondaire de la fonction de réparation d'AVI permet à MEncoder d'assembler 2
(ou plus) fichiers AVI:
</para>

<para>
Commande:
<screen>cat 1.avi 2.avi | mencoder -noidx -ovc copy -oac copy -o <replaceable>sortie.avi</replaceable> -</screen>
</para>

<note><para>
Cela suppose que <filename>1.avi</filename> et <filename>2.avi</filename> utilisent les
mêmes codecs, résolution, débit, etc. et qu'au moins <filename>1.avi</filename>
ne soit pas endommagé. Vous pouvez avoir besoin de réparer vos fichiers AVI d'entrée
d'abord, comme décrit <link linkend="menc-feat-fix-avi">çi-dessus</link>.
</para></note>
</sect2>
</sect1>

<sect1 id="menc-feat-enc-libavcodec">
<title>Encodage avec la famille de codecs <systemitem class="library">libavcodec</systemitem></title>

<para>
<link linkend="ffmpeg"><systemitem class="library">libavcodec</systemitem></link> permet un encodage simple dans de nombreux formats audio et vidéo intéressants. 
Vous pouvez encoder avec les codecs suivants (plus ou moins à jour):

<informaltable frame="all">
<tgroup cols="2">
<thead>
<row><entry>Nom codec</entry><entry>Description</entry></row>
</thead>
<tbody>
<row><entry>mjpeg</entry><entry>
   Motion JPEG
  </entry></row>
<row><entry>ljpeg</entry><entry>
   Lossless JPEG (sans perte)
  </entry></row>
<row><entry>h263</entry><entry>
  H263
  </entry></row>
<row><entry>h263p</entry><entry>
  H263 Plus
  </entry></row>
<row><entry>mpeg4</entry><entry>
  standard MPEG-4 ISO (compatible DivX 5, XVID)
  </entry></row>
<row><entry>msmpeg4</entry><entry>
  variante pré-standard MPEG-4 de MS, v3 (alias DivX3)
  </entry></row>
<row><entry>msmpeg4v2</entry><entry>
  pré-standard MPEG-4 par MS, v2 (utilisé dans les anciens fichiers asf)
  </entry></row>
  <row><entry>wmv1</entry><entry>
  Windows Media Video, version 1 (alias WMV7)
  </entry></row>
<row><entry>wmv2</entry><entry>
  Windows Media Video, version 2 (alias WMV8)
  </entry></row>
<row><entry>rv10</entry><entry>
  un vieux codec RealVideo
  </entry></row>
<row><entry>mpeg1video</entry><entry>
  video MPEG1
  </entry></row>
<row><entry>mpeg2video</entry><entry>
  video MPEG2
  </entry></row>
<row><entry>huffyuv</entry><entry>
  compression sans perte
  </entry></row>
<row><entry>asv1</entry><entry>
  ASUS Video v1
  </entry></row>
<row><entry>asv2</entry><entry>
  ASUS Video v2
  </entry></row>
<row><entry>ffv1</entry><entry>
  codec vidéo sans perte de FFmpeg
  </entry></row>
</tbody>
</tgroup>
</informaltable>

La première colonne contient le nom du codec qui devrait être passé après la config
<literal>vcodec</literal>, comme: <option>-lavcopts vcodec=msmpeg4</option>
</para>

<informalexample>
<para>
Un exemple, avec compression MJPEG:
<screen>mencoder dvd://2 -o <replaceable>titre2.avi</replaceable> -ovc lavc -lavcopts vcodec=mjpeg -oac copy</screen>
</para>
</informalexample>
</sect1>


<sect1 id="menc-feat-enc-images">
<title>Encodage à partir de multiples fichiers image (JPEGs, PNGs ou TGAs)</title>

<para>
<application>MEncoder</application> est capable de créer des fichiers à partir de un
ou plusieurs fichiers JPEG, PNG ou TGA. Avec une simple copie de trame il peut créer
des fichiers MJPEG (Motion JPEG), MPNG (Motion PNG) ou MTGA (Motion TGA).
</para>

<orderedlist>
<title>Explication du processus:</title>
<listitem><para>
  <application>MEncoder</application> <emphasis>décode</emphasis> le(s) image(s)
  d'origine avec <systemitem class="library">libjpeg</systemitem> (pour décoder
  des PNGs, il utilisera <systemitem class="library">libpng</systemitem>).
  </para></listitem>
<listitem><para>
  <application>MEncoder</application> envoie alors l'image décodée au compresseur
  vidéo choisi (DivX4, XviD, ffmpeg msmpeg4, etc.).
  </para></listitem>
</orderedlist>

<formalpara>
<title>Exemples</title>
<para>
Une explication de l'option <option>-mf</option> peut être trouvée dans la page de man.

<informalexample>
<para>
Créer un fichier DivX4 à partir de tous les fichiers JPEG du rép courant:
<screen>
mencoder -mf on:w=800:h=600:fps=25 -ovc divx4 -o <replaceable>sortie.avi</replaceable> \*.jpg<!--
--></screen>
</para>
</informalexample>

<informalexample>
<para>
Créer un fichier DivX4 à partir de quelques fichiers JPEG du rép courant:
<screen>
mencoder -mf on:w=800:h=600:fps=25 -ovc divx4 -o <replaceable>sortie.avi</replaceable> trame001.jpg,trame002.jpg <!--
--></screen>
</para>
</informalexample>

<informalexample>
<para>
Créer un fichier Motion JPEG (MJPEG) à partir de tous les fichiers JPEG du rép courant:
<screen>
mencoder -mf on:w=800:h=600:fps=25 -ovc copy -o <replaceable>sortie.avi</replaceable> \*.jpg<!--
--></screen>
</para>
</informalexample>

<informalexample>
<para>
Créer un fichier non-compressé à partir de tous les fichiers PNG du rép courant:
<screen>
mencoder -mf on:w=800:h=600:fps=25:type=png -ovc raw -o <replaceable>sortie.avi</replaceable> \*.png<!--
--></screen>
</para>
</informalexample>

<note><para>
La largeur doit être un entier multiple de 4, c'est une limitation du format AVI RGB brut.
</para></note>

<informalexample>
<para>
Créer un fichier Motion PNG (MPNG) à partir de tous les fichiers PNG du rép courant:
<screen>
mencoder -mf on:w=800:h=600:fps=25:type=png -ovc copy -o <replaceable>sortie.avi</replaceable> \*.png<!--
--></screen>
</para>
</informalexample>

<informalexample>
<para>
Créer un fichier Motion TGA (MTGA) à partir de tous les fichiers TGA du rép courant:
<screen>
mencoder -mf on:w=800:h=600:fps=25:type=tga -ovc copy -o <replaceable>sortie.avi</replaceable> \*.tga<!--
--></screen>
</para>
</informalexample>

</para>
</formalpara>
</sect1>


<sect1 id="menc-feat-extractsub">
<title>Extraction des sous-titres DVD dans un fichier Vobsub</title>

<para>
<application>MEncoder</application> est capable d'extraire les sous-titres d'un DVD
dans des fichiers au format VobSub. Ils consistent en une paire de fichiers terminant
par <filename>.idx</filename> et <filename>.sub</filename> et sont généralement compressés
dans une seule archive <filename>.rar</filename>. <application>MPlayer</application>
peut les lire avec les options <option>-vobsub</option> et <option>-vobsubid</option>.
</para>

<para>
Vous spécifiez le nom de base (c-a-d sans extension <filename>.idx</filename> ou
<filename>.sub</filename>) des fichiers de sortie avec <option>-vobsubout</option>
et l'index pour ces sous-titres dans le fichier final avec <option>-vobsuboutindex</option>.
</para>

<para>
Si l'entrée n'est pas un DVD vous pouvez utiliser <option>-ifo</option> pour indiquer le
fichier <filename>.ifo</filename> requis pour construire le fichier <filename>.idx</filename> final.
</para>

<para>
Si l'entrée n'est pas un DVD et que vous n'avez pas de fichier <filename>.ifo</filename>
vous aurez besoin d'utiliser l'option <option>-vobsubid</option> pour lui permettre de
savoir quel id langue placer dans le fichier <filename>.idx</filename>.
</para>

<para>
Chaque étape ajoutera les sous-titres actifs dans les fichiers <filename>.idx</filename>
et <filename>.sub</filename> déjà existants. Vous devrez donc les enlever avant de commencer.
</para>

<example>
<title>Copier deux sous-titres d'un DVD pendant l'encodage 3-passes</title>
<screen>
rm <replaceable>soustitres.idx</replaceable> <replaceable>soustitres.sub</replaceable>
mencoder dvd://1 -vobsubout <replaceable>soustitres</replaceable> -vobsuboutindex 0 -sid 2 -o frameno.avi -ovc frameno
mencoder dvd://1 -oac copy -ovc divx4 -pass 1
mencoder dvd://1 -oac copy -ovc divx4 -pass 2 -vobsubout <replaceable>soustitres</replaceable> -vobsuboutindex 1 -sid 5<!--
--></screen>
</example>

<example>
<title>Copier les sous-titres français depuis un fichier MPEG</title>
<screen>
rm soustitres.idx soustitres.sub
mencoder <replaceable>film.mpg</replaceable> -ifo <replaceable>film.ifo</replaceable> -vobsubout soustitres -vobsuboutindex 0 -vobsuboutid fr -sid 1<!--
--></screen>
</example>

</sect1>

<sect1 id="aspect">
<title>Préserver l'aspect ratio</title>
<para>
Les fichiers des DVDs et des SVCDs (c-a-d MPEG1/2) contiennent une valeur d'aspect
ratio, qui décrit comment le lecteur devrait dimensionner le flux vidéo, pour que les
humains n'aient pas des "têtes d'oeuf" (ex. 480x480 + 4:3 = 640x480). De toute façon,
quand vous encodez un fichier AVI (DivX), vous devez être conscients que les entêtes
AVI ne stockent pas cette valeur. Redimensionner le film est dégouttant et coûteux en
temps, il doit y avoir une meilleur solution !
</para>

<para>Il y en a une.</para>

<para>
MPEG4 a une fonction unique: le flux vidéo peut contenir l'aspect ratio requis. Oui,
tout comme les fichiers MPEG1/2 (DVD, SVCD). Malheureusement, il n'y a
<emphasis role="bold">pas</emphasis> de lecteurs vidéo au dehors qui supportent cet
attribut. Excepté <application>MPlayer</application>.
</para>

<para>
Cette fonction ne peut être utilisé qu'avec le codec <systemitem>mpeg4</systemitem> de
<emphasis role="bold"><systemitem class="library">libavcodec</systemitem></emphasis>. Gardez à l'esprit: bien que
<application>MPlayer</application> lise correctement le fichier créé, les autres lecteurs
utiliseront un mauvais aspect ratio.
</para>

<para>
Vous devriez sérieusement couper les bandes noires au dessus et en dessous de l'image.
Voir la page de man pour l'utilisation des filtres <systemitem>cropdetect</systemitem>
et <systemitem>crop</systemitem>.
</para>

<formalpara>
<title>Utilisation</title>
<para>
<screen>mencoder <replaceable>echantillon-svcd.mpg</replaceable> -ovc lavc -lavcopts vcodec=mpeg4:autoaspect -vf
crop=714:548:0:14 -oac copy -o <replaceable>sortie.avi</replaceable></screen>
</para>
</formalpara>
</sect1>

<sect1 id="custommatrices"><title>Inter/intra matrices personnalisées</title>

<para>
Avec cette fonction de <link linkend="ffmpeg"><systemitem class="library">libavcodec</systemitem></link> vous pouvez
initialiser des matrices personnalisées inter (I-frames/trames-clé) et intra
(P-frames/trames prévues). Elle est supportée par de nombreux codecs:
<systemitem>mpeg1video</systemitem> et <systemitem>mpeg2video</systemitem>
fonctionnent.
</para>

<para>
Une utilisation typique de cette fonction est d'initialiser les matrices
recommandées par les spécifications <ulink url="http://www.kvcd.net/">KVCD</ulink>.
</para>

<para>
La <emphasis role="bold">matrice de quantisation &quot;Notch&quot; de KVCD:</emphasis>
</para>

<para>
Intra:
<screen>
 8  9 12 22 26 27 29 34
 9 10 14 26 27 29 34 37
12 14 18 27 29 34 37 38
22 26 27 31 36 37 38 40
26 27 29 36 39 38 40 48
27 29 34 37 38 40 48 58
29 34 37 38 40 48 58 69
34 37 38 40 48 58 69 79
</screen>

Inter:
<screen>
16 18 20 22 24 26 28 30
18 20 22 24 26 28 30 32
20 22 24 26 28 30 32 34
22 24 26 30 32 32 34 36
24 26 28 32 34 34 36 38
26 28 30 32 34 36 38 40
28 30 32 34 36 38 42 42
30 32 34 36 38 40 42 44
</screen>
</para>

<para>
Utilisation:
<screen>
$ mencoder <replaceable>entree.avi</replaceable> -o <replaceable>sortie.avi</replaceable> -oac copy -ovc lavc
-lavcopts inter_matrix=...:intra_matrix=...
</screen>
</para>

<para>
<screen>
$ mencoder <replaceable>entree.avi</replaceable> -ovc lavc -lavcopts
vcodec=mpeg2video:intra_matrix=8,9,12,22,26,27,29,34,9,10,14,26,27,29,34,37,
12,14,18,27,29,34,37,38,22,26,27,31,36,37,38,40,26,27,29,36,39,38,40,48,27,
29,34,37,38,40,48,58,29,34,37,38,40,48,58,69,34,37,38,40,48,58,69,79
:inter_matrix=16,18,20,22,24,26,28,30,18,20,22,24,26,28,30,32,20,22,24,26,
28,30,32,34,22,24,26,30,32,32,34,36,24,26,28,32,34,34,36,38,26,28,30,32,34,
36,38,40,28,30,32,34,36,38,42,42,30,32,34,36,38,40,42,44 -oac copy -o
<replaceable>svcd.mpg</replaceable>
</screen>
</para>
</sect1>

<sect1 id="menc-feat-dvd-mpeg4">
<title>Créer un rip MPEG4 (&quot;DivX&quot;) de haute qualité à partir d'un DVD</title>

<para>
  Ripper un titre DVD dans un fichier MPEG4 (DivX) de qualité maximale implique de
  nombreuses considérations. Vous trouverez plus bas un exemple du processus quand il
  n'y a pas de taille de fichier particulière à atteindre (à part peut être faire tenir
  le résultat dans 2 Go). <systemitem class="library">libavcodec</systemitem>
  sera utilisé pour la vidéo, et l'audio sera copié sans aucun changement.
</para>

<sect2 id="menc-feat-dvd-mpeg4-crop">
<title>Découpage</title>
<para>
  Lisez le DVD et appliquez le filtre de détection de découpage
  (<option>-vf cropdetect</option>) dessus. Cela affiche un rectangle de découpage
  à utiliser pour l'encodage. Les raisons du découpage sont que beaucoup de films ne sont
  pas dans un aspect ratio standard (16/9 ou 4/3), ou, pour n'importe quelle raison,
  l'image ne tient pas dans la trame. Vous pouvez aussi les bandes noires quand vous rippez.
  Cela améliore la qualité du rip car le bord dur des bandes noires gaspille beaucoup de
  bits. Un aspect courant est 2.35, ce qui corresponds au cinescope. La plupart des gros
  <emphasis>blockbusters</emphasis> ont cet aspect ratio.
</para>
</sect2>

<sect2 id="menc-feat-dvd-mpeg4-quality">
<title>Niveau de qualité</title>
<para>
  Ensuite vous devez choisir le niveau de qualité désiré. Quand il n'y a pas besoin
  de garder une certaine taille pour tenir sur des CDs ou autres, en utilisant une
  quantisation constante, c-a-d. une qualité constante, est un bon choix. De cette
  façon chaque trame reçoit autant de bits dont elle a besoin pour maintenir la
  qualité au niveau désiré, mais les multiples passes d'encodage ne sont pas requises.
  Avec <systemitem class="library">libavcodec</systemitem>, vous pouvez obtenir une
  qualité constante en utilisant
  <option>-lavcopts vqscale=<replaceable>N</replaceable></option>.
  <option>vqscale=3</option> devrait vous donner un fichier de taille inférieure à 2Go,
  suivant la longueur du film et le bruit de la vidéo (plus il y a de bruit, plus il est
  difficile de comresser.)
</para></sect2>

<sect2 id="menc-feat-dvd-mpeg4-2gb">
<title>Fichiers de plus de 2 Go</title>
<para>
  Si le fichier provenant d'un encodage à qualité constante fait plus de 2 Go,
  vous devrez créer un index pour pouvoir le voir correctement.
  Vous devez soit

<itemizedlist>
<listitem><para>
  lire le film avec <option>-forceidx</option> pour créer un index à la volée,
  </para></listitem>
<listitem><para>
  utiliser <option>-saveidx</option> pour écrire l'index dans un fichier une fois pour
  toute et <option>-loadidx</option> pour l'utiliser pour la lecture de ce fichier.
  </para></listitem>
</itemizedlist>

  Si cela vous ennuie, vous préférez peut-être garder la taille du fichier inférieure à 2 Go.
</para>

<para>
  Il y a trois façons d'éviter cela. Vous pouvez essayer de réencoder en utilisant
  <option>vqscale=4</option> et voir si la taille et la qualité sont toutes deux
  acceptables. Vous pouvez aussi utiliser
  <link linkend="menc-feat-divx4">l'encodage 2 passes</link>.
  Puisque vous copiez la piste audio telle quelle et que donc vous connaissez
  son débit, et que vous connaissez la durée du film, vous pouvez calculer
  le débit requis à passer à l'option
  <option>-lavcopts vbitrate=<replaceable>bitrate</replaceable></option>
  en utilisant <link linkend="menc-feat-divx4">l'encodage 3 passes</link>.
</para>

<para>
  La troisième et peut-être la meilleure option serait de légèrement diminuer
  la résolution. Le 'softening' léger et la perte de détails est visuellement
  préférable à la pixélisation et autres artéfacts de la compression MPEG.
  Diminuer la résolution réduit le bruit de l'image, ce qui est bénéfique, car
  le bruit est difficile à compresser.
</para></sect2>

<sect2 id="menc-feat-dvd-mpeg4-deinterlacing">
<title>Désentrelacement</title>
<para>
  Si le film est entrelaçé, vous pouvez le désentrelaçer pendant le rip.
  Le faire à cette étape est discutable. L'avantage est que le désentrelaçement
  pendant la conversion en MPEG4 rends la compression meilleure, et le visionnage
  plus facile et moins gourmand en CPU sur des moniteurs d'ordinateur car aucun
  désentrelacement n'est requis.
</para>

<para>
  Savoir si on désentrelace durant l'étape du rip dépends du DVD. Si le DVD est
  un film, qui a été tourné en 24 fps, vous pouvez très bien désentrelacer pendant
  le rip. Si, par contre, la vidéo originale est en 50/60 fps, la convertir en
  vidéo 23.976/25 fps désentrelaçé perdra des informations. Si vous décidez tout de même de désentrelacer, vous pouvez essayer avec différents filtres de désentrelacement, voir
  <ulink url="http://www.wieser-web.de/MPlayer/">http://www.wieser-web.de/MPlayer/</ulink>
  pour des exemples. Un bon point de départ est <option>-vf pp=fd</option>.
</para>

<para>
  Si vous découpez et désentrelacez en même temps, désentrelacez
  <emphasis>avant</emphasis> de découper. En fait, cela n'est pas nécessaire
  si l'offset de découpage vertical est un multiple de 2 pixels. De toute façon
  avec certains autres filtres comme le dering vous devez toujours découper en dernier,
  donc c'est une bonne habitude à prendre de mettre le filtre de découpage en dernier.
</para></sect2>

<sect2 id="menc-feat-dvd-mpeg4-telecine">
<title>Telecine inversé</title>
<para>
  Si vous rippez un DVD PAL, qui est en 25 fps, vous n'avez pas à vous soucier
  des fps. Utilisez juste 25 fps. D'un autre coté les DVDs NTSC sont en
  29.97 fps (souvent arrondi à 30 fps, mais ce n'est pas la vitesse réelle).
  Si le film à été enregistré pour la TV, vous n'avez encore une fois pas à
  toucher les fps. Mais si le film a été enregistré sur pellicule, et donc à
  (exactement) 24 fps, il a été converti en 29.97 fps pour le presser sur DVD.
  La conversion où 12 champs sont ajoutés toutes les 24 trames est appelée telecine.
  Pour plus d'infos sur telecine, faites
  <ulink url="http://www.google.com/search?q=telecine+field+23.976">
  une recherche Google sur &quot;telecine field 23.976&quot;</ulink>.
</para>

<para>
  Au cas où vous ayez un DVD teleciné, vous pouvez inverser le telecine, c-a-d.
  convertir le film en 23.976 fps (29.97*4/5).
  Sinon les panoramiques seront sales et horribles. Vous pouvez utiliser
  <option>-ofps 23.976</option> pour cela. Tous ce qui est montré au cinéma
  est enregistré sur pellicule et nécessite le telecine inverse, les programmes TV
  n'en ont pas besoin.
</para></sect2>

<sect2 id="menc-feat-dvd-mpeg4-scaling">
<title>Redimensionnement et aspect ratio</title>
<para>
  Pour une meilleur qualité, ne redimensionnez pas les films pendant le rip.
  Le redimensionnement produit des artéfacts et un fichier plus gros. Les
  pixels des films DVD ne sont pas carrés, donc ces films incluent des infos
  sur l'aspect ratio correct. Il est possible d'insérer l'aspect ratio dans
  l'entête MPEG4 du fichier de sortie. La plupart des lecteurs vidéos ignorent
  cette info, mais <application>MPlayer</application> l'utilise. Donc si vous
  comptez utiliser uniquement <application>MPlayer</application> pour lire le fichier
  rippé, vous n'avez pas besoin de redimensionner le film, passez juste
  <option>-lavcopts autoaspect</option> à <application>MEncoder</application>
  et tout sera fait automatiquement.
  Si vous devez redimensionner le film, assurez-vous de garder une taille correcte,
  surtout si vous découpez.
</para>
</sect2>

<sect2 id="menc-feat-dvd-mpeg4-summary">
<title>Résumons</title>
<para>
  Avec tout ce qui a été mentioné plus haut, une commande d'encodage convenable pourrait
  être

  <screen>
mencoder dvd://1 -aid 128 -oac copy -ovc lavc -lavcopts vcodec=mpeg4:vqscale=3:vhq:v4mv:trell:autoaspect \
  -ofps 23.976 -vf crop=720:364:0:56 -o Harry_Potter_2.avi
  </screen>

  Ici <option>dvd://1</option> indique le titre DVD à ripper. l'option
  <option>-aid 128</option> dit d'utiliser la piste audio 128, et
  <option>-oac copy</option> de la copier telle quelle. Vous devrez utiliser
  <application>MPlayer</application> pour trouver les bonnes valeurs pour ces options.
</para>

<para>
  Les options <option>vhq:v4mv:trell</option> pour
  <option>-lavcopts</option> améliorent la qualité vis-à-vis du débit, mais rends l'encodage
  plus long. Surtout <option>trell</option> qui ralentit l'encodage mais augmente visiblement
  la qualité. Si vous voulez désentrelacer, ajoutez un filtre <option>pp</option> à
  <option>-vf</option>, par exemple
  <option>-vf pp=fd,crop=720:364:0:56</option> (dans cet ordre). Si vous n'avez pas besoin
  de telecine inverse, enlevez <option>-ofps 23.976</option>.
</para>
</sect2>

</sect1>

<sect1 id="menc-feat-telecine">
<title>Comment gérer le téléciné et le désentrelacement avec les DVDs NTSC</title>

<formalpara>
<title>Introduction</title>
<para>
  Je vous suggère de visiter cette page si vous ne comprenez pas la plupart
  de ce qui est écrit dans ce document:
  <ulink url="http://www.divx.com/support/guides/guide.php?gid=10"/>
  Cette adresse mène à une description compréhensible et simple de ce qu'est le
  téléciné.
</para></formalpara>

<para>
  Pour des raisons techniques imputables aux limitations des premiers postes
  de télévision, toute vidéo destinée à être joué sur un poste de télévision NTSC
  doit être en 59.94 champs par seconde. les téléfilms et les émissions sont souvent
  filmés directement en 59.94 champs par seconde, alors que la majorité du
  cinéma est filmé à 24 ou 23.976 trames par seconde. Quand le DVD d'un film est
  masterisé, la vidéo est convertie pour la télévision en utilisant un procédé appelé
  téléciné.
</para>

<para>
  Sur un DVD, la vidéo n'est en fait jamais stockée en 59.94 champs par seconde.
  Pour une vidéo qui était à l'origine en 59.94, chaque paire de champs est combinée
  pour former une trame, donnant ainsi 29.97 trames par seconde. Les lecteurs DVD
  lisent ensuite un flag contenu dans le flux vidéo pour déterminer si les lignes paires
  -ou impaires- doivent former le premier champ.
</para>

<para>
  En général, le contenu à 23.976 trames par seconde reste tel quel quand il est
  encodé pour un DVD, et le lecteur DVD doit &quot;téléciner&quot; à la volée.
  Parfois, cependant, la vidéo est téléciné <emphasis>avant</emphasis> d'être
  stockée sur le DVD; même si elle était à l'origine en 23.976 trames par seconde,
  elle passe en 59.94 champs par seconde, et est stockée sur le disque en 29.97
  trames par seconde.
</para>

<para>
  Quand on regarde des trames individuelles formées à partir d'une vidéo en
  59.94 champs par seconde, téléciné ou similaire, l'entrelacement est clairement
  visible partout où il y a du mouvement, car un champ (disons, les lignes paires)
  représente un temps 1/59.94 de seconde plus loin que le suivant. La lecture de
  vidéo entrelaçée sur un ordinateur est horrible parce que le moniteur a une
  résolution supérieure et parce que la vidéo est affichée trame-après-trame plutôt
  que champ-après-champ. 
</para>

<para>
Notes:
</para>
<itemizedlist>
<listitem><para>
  Cette section ne s'applique qu'aux DVDs NTSC, et non PAL.
  </para></listitem>
<listitem><para>
  Les lignes d'exemple de <application>MEncoder</application> utilisées dans
  ce document ne sont <emphasis role="bold">pas</emphasis> destinées à un
  usage tel-quel. Ce sont juste le minimum requis pour encoder des vidéos de
  cette catégorie. Comment faire des bons rips DVD ou paramétrer 
  <systemitem class="library">libavcodec</systemitem> pour la meilleur qualité
  possible est en dehors du cadre de ce document.
  </para></listitem>
<listitem><para>
  Il y a deux notes de bas de page spécifiques à ce guide, notée ainsi:
  <link linkend="menc-feat-telecine-footnotes">[1]</link>
  </para></listitem>
</itemizedlist>

<sect2 id="menc-feat-telecine-ident">
<title>Comment trouver quel type de vidéo vous avez</title>

<sect3 id="menc-feat-telecine-ident-progressive">
<title>Progressive</title>
<para>
  La vidéo progressive est filmé à l'origine en 23.976 fps, et stockée sur le DVD
  sans modification.
</para>

<para>
  Quand vous jouez un DVD progressif avec <application>MPlayer</application>,
  <application>MPlayer</application> affiche la ligne suivante dès le début de la
  lecture du film:

  <screen> demux_mpg: 24fps progressive NTSC content detected, switching framerate.</screen>

  À partir de maintenant, demux_mpg ne devrait jamais dire qu'il trouve du
  &quot;30fps NTSC content.&quot;
</para>

<para>
  Quand vous regardez une vidéo progressive, vous ne devriez jamais voir
  l'entrelacement. Attention, cependant, car parfois il y a un petit peu de téléciné
  mélangé, où vous ne vous y attendriez pas. J'ai rencontré des DVDs de show
  TV qui ont une seconde de téléciné à chaque changement de scène, ou dans des
  endroits apparemment aléatoires. J'ai vu une fois un DVD qui était en progressive
  dans la première moitié, et téléciné dans la seconde. Si vous voulez être
  <emphasis>vraiment</emphasis> certain, vous pouvez scanner tout le film:

  <screen>mplayer dvd://1 -nosound -vo null -benchmark</screen>

  L'utilisation de <option>-benchmark</option> indique à
  <application>MPlayer</application> de jouer le film aussi rapidement qu'il le
  peut; cependant, suivant votre matériel, cela peut prendre un certain temps.
  Chaque fois que demux_mpg signale un changement de débit, la ligne suivante 
  indiquera l'heure à laquelle le changement s'est produit.
</para>

<para>
  Parfois la vidéo progressive est appelé &quot;soft-telecine&quot;
  parce qu'elle est destinée à être téléciné par le lecteur DVD.
</para>
</sect3>

<sect3 id="menc-feat-telecine-ident-telecined">
<title>Télécinée</title>
<para>
  La vidéo télécinée a été filmée en 23.976, mais a été téléciné
  <emphasis>avant</emphasis> d'être gravée sur DVD.
</para>

<para>
  <application>MPlayer</application> ne signale pas (encore) les
  changements de débit quand il joue de la vidéo téléciné.
</para>

<para>
  En regardant de la vidéo téléciné, vous vourez des artéfacts d'entrelacement
  qui semblent &quot;clignoter&quot;: ils apparaissent et disparaissent rapidement.
  Vous pouvez les regarder plus attentivement avec par exemple
  <orderedlist>
  <listitem>
    <screen>mplayer dvd://1 -speed 0.1</screen>
    </listitem>
  <listitem><para>
    Sauter à une partie avec du mouvement.
    </para></listitem>
  <listitem><para>
    En regardant les trames entrelacées et progressives. Si le motif que vous
    voyez est PPPII,PPPII,PPPII,... alors la vidéo est téléciné. Si vous voyez
    un autre motif, alors la vidéo a été téléciné en utiliisant une méthode non-standard
    et <application>MEncoder</application> ne peut pas la convertir en
    progressive sans perte. Si vous ne voyez aucun motif, c'est certainement que la
    vidéo est entrelaçé.
    </para></listitem>
  </orderedlist>
</para>

<para>
  Parfois la vidéo téléciné est appelé &quot;hard-telecine&quot;.
</para>
</sect3>

<sect3 id="menc-feat-telecine-ident-interlaced">
<title>Entrelaçée</title>
<para>
  La vidéo entrelaçée a été filmé en 59.94 champs par seconde, et stockée sur DVD
  en 29.97 trames par seconde. L'entrelacement est le résultat de la combinaison
  des paires de champs dans des trames, car dans chaque trame, chaque champ
  est séparé du suivant par 1/59.94 secondes.
</para>

<para>
  Comme pour la vidéo téléciné, <application>MPlayer</application> ne 
  devrait pas encore signaler les changements de débit pendant la lecture de 
  contenu entrelaçé.
</para>

<para>
  Quand vous regardez de près une vidéo entrelaçée avec <option>-speed 0.1</option>, vous voyez que chaque trame est entrelaçée.
</para>
</sect3>

<sect3 id="menc-feat-telecine-ident-mixedpt">
<title>Progressive et télécinée mélangées</title>
<para>
  Toute la vidéo &quot;progressive et téléciné mélangées&quot; était à l'origine
  en 23.976 trames par seconde, mais certaines parties ont fini en téléciné.
</para>

<para>
  Quand <application>MPlayer</application> joue cette catégorie, il oscillera (de
  manière répetée) entre &quot;30fps NTSC&quot; et &quot;24fps progressive NTSC&quot;. Regardez la sortie texte de <application>MPlayer</application>
  pour voir ses messages.
</para>

<para>
  Vous devriez regarder les sections &quot;30fps NTSC&quot; pour vérifier que
  c'est effectivement du téléciné, et pas juste de l'entrelaçé.
</para>
</sect3>

<sect3 id="menc-feat-telecine-ident-mixedpi">
<title>Progressive et entrelacée mélangées</title>
<para>
  Dans le contenu &quot;progressive et entrelaçée&quot;, la vidéo progressive
  et entrelaçée ont été entremélées.
</para>

<para>
  Cette catégorie ressemble tout à fait à &quot;progressive et télécinée mélangées&quot;, jusqu'à ce que vous examiniez les sections 30fps et voyez qu'elles
  n'ont pas de motif de téléciné.
</para>
</sect3>

</sect2>

<sect2 id="menc-feat-telecine-encode">
<title>Comment encoder chaque catégorie</title>
<para>
  Comme mentionné au début, les lignes d'exemple de  <application>MEncoder</application> ne sont <emphasis role="bold">pas</emphasis> destinées a être utilisé directement; elles démontrent juste les paramètres minimum pour encoder chaque catégorie.
</para>

<sect3 id="menc-feat-telecine-encode-progressive">
<title>Progressive</title>
<para>
  La vidéo progressive ne requiert aucun filtrage spécial pour l'encodage. Le seul
  paramètre que vous devez utiliser est
  <option>-ofps 23.976</option>. Sinon, <application>MEncoder</application>
  essaira d'encoder en 29.97 fps et dupliquera des trames.
</para>

<para>
  <screen>mencoder dvd://1 -nosound -ovc lavc -ofps 23.976</screen>
</para>
</sect3>

<sect3 id="menc-feat-telecine-encode-telecined">
<title>Télécinée</title>
<para>
  Le téléciné peut être inversé pour retrouver le contenu original en 23.976,
  en utilisant un procédé appelé inverse-téléciné.
  <application>MPlayer</application> contient deux filtres pour accomplir cela:
  <option>detc</option> et <option>ivtc</option>. Vous pouvez lire la page de man
  pour voir leur différences, mais pour les DVDs je n'ai jamais eu de problèmes
  avec <option>ivtc</option>. Notez que vous devriez 
  <emphasis role="bold">toujours</emphasis> appliquer l'inverse-telecine avant
  tout redimensionnement; à mois que vous ne sachiez vraiment ce que vous
  faites, appliquez l'inverse-téléciné également avant tout découpage
  <link linkend="menc-feat-telecine-footnotes">[1]</link>. De nouveau,
  <option>-ofps 23.976</option> est également requis.
</para>

<para>
  <screen>mencoder dvd://1 -nosound -vf ivtc=1 -ovc lavc -ofps 23.976</screen>
</para>
</sect3>

<sect3 id="menc-feat-telecine-encode-interlaced">
<title>Entrelaçée</title>
<para>
  Dans la plupart des cas, en pratique, il n'est pas possible de retrouver
  une vidéo progressive complète à partir de contenu entrelaçé. La seule
  manière d'y parvenir sans perdre la moitié de la résolution verticale est de
  doubler le débit et d'essayer de &quot;deviner&quot; ce qui est destiné a constituer
  les lignes correspondantes pour chaque champ (cela a des inconvenients - voir
  la méthode 3).
</para>

<orderedlist>
<listitem><para>
  Encodez la vidéo sous forme entrelaçée. Normalement, l'entrelacement entre en
  conflit avec la qualité de compression de l'encodeur, mais
  <systemitem class="library">libavcodec</systemitem> a deux paramètres
  spécifiques pour gérer un peut mieux le stockage de la vidéo entrelaçée:
  <option> ildct</option> et <option>ilme</option>. De plus, 
  utiliser <option>mbd=2</option> est fortement recommandé
  <link linkend="menc-feat-telecine-footnotes">[2] </link> car il encodera les
  macroblocs en tant que non-entrelaçé là où il n'y a pas de mouvement.
  Notez que <option>-ofps</option> n'est PAS requis ici.

  <screen>mencoder dvd://1 -nosound -ovc lavc -lavcopts ildct:ilme:mbd=2</screen>
  </para></listitem>
<listitem><para>  
  Utilisez un filtre de désentrelacement avant l'encodage. Il y a beaucoup de ces filtres
  disponibles au choix, chacun avec ses avantages et ses inconvénients. Consultez
  <option>mplayer -pphelp</option> pour voir ce qui est disponible (recherche sur &quot;deint&quot;), et cherchez sur les
  <ulink url="http://www.mplayerhq.hu/homepage/design6/info.html#mailing_lists">
   listes de diffusion de MPlayer</ulink> pour trouver des discussions à propos des
   divers filtres. De nouveau, le débit ne change pas, donc il n'y a pas de 
  <option>-ofps</option>. De même, le désentrelacement devrait être appliqué
  après le découpage <link linkend="menc-feat-telecine-footnotes">[1]</link> et
  avant le redimensionnement.

  <screen>mencoder dvd://1 -nosound -vf pp=lb -ovc lavc</screen>
  </para></listitem>
<listitem><para>
  Malheureusement, cette option est boguée avec
  <application>MEncoder</application>; elle est destinée a bien fonctionner avec
  <application>MEncoder G2</application>, mais il n'est pas encore là. Vous
  pourrez avoir des plantages. De toute façon, le but de <option> -vf
  tfields</option> est de créer des trames pleines à partir de chaque champ, ce
  qui aboutit à un débit de 59.94. L'avantage de cette approche est qu'aucune donnée
  n'est perdue; par contre, puisque chaque trame provient d'un seul champ, les lignes
  manquantes doivent être remplies d'une manière ou d'une autre. Il n'y a pas de 
  vraiment de bonne méthode pour générer les données manquantes, et donc le
  résultat sera similaire à celui obtenu en utilisant certains filtres de désentrelacement.
  Générer les lignes manquantes créé d'autres problèmes, également, simplement
  parce que la quantité de données double. Donc, un débit d'encodage supérieur
  est requis pour maintenir la qualité, et plus de puissance CPU est utilisé pour 
  l'encodage et le décodage. tflields a de nombreuses options différentes pour
  la création des lignes manquantes de chaque trame. Si vous utilisez cette méthode,
  alors référez vous à la page de man, et choisissez l'option qui rends le mieux avec
  votre matériel. Notez qu'en utilisant <option>tfields</option> vous
   <emphasis role="bold">devez</emphasis> spécifier <option>-fps</option> et <option>-ofps</option> en indiquant un débit double de celui de la source.

  <screen>mencoder dvd://1 -nosound -vf tfields=2 -ovc lavc -fps 59.94 -ofps 59.94</screen>
  </para></listitem>
<listitem><para>
  Si vous comptez réduire énormément, vous pouvez extraire et encoder 
  uniquement l'un des deux champs. Bien sûr, vous allez perdre la moitié de la
  résolution verticale, mais si vous prévoyez de réduire d'au plus 1/2 de 
  l'original, la perte ne se vera pas trop. Le résultat sera un fichier progressif à
  29.97 trames par seconde. La procédure est d'utiliser
  <option>-vf field</option>, et ensuite couper
  <link linkend="menc-feat-telecine-footnotes">[1]</link> et dimmensionner
  correctement. Rappelez-vous que vous n'avez qu'à ajuster le redimmensionment pour compenser la division par deux de la résolution verticale.
  <screen>mencoder dvd://1 -nosound -vf field=0 -ovc lavc</screen>
  </para></listitem>
</orderedlist>
</sect3>

<sect3 id="menc-feat-telecine-encode-mixedpt">
<title>Progressive et téléciné mélangées</title>
<para>
  De façon à transformer la vidéo progressive et télécinée mélangée en
  vidéo entièrement progressive, l'inverse-telecine doit être appliqué sur les parties
  télécinées. Il y a deux filtres qui accomplissent nativement cette tâche, mais la
  plupart du temps la meilleure solution est d'utiliser deux filtres en conjonction (lire
  la suite pour plus de détails).
</para>

<itemizedlist>
<listitem><para>
  Actuellement la méthode la plus fiable de traiter ce type de vidéo est, plutôt que
  d'appliquer un inverse-téléciné sur les parties télécinées, de téléciner les parties
  non-télécinées et d'ensuite appliquer l'inverse-téléciné sur la vidéo entière.
  Cela vous semble confus ? softpulldown est un filtre qui parcoure une vidéo
  et la rend entièrement télécinée. Si vous faites suivre softpulldown de soit
  <option>detc</option>, soit  <option>ivtc</option>, le résultat final sera
  entièrement progressif. Le découpage et le redimmensionnement devrait être fait
  après les opérations d'inverse-téléciné, et <option> -ofps 23.976</option> est
  requis.

  <screen>mencoder dvd://1 -nosound -vf softpulldown,ivtc=1 -ovc lavc -ofps 23.976</screen>
  </para>
  </listitem>
<listitem><para>
  <option>-vf pullup</option> est conçu pour appliquer un inverse-telecine sur le
  matériel téléciné tout en laissant les données progressives intacts. Pullup ne 
  fonctionne pas vraiment avec l'actuel
  <application>MEncoder</application>, cependant, il est vraiment prévu 
  pour l'utilisation avec <application>MEncoder G2</application> (quand
  celui-ci sera prêt). Il fonctionne bien sans <option>-ofps</option>, mais
  <option>-ofps</option> est requit pour empécher un affichage brouillé. Avec
  <option>-ofps</option>, cela échoue parfois. Le problème provient du 
  comportement de 
  <application>MEncoder</application> qui saute des trames pour maintenir
  la synchronisation entre l'audio et la vidéo: il saute des trames avant de les
  envoyer dans la chaine de filtres, plutôt qu'après. Résultat, <option>pullup</option>
  est parfois privé des données dont il a besoin.
  </para>

  <para>
  Si <application>MEncoder</application> saute trop de trames dans une
  rangée, il vide les tampons de <option>pullup</option> et le conduit à planter.
  </para>

  <para>
  Même si <application>MEncoder</application> ne saute qu'une seule trame,
  <option> pullup</option> ne pourra toujours pas la voir, et finira par opérer sur
  une séquence incorrecte de trames. Même si cela ne provoque pas de plantage,
  <option>pullup</option> ne sera pas capable de prendre les bonnes décisions pour
  ré-assembler les trames progressives, et va soit mal faire correspondre les
  champs, soit sauter plusieurs champs pour compenser.
  </para>
  </listitem>

<listitem><para>
  Je n'ai jamais utilisé <option>-vf filmdint</option> moi-même, mais voici ce qu'en dit
  D Richard Felker III:

  <blockquote><para>C'est bon, mais AMA il essaie de désentrelacer plutôt que
    de faire de l'inverse-téléciné trop souvent (tout comme les lecteurs DVD &amp;
    et les TVs progressives), ce qui donne un scintillement horrible et d'autres artéfacts.
    Si vous voulez l'utiliser, vous devrez au moins passer un peu de temps à régler
    les options et à regarder le résultat pour vous assurer que tout va bien.</para></blockquote>
  </para></listitem>
</itemizedlist>
</sect3>

<sect3 id="menc-feat-telecine-encode-mixedpi">
<title>Progressive et entrelaçée mélangées</title>
<para>
  Il y a deux options pour gérer cette catégorie, chacune d'elle étant un
  compromis. Vous devriez décider suivant la durée/position de chaque type.
</para>

<itemizedlist>
<listitem><para>
  Traitez-la en tant que progressive. Les parties entrelaçées apparaitront
  comme entrelaçées, et certains champs devront être sautés, donnant une
  lecture un peu sacadée. Vous pouvez utiliser un filtre de postprocessing si vous
  le voulez, mais celui-ci pourrait légérement dégrader les parties progressives.
  </para>

  <para>
  Cette option ne devrait vraiment pas être utilisée si vous voulez finalement
  afficher la vidéo sur un périphérique entrelaçé (avec une carte TV, par exemple).
  Si vous avez des trames entrelaçées dans une vidéo de 23.976 trames par
  secondes, elles seront télécinées avec les trames progressives. La moitié des
  &quot;trames&quot; sera affichée durant trois champs (3/59.94 secondes),
  provoquant un effet tremblotant &quot;saut dans le temps&quot; qui rends
  particulièrement mauvais. Si vous essayez cela, vous <emphasis role="bold">devez</emphasis> utiliser un filtre de désentrelacement comme
  <option>lb</option> ou <option>l5</option>.
  </para>

  <para>
  Cela peut être aussi une mauvaise idée pour l'affichage progressif. Des paires
  de champs consécutifs seront sautés, provoquant une discontinuité qui peut
  être plus visible avec la seconde méthode, qui montre certaines trames
  progressives deux fois. La vidéo en 29.97 trames par seconde est déjà un
  peu brouillée car elle devrait être lue en 59.94 champs par seconde, donc les
  trames dupliquées ne se voient pas trop.
  </para>
  
  <para>
  D'un autre coté, il vaut mieux considérer votre contenu et comment vous comptez
  l'afficher. Si votre vidéo est 90% progressive et que vous ne comptez pas l'afficher
  sur une TV, vous devriez préférer une approche progressive. Si c'est seulement
  à moitié progressif, vous voudrez probablement l'encoder comme si elle était
  complétement entrelaçée.
  </para>
  </listitem>
  
<listitem><para>
  Traitez-la comme entrelaçée. Certaines trames des parties progressives
  devront être dupliquées, causant des saccades irrégulières. De nouveau,
  les filtres de désentrelacement peuvent légèrement dégrader les parties 
  progressives.
  </para></listitem>

</itemizedlist>
</sect3>

</sect2>

<sect2 id="menc-feat-telecine-footnotes">
<title>Notes de bas-de-page</title>
<orderedlist>
<listitem><formalpara>
  <title>À propos du découpage:</title>
  <para>
  Les données vidéo des DVDs sont stockées dans un format appelé YUV 4:2:0. 
  Dans la vidéo YUV, luma (&quot;luminosité&quot;) et chroma (&quot;couleur&quot;)
  sont stockés séparemment. Dans une image YUV 4:2:0 il n'y a qu'un pixel chroma
  pour quatre pixels luma, car l'oeil humain est plus sensible à la couleur qu'à la 
  luminosité. Dans une image progressive, chaque carré de quatre pixels luma
  (deux de chaque coté) a un pixel chroma en commun. Vous devez couper l'YUV
  progressive dans une résolution paire, et utiliser des offsets pairs. Par exemple,
  <option>crop=716:380:2:26</option> est correct mais
  <option>crop=716:380:3:26 </option> ne l'est pas.
  </para>
  </formalpara>

  <para>
  Quand vous traitez de l'YUV 4:2:0 entrelaçé, la situation est un peu plus compliquée.
  Au lieu de quatre pixels luma dans une <emphasis>trame</emphasis> partageant
  un pixel chroma, chaque ensemble de quatre pixels luma dans un
  <emphasis>champs</emphasis> partage un pixel chroma. Quand les champs
  sont entrelaçés pour former une trame, chaque scanline est haute de un pixel.
  Maintenant, au lieu d'avoir quatre pixels dans un carré, il y a deux pixels cote-à-cote,
  et les deux autres pixels sont cote-à-cote deux scanlines plus bas. Les deux pixels
  luma des scanlines intérmédiaires proviennent de l'autre champ, et donc partagent
  un pixel chroma différent avec deux pixels luma deux scanlines après. Toute
  cette confusion fait qu'il est nécessaire d'avoir des dimensions de découpage
  et des offsets multiples de quatre. L'horizontal peut rester pair. 
  </para>

  <para>
  Pour la vidéo télécinée, je recommande de découper après le procédé 
  d'inverse-téléciné. Une fois la vidéo en progressive, vous n'aurez plus
  qu'à découper par nombres pairs. Si vous voulez vraiment profiter du léger
  gain de temps qu'offre le découpage en premier, vous devez couper verticalement
  par multiples de quatre ou sinon le fitre d'inverse-téléciné n'aura pas suffisemment
  de données.
  </para>

  <para>
  Pour la vidéo entrelaçée (non télécinée), vous devez toujours découper verticalement
  par multiples de quatre à moins d'utiliser <option>-vf field</option> avant le
  découpage.
  </para>
  </listitem>

<listitem><formalpara>
  <title>À propos des paramètres d'encodage et de la qualité:</title>
  <para>
  Le fait que je recommande <option>mbd=2</option> ici ne signifie pas qu'il doit
  être utilisé ailleurs. Avec <option>trell</option>, <option>mbd=2</option> est une
  des deux options de <systemitem class="library">libavcodec</systemitem> qui
  augmentent le plus la qualité, et vous devriez toujours au moins les utiliser toutes les
  deux à moins que la vitesse d'encodage soit primordiale (par ex. encodage
  temps-réel). Il y a beaucoup d'autres options qui augmentent la qualité (et diminuent
  la vitesse d'encodage) mais c'est en dehors du cadre de ce document.
  </para>
  </formalpara>
  </listitem>

</orderedlist>

</sect2>

</sect1>

</chapter>
