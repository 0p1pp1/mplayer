<?xml version="1.0" encoding="utf-8"?>
<!-- synced with r20442 -->
<!-- Opiekun: Emdej -->
<chapter id="cd-dvd">
<title>UĹźywanie CD/DVD</title>

<sect1 id="drives">
<title>NapÄdy CD/DVD</title>

<para>
Nowoczesne napÄdy CD-ROM osiÄgajÄ bardzo duĹźe prÄdkoĹci. NiektĂłre z nich sÄ
dodatkowo zdolne do pracy przy zredukowanych prÄdkoĹciach. Oto kilka powodĂłw,
dla ktĂłrych powinniĹmy zastanowiÄ siÄ czy nie naleĹźy zredukowaÄ prÄdkoĹci
naszego napÄdu:
</para>

<itemizedlist>
<listitem><para>
IstniejÄ doniesienia o bĹÄdach odczytu przy duĹźych prÄdkoĹciach, szczegĂłlnie
podczas uĹźywania uszkodzonych bÄdĹş wadliwie wytĹoczonych/nagranych pĹyt CD.
Redukcja prÄdkoĹci odczytu moĹźe uchroniÄ nas przed utratÄ danych w takich
przypadkach.
</para></listitem>

<listitem><para>
Wiele napÄdĂłw CD jest dokuczliwie gĹoĹnych. Redukcja prÄdkoĹci moĹźe zmniejszyÄ
natÄĹźenie haĹasu.
</para></listitem>
</itemizedlist>

<sect2 id="drives_linux">
<title>Linux</title>

<para>
MoĹźesz zredukowaÄ prÄdkoĹÄ napÄdu CD z interfejsem IDE korzystajÄc
z <command>hdparm</command>, <command>setcd</command> lub
<command>cdctl</command>.
DziaĹajÄ one w nastÄpujÄcy sposĂłb:
<screen>hdparm -E <replaceable>[prÄdkoĹÄ]</replaceable> <replaceable>[urzÄdzenie cdrom]</replaceable></screen>
<screen>setcd -x <replaceable>[prÄdkoĹÄ]</replaceable> <replaceable>[urzÄdzenie cdrom]</replaceable></screen>
<screen>cdctl -bS <replaceable>[speed]</replaceable></screen>
</para>

<para>
JeĹli uĹźywasz emulacji SCSI, moĹźesz musieÄ zastosowaÄ ustawienia do prawdziwego
urzÄdzenia IDE a nie emulowanego SCSI.
</para>

<para>
JeĹźeli masz uprawnienia roota, to pomĂłc moĹźe takĹźe nastÄpujÄca komenda:
<screen>echo file_readahead:2000000 &gt; /proc/ide/<replaceable>[urzÄdzenie cdrom]</replaceable>/settings</screen>
</para>


<para>
Ustawiamy w ten sposĂłb wielkoĹÄ bufora odczytu na 2MB, co pomaga przy odczycie
porysowanych pĹyt. JeĹźeli ustawimy zbyt duĹźÄ wielkoĹÄ tego bufora, napÄd bÄdzie
stale rozkrÄcaĹ siÄ i zwalniaĹ, co spowoduje bardzo znaczny spadek wydajnoĹci.
Zaleca siÄ rĂłwnieĹź dostrojenie napÄdu CD-ROM przy uĹźyciu
<command>hdparm</command>:
<screen>hdparm -d1 -a8 -u1 <replaceable>[urzÄdzenie cdrom]</replaceable></screen>
</para>

<para>
WĹÄczamy w ten sposĂłb dostÄp DMA do dysku, czytanie z wyprzedzeniem i
odmaskowanie IRQ (IRQ unmasking) (wiÄcej przeczytasz na stronach man do
<command>hdparm</command>)
</para>

<para>
ProszÄ sprawdziÄ &quot;<filename>/proc/ide/<replaceable>[urzÄdzenie cdrom]</replaceable>/settings&quot;</filename>
dla dostrojenia swojego napÄdu CD-ROM.
</para>

<para>
Dla napÄdĂłw SCSI nie istnieje jednolity sposĂłb ustawiawiania tych parametrĂłw
(jeĹźeli znasz jakiĹ to napisz nam o nim). Istnieje narzÄdzie ktĂłre dziaĹa z
<ulink url="http://das.ist.org/~georg/">napÄdami SCSI Plextor</ulink>.
</para>
</sect2>

<sect2 id="drives_freebsd">
<title>FreeBSD</title>

<para>PrÄdkoĹÄ:
<screen>
cdcontrol [-f <replaceable>urzÄdzenie</replaceable>] speed <replaceable>[prÄdkoĹÄ]</replaceable>
</screen>
</para>

<para>DMA:
<screen>
sysctl hw.ata.atapi_dma=1
</screen>
</para>
</sect2>

</sect1>



<sect1 id="dvd">
<title>Odtwarzanie DVD</title>
<para>
Aby poznaÄ peĹnÄ listÄ dostÄpnych opcji, proszÄ przeczytaÄ odpowiednie strony
man. SkĹadnia do odtwarzania standardowego DVD jest nastÄpujÄca:
<screen>mplayer dvd://<replaceable>&lt;ĹcieĹźka&gt;</replaceable> [-dvd-device <replaceable>&lt;urzÄdzenie&gt;</replaceable>]</screen>
</para>

<para>
PrzykĹad:
<screen>mplayer dvd://1 -dvd-device /dev/hdc</screen>
</para>

<para>
JeĹli skompilowaĹeĹ <application>MPlayera</application> z obsĹugÄ dvdnav,
skĹadnia jest taka sama, tylko musisz uĹźyÄ dvdnav:// zamiast dvd://.
</para>

<para>
DomyĹlnym urzÄdzeniem (device) DVD jest <filename>/dev/dvd</filename>. JeĹźeli
Twoje ustawienia sÄ inne, stwĂłrz odpowiedni symlink lub ustaw odpowiednie
urzÄdzenie (device) w linii polecenia korzystajÄc z opcji
<option>-dvd-device</option>.
</para>

<para>
<application>MPlayer</application> uĹźywa <systemitem>libdvdread</systemitem>
oraz <systemitem>libdvdcss</systemitem> do odtwarzania i dekodowania DVD. Te
dwie biblioteki sÄ zawarte w podkatalogu <filename class="directory">libmpdvdkit2</filename>
w gĹĂłwnym drzewie katalogĂłw <application>MPlayera</application>, nie trzeba
instalowaÄ ich osobno.
MoĹźesz teĹź uĹźyÄ systemowych wersji tych bibliotek, ale nie jest to zalecane,
poniewaĹź moĹźe spowodowaÄ bĹÄdy, niekompatybilnoĹci bibliotek oraz zmniejszenie
prÄdkoĹci.
</para>

<note><para>
JeĹli wystÄpujÄ problemy z dekodowaniem DVD, sprĂłbuj wyĹÄczyÄ supermount lub
inne tego typu usĹugi. NiektĂłre napÄdy RPC-2 mogÄ rĂłwnieĹź wymagaÄ ustawienia
kodu regionu DVD.
</para></note>

<formalpara>
<title>Struktura dysku DVD</title>
<para>
Dyski DVD majÄ po 2048 bajtĂłw na sektor z ECC/CRC. Zwykle posiadajÄ system
plikĂłw UDF na pojedynczej ĹcieĹźce zawierajÄcej rĂłĹźnorakie pliki (maĹe pliki .IFO
i .BUK oraz duĹźe (1GB) pliki .VOB).
SÄ one rzeczywistymi plikami i mogÄ byÄ kopiowane/odtwarzane z podmontowanego
systemu plikĂłw niezakodowanego DVD.
</para>
</formalpara>

<para>
Pliki .IFO zawierajÄ informacje nawigacyjne filmu (mapa
rozdziaĹĂłw/tytuĹĂłw/kÄtĂłw kamery, tablica jÄzykĂłw, itp) i sÄ konieczne do
odczytu i interpretacji zawartoĹci pliku .VOB (filmu).
Pliki .BUK sÄ kopiami zapasowymi plikĂłw .IFO.
UĹźywajÄ <emphasis role="bold">sektorĂłw</emphasis> wszÄdzie, wiÄc aby
zaimplementowaÄ nawigacjÄ na DVD lub rozszyfrowaÄ zawartoĹÄ, naleĹźy uĹźywaÄ
adresowania sektorĂłw dysku w trybie raw.
</para>

<para>
Z tego powodu obsĹuga DVD wymaga
dostÄpu do urzÄdzenia w trybie raw bazujÄcym na sektorach. Niestety wymagane
jest (pod Linuksem) posiadanie uprawnieĹ roota aby mĂłc korzystaÄ z sektorowego
adresowania pliku.
Dlatego teĹź nie w ogĂłle uĹźywamy sterownika systemu plikĂłw pochodzÄcego
z jÄdra, ale reimplementujemy to w przestrzeni uĹźytkownika.
ZajmujÄ siÄ tym
biblioteki <systemitem>libdvdread</systemitem> 0.9.x i
<systemitem>libmpdvdkit</systemitem>. Sterownik
systemu plikĂłw UDF zawarty w jÄdrze nie jest wymagany poniewaĹź wspomniane
biblioteki zawierajÄ wĹasny, wbudowany sterownik systemu plikĂłw UDF. DVD nie
musi byÄ podmontowany, bowiem uĹźywany jest jedynie dostÄp w trybie raw.
</para>

<para>
Czasami <filename>/dev/dvd</filename> nie moĹźe byÄ czytany przez uĹźytkownikĂłw,
zatem autorzy <systemitem>libdvdread</systemitem> zaimplementowali warstwÄ
emulacji, ktĂłra tĹumaczy adresowanie sektorowe na nazwy plikĂłw i offsety, aby
emulowaÄ dostÄp w trybie raw na podmontowanym systemie plikĂłw albo nawet na
twardym dysku.
</para>

<para>
<systemitem>libdvdread</systemitem> rĂłwnie dobrze akceptuje miejsce
podmontowania (mountpoint) jak i nazwÄ urzÄdzenia przy dostÄpie w trybie raw i
sprawdza <filename>/proc/mounts</filename> w celu odnalezienia odpowiedniej
nazwy urzÄdzenia (device). ZostaĹo to napisane z myĹlÄ o systemie Solaris, gdzie
nazwy urzÄdzeĹ sÄ przydzielane automatycznie.
</para>

<formalpara>
<title>Deszyfrowanie DVD</title>
<para>
Do deszyfrowania DVD jest uĹźywana biblioteka
<systemitem>libdvdcss</systemitem>. Metoda jej dziaĹania moĹźe byÄ okreĹlona
poprzez zmienna ĹrodowiskowÄ <envar>DVDCSS_METHOD</envar>,
co jest dokĹadniej opisane na stronie man.
</para>
</formalpara>

<para>
NapÄdy DVD RPC-1 zabezpieczajÄ ustawienia regionu jedynie poprzez
oprogramowanie. NapÄdy RPC-2 majÄ sprzÄtowe zabezpieczenie, ktĂłre pozwala na co
najwyĹźej 5 zmian. JeĹźeli posiadamy napÄd DVD RPC-2 wymagana/zalecana jest
aktualizacja firmware'u do RPC-1. 
Nowe wersje firmware'Ăłw moĹźna znaleĹşÄ w internecie. 
Poszukiwania radzimy rozpoczÄÄ od 
<ulink url="http://forum.rpc-1.com/dl_all.php">forum firmware'Ăłw</ulink>.
JeĹźeli nie ma tam nowej wersji firmware'u dla naszego urzÄdzenia, uĹźyj
<ulink url="http://linvdr.org/projects/regionset/">regionset tool
(narzÄdzia do zmiany regionĂłw)</ulink> aby ustawiÄ kod regionu na swoim napÄdzie
DVD (pod Linuksem). <emphasis role="bold">OstrzeĹźenie</emphasis>: MoĹźesz
ustawiÄ region tylko 5 razy.
</para>
</sect1>



<sect1 id="vcd">
<title>Odtwarzanie VCD</title>
<para>
PeĹna lista dostÄpnych opcji znajduje siÄ na stronie man. SkĹadnia dla
standardowego Video CD (VCD) jest nastÄpujÄca:
<screen>mplayer vcd://<replaceable>&lt;ĹcieĹźka&gt;</replaceable> [-cdrom-device <replaceable>&lt;urzÄdzenie&gt;</replaceable>]</screen>
PrzykĹad:
<screen>mplayer vcd://2 -cdrom-device /dev/hdc</screen>
DomyĹlnym urzÄdzeniem VCD jest <filename>/dev/cdrom</filename>. JeĹli
Twoje ustawienia sÄ inne, utwĂłrz dowiÄzanie symboliczne
lub podaj prawidĹowe urzÄdzenie w linii poleceĹ za pomocÄ opcji
<option>-cdrom-device</option>
</para>

<note><para>
Przynajmniej napÄdy CD-ROM SCSI firmy Plextor i niektĂłre modele Toshiby
majÄ beznadziejnÄ wydajnoĹÄ przy odczycie VCD. Jest to spowodowane
niekompletnÄ implementacjÄ <systemitem>ioctl</systemitem>'a CDROMREADRAW dla
tych urzÄdzeĹ. JeĹli masz jakieĹ pojÄcie o programowaniu SCSI,
<ulink url="../../tech/patches.txt">pomĂłĹź nam</ulink> zaimplementowaÄ ogĂłlnÄ
obsĹugÄ SCSI dla VCD.
</para></note>

<para>
W miÄdzyczasie moĹźesz wyciÄgaÄ dane z VCD za pomocÄ
<ulink url="http://ftp.ntut.edu.tw/ftp/OS/Linux/packages/X/viewers/readvcd/">readvcd</ulink>
i odtwarzaÄ plik wynikowy za pomocÄ <application>MPlayera</application>
</para>

<formalpara>
<title>Struktura VCD</title>
<para>
Video CD (VCD) skĹada siÄ z sektorĂłw CD-ROM XA, tzn. ĹcieĹźek CD-ROM 
mode 2 form 1 i form 2:</para>
</formalpara>

<itemizedlist>
<listitem><para>
Pierwsza ĹcieĹźka jest w formacie mode 2 form 2, ktĂłry oznacza uĹźycie korekcji 
bĹÄdĂłw L2. ĹcieĹźka ta zawiera system plikĂłw ISO-9660 o gÄstoĹci 2048 bajtĂłw/sektor.
Ten system plikĂłw z kolei zawiera metainformacje VCD, a takĹźe nieruchome klatki, czÄsto 
uĹźywane w menu. Segmenty MPEG dla menu mogÄ takĹźe byÄ skĹadowane w tejĹźe pierwszej 
ĹcieĹźce, ale MPEGi muszÄ byÄ podzielone na kawaĹki po 150 sektorĂłw. System plikĂłw ISO-9660 
moĹźe zawieraÄ inne pliki bÄdĹş programy, niekonieczne dla eksploatacji VCD.
</para></listitem>

<listitem><para>
Druga i pozostaĹe ĹcieĹźki sÄ zwykle ĹcieĹźkami video MPEG typu raw o gÄstoĹci 
2324 bajtĂłw/sektor, zawierajÄcymi jeden pakiet danych MGEG PS na sektor.
ĹcieĹźki te sÄ w formacje mode 2 form 1, wiÄc przechowujÄ one wiÄcej danych 
na sektor, w zamian za sĹabszÄ korekcjÄ bĹÄdĂłw. MoĹźliwe sÄ teĹź ĹcieĹźki 
CD-DA na VCD poza pierwszÄ ĹcieĹźkÄ.
NiektĂłre systemy operacyjne uĹźywajÄ pewnych trikĂłw aby ĹcieĹźki nie zawierajÄce 
systemu plikĂłw ISO-9660 byĹy widoczne w systemie plikĂłw. W pozostaĹych systemach, 
jak na przykĹad w systemie GNU/Linux, nie ma takiej moĹźliwoĹci (jeszcze). W takim 
przypadku dane MPEG <emphasis role="bold">nie mogÄ byÄ montowane</emphasis>. 
Jako Ĺźe wiÄkszoĹÄ filmĂłw znajduje siÄ na tego typu ĹcieĹźce,
powinieneĹ sprĂłbowaÄ na poczÄtek opcji <option>vcd://2</option>.
</para></listitem>

<listitem><para>
IstniejÄ rĂłwnieĹź pĹyty VCD bez pierwszej ĹcieĹźki (pojedyncza ĹcieĹźka i
brak systemu plikĂłw w ogĂłle). Je rĂłwnieĹź da siÄ odtwarzaÄ, ale nie da
siÄ ich montowaÄ.
</para></listitem>

<listitem><para> Definicja standardu Video CD, nazywana "BiaĹÄ KsiÄgÄ"
Phillipsa, generalnie nie jest dostÄpna online, musi byÄ zakupiona u Phillipsa. 
Bardziej szczegĂłĹowe informacje na temat Video CD moĹźna znaleĹşÄ na 
<ulink url="http://www.vcdimager.org/pub/vcdimager/manuals/0.7/vcdimager.html#SEC4">stronie 
dokumentacji vcdimagera</ulink>.
</para></listitem>

</itemizedlist>

<formalpara>
<title>O plikach .DAT</title>
<para>
Plik o rozmiarze ok. 600 MB widoczny na pierwszej ĹcieĹźce zamontowanego VCD
nie jest prawdziwym plikiem ! Jest on tzw. bramkÄ ISO, utworzonÄ by
Windows mĂłgĹ obsĹugiwaÄ takie ĹcieĹźki (Windows w ogĂłle nie zezwala aplikacjom
na dostÄp do urzÄdzeĹ w trybie raw). Pod Linuksem nie moĹźesz kopiowaÄ ani
odtwarzaÄ tych plikĂłw (zawierajÄ "Ĺmieci"). Pod Windows jest to moĹźliwe, gdyĹź
jego sterownik iso9660 symuluje odczyt ĹcieĹźek w trybie raw za pomocÄ tego
pliku. By mĂłc odtwarzaÄ pliki .DAT, musisz mieÄ sterownik do jÄdra, ktĂłry
dostarczany jest z linuksowÄ wersjÄ PowerDVD. Posiada on zmodyfikowany sterownik
systemu plikĂłw iso9660 (<filename>vcdfs/isofs-2.4.X.o</filename>), ktĂłry jest w
stanie symulowaÄ odczyt ĹcieĹźek w trybie raw za pomocÄ pliku .DAT. JeĹli
podmontujesz pĹytÄ uĹźywajÄc ich sterownika, moĹźesz kopiowaÄ, a nawet odtwarzaÄ
pliki .DAT za pomocÄ <application>MPlayera</application>. Ale nie bÄdzie to
dziaĹaĹo za pomocÄ standardowego sterownika iso9660 dostarczonego z jÄdrem
Linuksa! Zamiast tego uĹźyj opcji <option>vcd://</option>. AlternatywÄ dla
kopiowania VCD jest nowy sterownik:
<ulink url="http://www.elis.rug.ac.be/~ronsse/cdfs/">cdfs</ulink> (nie jest
czÄĹciÄ oficjalnego jÄdra), ktĂłry wyĹwietla sesje CD jako pliki obrazĂłw, oraz
<ulink url="http://cdrdao.sf.net/">cdrdao</ulink>, program do zgrywania
pĹyt CD bit po bicie.
</para>
</formalpara>
</sect1>
</chapter>
