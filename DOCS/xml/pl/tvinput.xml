<?xml version="1.0" encoding="utf-8"?>
<!-- synced with r17322 -->
<!-- Opiekun: Cobra -->
<chapter id="tv">
<title>TV</title>

<sect1 id="tv-input" xreflabel="TV input">
<title>WejĹcie TV</title>

<para>
Sekcja ta opisuje jak <emphasis role="bold">oglÄdaÄ/nagrywaÄ obraz
za pomocÄ tunera TV kompatybilnego z V4L</emphasis>. Zajrzyj do strony man
by zobaczyÄ opis opcji TV i klawiszy sterujÄcych.
</para>


<sect2 id="tv-compilation">
<title>Kompilacja</title>

<procedure>
<step><para>
  Najpierw musisz przekompilowaÄ. <filename>./configure</filename> wykryje
  automatycznie nagĹĂłwki jÄdra zwiÄzane z V4L i obecnoĹÄ urzÄdzeĹ
  <filename>/dev/video*</filename>. JeĹli istniejÄ, obsĹuga TV zostanie
  wbudowana (zobacz wynik dziaĹania <filename>./configure</filename>).
  </para></step>
<step><para>
  Upewnij siÄ, Ĺźe TwĂłj tuner dziaĹa z innymi programami do obsĹugi TV pod
  Linuksem, na przykĹad <application>XawTV</application>.
  </para></step>
</procedure>
</sect2>

<sect2 id="tv-tips">
<title>WskazĂłwki uĹźytkowania</title>
<para>
Kompletna lista opcji dostÄpna jest na stronie man.
Tu jest tylko kilka wskazĂłwek:
</para>
<itemizedlist>
<listitem>
<para>
UĹźywaj opcji <option>channels</option>. PrzykĹad
<screen>-tv channels=26-MTV1,23-TV2</screen>
WyjaĹnienie: uĹźywajÄc tej opcji, tylko kanaĹy 23 i 26 bÄdÄ dostÄpne oraz pojawi
siÄ fajny napis na OSD przy zmianie kanaĹu, wyĹwietlajÄcy jego nazwÄ.
OdstÄpy w nazwie kanaĹu muszÄ zostaÄ zastÄpione znakiem &quot;_&quot;.
</para>
</listitem>

<listitem>
<para>
UĹźywaj rozsÄdnych rozmiarĂłw obrazu. Rozmiary obrazu wynikowego powinny
byÄ podzielne przez 16.
</para>
</listitem>

<listitem>
<para>
JeĹli nagrywasz obraz video o pionowej rozdzielczoĹci wiÄkszej niĹź poĹowa
rozdzielczoĹci peĹnej (np. 288 dla PAL lub 240 dla NTSC), wtedy 'ramki'
ktĂłre otrzymasz bÄdÄ tak naprawdÄ parami poprzeplatanych (interleaved) pĂłl.
W zaleĹźnoĹci od tego, co chcesz zrobiÄ ze strumieniem wideo, moĹźesz go zostawiÄ
w takiej formie, uĹźyÄ destrukcyjnego usuwania przeplotu (deinterlacing),
albo rozdzieliÄ pary na pojedyncze pola.
</para>
<para>
W przeciwnym wypadku dostaniesz
film, ktĂłry jest znieksztaĹcony w trakcie scen o duĹźej dynamice, a wskazana
szybkoĹÄ transmisji (bitrate) prawdopodobnie nie bÄdzie nawet mogĹa byÄ
utrzymana przez kontroler szybkoĹci (bitrate controller),
poniewaĹź artefakty przeplotu tworzÄ duĹźe iloĹci szczegĂłĹĂłw,
a co za tym idzie, potrzebujÄ duĹźej przepustowoĹci. MoĹźesz wĹÄczyÄ
usuwanie przeplotu za pomocÄ opcji <option>-vf pp=TYP_DEINT</option>. Zwykle
<option>pp=lb</option> spisuje siÄ dobrze, ale to kwestia gustu. Poczytaj o
innych algorytmach usuwania przeplotu na stronie man i zacznij eksperymentowaÄ.
</para>
</listitem>

<listitem>
<para>
Usuwaj "martwe miejsca". Kiedy nagrywasz video, sÄ pewnie miejsca przy brzegach,
ktĂłre sÄ zazwyczaj czarne lub zawierajÄ szum. Jak siÄ Ĺatwo domyĹliÄ,
niepotrzebnie wymagajÄ wiÄkszej przepustowoĹci (dokĹadniej, to nie same czarne
miejsca, lecz ostre przejĹcia pomiÄdzy czarnym kolorem i jaĹniejszym obrazem
video, ale nie jest to akurat takie waĹźne). Zanim zaczniesz nagrywaÄ, ustaw
argumenty opcji <option>crop</option> by wszystkie "Ĺmieci" na brzegach zostaĹy
wyciÄte. OczywiĹcie nie zapomnij o utrzymaniu prawidĹowych wymiarĂłw obrazu.
</para>
</listitem>

<listitem>
<para>
UwaĹźaj na obciÄĹźenie CPU. Nie powinno ono przekroczyÄ granicy 90% przez
wiÄkszoĹÄ czasu. JeĹli masz duĹźy bufor nagrywania,
<application>MEncoder</application> moĹźe przetrwaÄ przeciÄĹźenie przez najwyĹźej
kilka sekund i nic wiÄcej. Lepiej wiÄc wyĹÄczyÄ wszystkie trĂłjwymiarowe
wygaszacze OpenGL i inne tego typu bajery.
</para>
</listitem>

<listitem>
<para>
Nie mieszaj z zegarem systemowym. <application>MEncoder</application> korzysta z
niego do synchronizacji A/V. JeĹli zmodyfikujesz zegar systemowy (zwĹaszcza
wstecz), <application>MEncoder</application> siÄ pogubi i utraci klatki. Jest to
bardzo waĹźna sprawa jeĹli jesteĹ podpiÄty do sieci i uĹźywasz do synchronizacji
czasu rĂłĹźnych programĂłw typu NTP. Musisz wyĹÄczyÄ NTP w trakcie nagrywania,
jeĹli chcesz, by byĹo ono przeprowadzone niezawodnie.
</para>
</listitem>

<listitem>
<para>
Nie zmieniaj opcji <option>outfmt</option>, chyba, Ĺźe wiesz co robisz lub Twoja
karta/sterownik naprawdÄ nie obsĹuguje ustawienia domyĹlnego (przestrzeĹ
kolorĂłw YV12). W poprzednich wersjach
<application>MPlayera</application>/<application>MEncodera</application>
konieczne byĹo podanie formatu wyjĹcia.
Ten problem powinien byÄ rozwiÄzany w aktualnych wydaniach i opcja
<option>outfmt</option> nie jest juĹź wymagana, a ustawienie domyĹlne powinno
pasowaÄ kaĹźdemu. Na przykĹad, jeĹli nagrywasz do formatu DivX uĹźywajÄc
<systemitem class="library">libavcodec</systemitem> i podasz opcjÄ <option>outfmt=RGB24</option>
aby zwiÄkszyÄ jakoĹÄ nagrywanego obrazu, zostanie on i tak pĂłĹşniej z
powrotem przekonwertowany do YV12, wiÄc jedyne, co osiÄgniesz, to ogromna
strata mocy obliczeniowej.
</para>
</listitem>

<listitem>
<para>
By uĹźyÄ przestrzeni kolorĂłw I420 (<option>outfmt=i420</option>), musisz dodaÄ
opcjÄ <option>-vc rawi420</option> z powodu konfliktu fourcc z kodekiem Intel
Indeo.
</para>
</listitem>

<listitem>
<para>
Jest kilka sposobĂłw na nagrywanie audio. MoĹźesz nagrywaÄ dĹşwiÄk za pomocÄ Twojej
karty dĹşwiÄkowej korzystajÄc z zewnÄtrznego kabla pomiÄdzy kartÄ video i
wejĹciem liniowym lub korzystajÄc z wbudowanego w ukĹad bt878 przetwornika ADC.
W tym drugim przypadku musisz zaĹadowaÄ sterownik
<emphasis role="bold">btaudio</emphasis>. Przeczytaj plik
<filename>linux/Documentation/sound/btaudio</filename> (w drzewie jÄdra, a nie
<application>MPlayera</application>) by dowiedzieÄ siÄ jak korzystaÄ z tego
sterownika.
</para>
</listitem>

<listitem>
<para>
JeĹli <application>MEncoder</application> nie moĹźe otworzyÄ urzÄdzenia
dĹşwiÄkowego, upewnij siÄ, Ĺźe jest ono rzeczywiĹcie dostÄpne. ZdarzajÄ siÄ
problemy z serwerami dĹşwiÄku typu aRts (KDE) lub ESD (GNOME). JeĹli masz
kartÄ full-duplex (prawie wszystkie przyzwoite karty dostÄpne obecnie obsĹugujÄ
tÄ funkcjÄ) i korzystasz z KDE, sprĂłbuj zaznaczyÄ opcjÄ "DziaĹanie w peĹni
dupleksowe" ("full duplex") w konfiguracji serwera dĹşwiÄku.
</para>
</listitem>
</itemizedlist>
</sect2>


<sect2 id="tv-examples">
<title>PrzykĹady</title>

<informalexample>
<para>
Puste wyjĹcie, do AAlib :)
<screen>
mplayer -tv driver=dummy:width=640:height=480 -vo aa tv://<!--
--></screen>
</para>
</informalexample>

<informalexample>
<para>
WejĹcie ze standardowego V4L:
<screen>
mplayer -tv driver=v4l:width=640:height=480:outfmt=i420 -vc rawi420 -vo xv tv://<!--
--></screen>
</para>
</informalexample>

<informalexample>
<para>
Bardziej skomplikowany przykĹad. KaĹźe on
<application>MEncoderowi</application> nagraÄ peĹen
obraz PAL, wykadrowaÄ go i usunÄÄ przeplot korzystajÄc z algorytmu
liniowego zlewania (linear blend). Audio jest kompresowane ze staĹÄ
szybkoĹciÄ rĂłwnÄ 64kbps, korzystajÄc z kodeka LAME. To ustawienie jest
dobre do nagrywania filmĂłw.
<screen>
     mencoder -tv driver=v4l:width=768:height=576 \
     -ovc lavc -lavcopts vcodec=mpeg4:vbitrate=900 \
     -oac mp3lame -lameopts cbr:br=64 \
     -vf crop=720:544:24:16,pp=lb -o <replaceable>wyjscie.avi</replaceable> tv://
</screen>
</para>
</informalexample>

<informalexample>
<para>
Ten przykĹad dodatkowo przeskaluje obraz do 384x288 i skompresuje video
z szybkoĹciÄ 350kbps w trybie wysokiej jakoĹci. Opcja <option>vqmax</option>
uwalnia kwantyzator i pozwala kompresorowi video na osiÄgniÄcie tak
niskiej szybkoĹci nawet kosztem jakoĹci obrazu. MoĹźe byÄ to uĹźywane do
nagrywania dĹugich seriali TV, kiedy jakoĹÄ obrazu nie jest tak waĹźna.
<screen>
     mencoder -tv driver=v4l:width=768:height=576 \
     -ovc lavc -lavcopts vcodec=mpeg4:vbitrate=350:vhq:vqmax=31:keyint=300 \
     -oac mp3lame -lameopts cbr:br=48 \
     -vf crop=720:540:24:18,pp=lb,scale=384:288 -sws 1 -o <replaceable>wyjscie.avi</replaceable> tv://
</screen>
Jest rĂłwnieĹź moĹźliwe podanie mniejszych wymiarĂłw obrazu w opcji
<option>-tv</option> i pominiÄcie programowego skalowania, ale to podejĹcie
wykorzystuje maksymalnÄ iloĹÄ dostÄpnych informacji i jest trochÄ bardziej
odporne na szum. Z powodu ograniczeĹ sprzÄtowych UkĹady bt878 mogÄ stosowaÄ
uĹrednianie pikseli jedynie w kierunku poziomym.
</para>
</informalexample>
</sect2>
</sect1>

</chapter>