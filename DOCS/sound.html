<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>

<HEAD>
  <TITLE>Sound - MPlayer - The Movie Player for Linux</TITLE>
  <LINK REL="stylesheet" TYPE="text/css" HREF="default.css">
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
</HEAD>

<BODY>


<P><B><A NAME="audio">2.3.2 Audio output devices</A></B></P>

<P><B>MPlayer</B>'s audio interface is called <I>libao2</I>. It currently
contains these drivers:</P>

<TABLE BORDER=0>

<TR><TD COLSPAN=4><P><B>General:</B></P></TD></TR>

<TR><TD>&nbsp;&nbsp;</TD><TD VALIGN=top>oss</TD><TD>&nbsp;&nbsp;</TD><TD>OSS (ioctl) driver (supports hardware AC3 passthrough)</TD></TR>
<TR><TD></TD><TD VALIGN=top>sdl</TD><TD></TD><TD>SDL driver (supports up/downsampling, <B>ESD</B>, <B>ARTS</B> etc)</TD></TR>
<TR><TD></TD><TD VALIGN=top>nas</TD><TD></TD><TD>NAS (Network Audio System) driver</TD></TR>
<TR><TD></TD><TD VALIGN=top>alsa5</TD><TD></TD><TD>native ALSA 0.5 driver</TD></TR>
<TR><TD></TD><TD VALIGN=top>alsa9</TD><TD></TD><TD>native ALSA 0.9 driver (supports hardware AC3 passthrough)</TD></TR>
<TR><TD></TD><TD VALIGN=top>sun</TD><TD></TD><TD>SUN audio driver (<CODE>/dev/audio</CODE>) for BSD and Solaris8 users</TD></TR>
<TR><TD></TD><TD VALIGN=top>arts</TD><TD></TD><TD>native ARTS driver (mostly for KDE users)</TD></TR>

</TABLE>

<P>Fact is, Linux sound card drivers have compatibility problems.
It <B>may</B> take a while to find your optimal settings.</P>

<UL>
  <LI>If you have an OSS driver, first try <CODE>-ao oss</CODE> (this is the
    default). If you experience glitches, halts or anything out of the
    ordinary, try <CODE>-ao sdl</CODE> (NOTE: you need to have SDL libraries
    and header files installed). The SDL audio driver helps in a lot of cases
    and also supports ESD, ARTS, and up/downsampling. (ESD is the sound daemon
    from GNOME, ARTS is from KDE.)</LI>
  <LI>If you have ALSA version 0.5, then you almost always have to use
    <CODE>-ao alsa5</CODE> , since ALSA 0.5 has buggy OSS emulation code, and
    will <B>crash MPlayer</B> with a message like this:<BR>
    <CODE>DEMUXER: Too many (945 in 8390980 bytes) video packets in the buffer!</CODE></LI>
  <LI>If you have ALSA version 0.9 you may choose between <CODE>-ao oss</CODE>
    and <CODE>-ao sdl</CODE>. You can also use <CODE>-ao alsa9</CODE>. It
    works, but there may be problems like lost sync and disappearing
    audio.</LI>
</UL>

<P>On <B>Solaris/FreeBSD</B> systems, use the SUN audio driver with the
  <CODE>-ao sun</CODE> option, otherwise neither video nor audio will work.</P>

<P><B><A NAME="experiences">2.3.2.1 Sound Card experiences, recommendations</A></B></P>

<TABLE BORDER=0 WIDTH="100%">
<TR><TD COLSPAN=3><B>VIA onboard chipset (via82cxxx) 48kHz only</B></TD><TR>
<TD></TD><TD>Driver:</TD><TD> from <A HREF="http://sourceforge.net/project/showfiles.php?group_id=3242&amp;release_id=59602">here</A></TD><TR>

<TD COLSPAN=3><B>Aureal Vortex 2</B></TD><TR>
<TD>&nbsp;&nbsp;&nbsp;&nbsp;</TD><TD>OSS:</TD><TD>no driver</TD><TR>
<TD></TD><TD>OSS/Pro:</TD><TD>OK</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>no driver</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>48</TD><TR>
<TD></TD><TD>Driver:</TD><TD><A HREF="http://aureal.sourceforge.net">aureal.sourceforge.net</A></TD><TR>
<TD></TD><TD>Driver2:</TD><TD> from <A HREF="http://makacs.poliod.hu/~pontscho/aureal/au88xx-1.1.3.tar.bz2">here</A><BR>
(<I>buffer size increased to 32k</I>)</TD><TR>

<TD COLSPAN=3><B>GUS PnP</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>no driver</TD><TR>
<TD></TD><TD>OSS/Pro:</TD><TD>OK</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>OK</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>48</TD><TR>

<TD COLSPAN=3><B>SB Live!</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>Analog OK, SP/DIF not working</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>Both OK</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>192</TD><TR>

<TD COLSPAN=3><B>SB AWE 64</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>max 44kHz</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>48kHz sounds bad</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>48</TD><TR>

<TD COLSPAN=3><B>Gravis UltraSound ACE</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>not OK</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>OK</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>44</TD><TR>

<TD COLSPAN=3><B>Gravis UltraSound MAX</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>OK</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>OK (?)</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>48</TD><TR>

<TD COLSPAN=3><B>ESS 688</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>OK</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>OK (?)</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>48</TD><TR>

<TD COLSPAN=3><B>C-Media cards (which ones?)</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>not OK (hissing) (?)</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>OK (?)</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>?</TD><TR>

<TD COLSPAN=3><B>Yamaha cards (*ymf*)</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>not OK (?) (maybe <CODE>-ao sdl</CODE>)</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>OK only with ALSA 0.5 with OSS emulation <B>AND</B> <CODE>-ao sdl</CODE> (!) (?)</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>?</TD><TR>

<TD COLSPAN=3><B>Cards with envy24 chips (like Terratec EWS88MT)</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>?</TD><TR>
<TD></TD><TD>OSS/Pro:</TD><TD>OK</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>?</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>?</TD><TR>

<TD COLSPAN=3><B>PC Speaker or DAC</B></TD><TR>
<TD></TD><TD>OSS:</TD><TD>OK (Use the SDL driver: <CODE>-ao sdl</CODE>)</TD><TR>
<TD></TD><TD>ALSA:</TD><TD>no driver</TD><TR>
<TD></TD><TD>Max kHz:</TD><TD>The driver emulates 44.1, maybe more.</TD><TR>
<TD></TD><TD>Driver:</TD><TD><A HREF="ftp://ftp.infradead.org/pub/pcsp">ftp://ftp.infradead.org/pub/pcsp</A></TD>
</TABLE>

<UL>
  <LI>On Linux, a 2.4.x kernel is highly recommended. Kernel 2.2 is not tested.</LI>
  <LI>If sound clicks when playing from CD-ROM, turn on IRQ unmasking, e.g. 
    <CODE>hdparm -u1 /dev/cdrom</CODE> (<CODE>man hdparm</CODE>). This is
    generally beneficial and described more detailed in the <A
    HREF="cd-dvd.html#drives">CD-ROM section</A>.</LI>
  <LI>Sharing your sound card with another application like XMMS is <B>strongly
    discouraged</B>!  If the other sound application is using ESD, start
    <B>MPlayer</B> with the <CODE>-vo sdl:esd</CODE> option to combine both
    sound streams! In fact, the option <CODE>-vo sdl:esd</CODE> could be used
    with ESD even when playing <B>Mplayer</B> alone.</LI>
  <LI>Feedback to this document is welcome. Please tell us how <B>MPlayer</B>
    and your sound card(s) worked together.</LI>
</UL>


<P><B><A NAME="plugins">2.3.2.2 Audio plugins</A></B></P>

<P><B>MPlayer</B> has support for audio plugins. Audio plugins can be used for
  changing the properties of the audio data before the sound reaches the sound
  card. They are enabled using the <CODE>-aop</CODE> switch which takes a
  <CODE>list=plugin1,plugin2,...</CODE> argument. The <CODE>list</CODE> argument
  is required and determines which plugins should be used and in which order they
  should be executed. Example:
</P>

<P>&nbsp;&nbsp;<CODE>mplayer media.avi -aop list=resample,format</CODE></P>

<P>would run the sound through the resampling plugin followed by the format
  plugin.
</P>

<P>The plugins can also have switches that change their behavior. These
  switches are explained in detail in the sections below. A plugin will execute
  using default settings if its switches are omitted.  Here is an example of how
  to use plugins in combination with plugin specific switches:
</P>

<P>&nbsp;&nbsp;<CODE>mplayer media.avi -aop
  list=resample,format:fout=44100:format=0x8</CODE>
</P>

<P>would set the output frequency of the resample plugin to 44100Hz and the
  output format of the format plugin to AFMT_U8.
</P>                         

<P>Currently audio plugins can not be used in <B>MEncoder</B>.</P>


<P><B><A NAME="resample">2.3.2.2.1 Up/Downsampling</A></B></P>

<P><B>MPlayer</B> fully supports up/downsampling of the sound. This plugin can
  be used if you have a fixed frequency sound card or if you are
  stuck with an old sound card that is only capable of max 44.1kHz.
  Limitations in your hardware are not auto detected, so you have to specify
  the sample frequency explicitly. This plugin has one switch:
  <CODE>fout</CODE> which is used for setting the desired output sample
  frequency. It defaults to 48kHz, and is given in
  &lt;Hz&gt;.
</P>

<P>Usage:<BR>
&nbsp;&nbsp;<CODE>mplayer media.avi -aop list=resample:fout=&lt;required
  frequency in Hz, like 44100&gt;</CODE></P>

<P>Note that the output frequency should not be scaled up from the default value.
  Scaling up will cause the audio and video streams to be played in slow motion
  in addition to audio distortion.</P>

<P><B><A NAME="surround_decoding">2.3.2.2.2 Surround Sound decoding</A></B></P>

<P><B>MPlayer</B> has an audio plugin that can decode matrix encoded
surround sound. Dolby Surround is an example of a matrix encoded format.
Many files with 2 channel audio actually contain matrixed surround sound.
To use this feature you need a sound card supporting at least 4 channels.</P>

<P>Usage:<BR>
&nbsp;&nbsp;<CODE>mplayer media.avi -aop list=surround</CODE></P>


<P><B><A NAME="format">2.3.2.2.3 Sample format converter</A></B></P>
                                                                               
<P>If your sound card driver does not support signed 16bit <CODE>int</CODE> data type, 
  this plugin can
  be used to change the format to one which your sound card can understand. It
  has one switch, <CODE>format</CODE>, which can be set to one of the numbers
  found in <CODE>libao2/afmt.h</CODE>. This plugin is hardly ever needed and is
  intended for advanced users. Keep in mind that this plugin only changes the
  sample format and not the sample frequency or the number of channels.
</P>

<P>Usage:<BR>
  &nbsp;&nbsp;<CODE>mplayer media.avi -aop
  list=format:format=&lt;required output format&gt;</CODE>
</P>


<P><B><A NAME="delay">2.3.2.2.4 Delay</A></B></P>

<P>This plugin delays the sound and is intended as an example of how to develop
  new plugins. It can not be used for anything useful from a users perspective
  and is mentioned here for the sake of completeness only. Do not use this
  plugin unless you are a developer.</P>

<P><B><A NAME="volume">2.3.2.2.5 Software volume control</A></B></P>

<P>This plugin is a software replacement for the volume control, and
  can be used on machines with a broken mixer device. It can also be
  used if one wants to change the output volume of <B>MPlayer</B>
  without changing the PCM volume setting in the mixer. It has one
  switch <CODE>volume</CODE> that is used for setting the initial
  sound level. The initial sound level can be set to values between 0
  and 255 and defaults to 101 which equals 0dB amplification. Use this
  plugin with caution since it can reduce the signal to noise ratio of
  the sound. In most cases it is best to set the level for the PCM
  sound to max, leave this plugin out and control the output level to
  your speakers with the master volume control of the mixer. If there is an
  external amplifier connected to the computer (this is almost always
  the case), the noise level can be minimized by adjusting the master
  level and the volume knob on the amplifier until the hissing noise
  in the background is gone.
</P>

<P>Usage:<BR>
  &nbsp;&nbsp;<CODE>mplayer media.avi -aop
  list=volume:volume=&lt;0-255&gt;</CODE>
</P>

<P>This plugin also has compressor or "soft-clipping" capabilities.
  Compression can be used if the dynamic range of the sound is very
  high or if the dynamic range of the loudspeakers is very
  low. Be aware that this feature creates distortion and should be
  considered a last resort.
</P>

<P>Usage:<BR>
  &nbsp;&nbsp;<CODE>mplayer media.avi -aop
  list=volume:softclip</CODE>
</P>


<P><B><A NAME="extrastereo">2.3.2.2.6 Extrastereo</A></B></P>

<P>This plugin (linearly) increases the difference between left and right
  channels (like the XMMS extrastereo plugin) which gives some sort of "live"
  effect to playback.
</P>

<P>Usage:<BR>
  &nbsp;&nbsp;<CODE>mplayer media.avi -aop list=extrastereo</CODE><BR>
  &nbsp;&nbsp;<CODE>mplayer media.avi -aop list=extrastereo:mul=3.45</CODE></P>

<P>The default coefficient (<CODE>mul</CODE>) is a float number that defaults
  to 2.5. If you set it to 0.0, you will have mono sound (average of both
  channels). If you set it to 1.0, sound will be unchanged, if you set it to
  -1.0, left and right channels will be swapped.</P>


<P><B><A NAME="normalizer">2.3.2.2.7 Volume normalizer</A></B></P>

<P>This plugin maximizes the volume without distorting the sound.</P>

<P>Usage:<BR>
  &nbsp;&nbsp;<CODE>mplayer media.avi -aop list=volnorm</CODE><BR>


<P><B><A NAME="surround">2.3.2.2.8 Surround</A></B></P>

<P>Someone should document something, sometime.</P>

</BODY>
</HTML>
